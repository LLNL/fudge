
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>fudge.productData.distributions.energy &#8212; Fudge and GNDS 6.1.0 documentation</title>
    <link rel="stylesheet" type="text/css" href="../../../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/classic.css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/graphviz.css" />
    
    <script data-url_root="../../../../" id="documentation_options" src="../../../../_static/documentation_options.js"></script>
    <script src="../../../../_static/jquery.js"></script>
    <script src="../../../../_static/underscore.js"></script>
    <script src="../../../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../../../_static/doctools.js"></script>
    
    <link rel="shortcut icon" href="../../../../_static/gnd-20121206-favicon.ico"/>
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../../../index.html">Fudge and GNDS 6.1.0 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../../index.html" accesskey="U">Module code</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">fudge.productData.distributions.energy</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <h1>Source code for fudge.productData.distributions.energy</h1><div class="highlight"><pre>
<span></span><span class="c1"># &lt;&lt;BEGIN-copyright&gt;&gt;</span>
<span class="c1"># &lt;&lt;END-copyright&gt;&gt;</span>

<span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">This module containes the energuy distribution classes for storing :math:`P(E&#39;)` and :math:`P(E&#39;|E)` distributions</span>
<span class="sd">for uncorrelated distributions, as well as the :math:`P(E&#39;|E)` when the</span>
<span class="sd">correlated distribution is represented as :math:`P(E&#39;|E)` * :math:`P(\mu|E,E&#39;)`.</span>
<span class="sd">    </span>
<span class="sd">This module contains the following classes:</span>

<span class="sd">    +-----------------------------------+-----------------------------------------------------------------------+</span>
<span class="sd">    | Class                             | Description                                                           |</span>
<span class="sd">    +===================================+=======================================================================+</span>
<span class="sd">    | XYs1d                             | Class to Store :math:`P(E&#39;)` as a list of :math:`Ei&#39;_i`, :math:`P_i`. |</span>
<span class="sd">    +-----------------------------------+-----------------------------------------------------------------------+</span>
<span class="sd">    | Regions1d                         | Stores :math:`P(E&#39;)` as a list of other 1d energy distribuitions      |</span>
<span class="sd">    |                                   | that abut in :math:`E&#39;` and are contiguous.                           |</span>
<span class="sd">    +-----------------------------------+-----------------------------------------------------------------------+</span>
<span class="sd">    | Xs_pdf_cdf1d                      | Stores :math:`P(E&#39;)` (i.e., :math:`pdf(E&#39;)`) and :math:`cdf(E&#39;)`      |</span>
<span class="sd">    |                                   | as a list of :math:`E&#39;_i`, :math:`pdf_i` and :math:`cdf_i`.           |</span>
<span class="sd">    +-----------------------------------+-----------------------------------------------------------------------+</span>
<span class="sd">    | Subform                           | Base class for all 2d energuy distributions.                          |</span>
<span class="sd">    +-----------------------------------+-----------------------------------------------------------------------+</span>
<span class="sd">    | DiscretePrimaryGamma              | Base class for :py:class:`DiscreteGamma` and :py:class:`PrimaryGamma`.|</span>
<span class="sd">    +-----------------------------------+-----------------------------------------------------------------------+</span>
<span class="sd">    | DiscreteGamma                     | Specifies that the product is a discrete (i.e., secondary) photon.    |</span>
<span class="sd">    +-----------------------------------+-----------------------------------------------------------------------+</span>
<span class="sd">    | PrimaryGamma                      | Specifies that the product is a capture primary photon.               |</span>
<span class="sd">    +-----------------------------------+-----------------------------------------------------------------------+</span>
<span class="sd">    | XYs2d                             | Stores :math:`P(E&#39;|E)` as a list of :math:`E`, :math:`P(E&#39;)`.         |</span>
<span class="sd">    +-----------------------------------+-----------------------------------------------------------------------+</span>
<span class="sd">    | Regions2d                         | Stores :math:`P(E&#39;|E)` as a list of other 2d energy distributions,    |</span>
<span class="sd">    |                                   | that abut to form a contiguous distribution in E.                     |</span>
<span class="sd">    +-----------------------------------+-----------------------------------------------------------------------+</span>
<span class="sd">    | EnergyFunctionalData              | Abstract class for some parameters in many of the 2d energy           |</span>
<span class="sd">    |                                   | functionals.                                                          |</span>
<span class="sd">    +-----------------------------------+-----------------------------------------------------------------------+</span>
<span class="sd">    | A                                 | Class for storing the A function for the :py:class:`Watt` energy      |</span>
<span class="sd">    |                                   | functional.                                                           |</span>
<span class="sd">    +-----------------------------------+-----------------------------------------------------------------------+</span>
<span class="sd">    | B                                 | Class for storing the B function for the :py:class:`Watt` energy      |</span>
<span class="sd">    |                                   | functional.                                                           |</span>
<span class="sd">    +-----------------------------------+-----------------------------------------------------------------------+</span>
<span class="sd">    | Theta                             | Class for storing the :math:`\theta` function used in several         |</span>
<span class="sd">    |                                   | 2d energy functionals.                                                |</span>
<span class="sd">    +-----------------------------------+-----------------------------------------------------------------------+</span>
<span class="sd">    | G                                 | Class for storing the G function for the                              |</span>
<span class="sd">    |                                   | :py:class:`GeneralEvaporation` functional.                            |</span>
<span class="sd">    +-----------------------------------+-----------------------------------------------------------------------+</span>
<span class="sd">    | T_M                               | Class for storing the :math:`T_M` function for the                    |</span>
<span class="sd">    |                                   | :py:class:`MadlandNix` functional.                                    |</span>
<span class="sd">    +-----------------------------------+-----------------------------------------------------------------------+</span>
<span class="sd">    | FunctionalBase                    | Abstract base class for the 2d energy functional distributions.       |</span>
<span class="sd">    +-----------------------------------+-----------------------------------------------------------------------+</span>
<span class="sd">    | GeneralEvaporation                | Class for storing the 2d general evaporation energy distribution.     |</span>
<span class="sd">    +-----------------------------------+-----------------------------------------------------------------------+</span>
<span class="sd">    | SimpleMaxwellianFission1d         | Class for storing the 1d simple Maxwellian fission energy             |</span>
<span class="sd">    |                                   | distribution.                                                         |</span>
<span class="sd">    +-----------------------------------+-----------------------------------------------------------------------+</span>
<span class="sd">    | SimpleMaxwellianFission           | Class for storing the 2d simple Maxwellian fission distribution.      |</span>
<span class="sd">    +-----------------------------------+-----------------------------------------------------------------------+</span>
<span class="sd">    | Evaporation1d                     | Class for storing the 1d evaporation energy distribution.             |</span>
<span class="sd">    +-----------------------------------+-----------------------------------------------------------------------+</span>
<span class="sd">    | Evaporation                       | Class for storing the 2d evaporation energy distribution.             |</span>
<span class="sd">    +-----------------------------------+-----------------------------------------------------------------------+</span>
<span class="sd">    | Watt                              | Class for storing the 2d Watt energy distribution.                    |</span>
<span class="sd">    +-----------------------------------+-----------------------------------------------------------------------+</span>
<span class="sd">    | MadlandNix                        | Class for storing the Madland/Nix energy distribution.                |</span>
<span class="sd">    +-----------------------------------+-----------------------------------------------------------------------+</span>
<span class="sd">    | NBodyPhaseSpace                   | Class for storing the 2d N-body phase space energy distribution.      |</span>
<span class="sd">    +-----------------------------------+-----------------------------------------------------------------------+</span>
<span class="sd">    | Weighted1d                        | Class for storing an instance of a :py:class:`Weighted1d`             |</span>
<span class="sd">    |                                   | at a specific projectile energy.                                      |</span>
<span class="sd">    +-----------------------------------+-----------------------------------------------------------------------+</span>
<span class="sd">    | WeightedFunctionals1d             | Class for storing an instance of a :py:class:`WeightedFunctionals`    |</span>
<span class="sd">    |                                   | at a specific projectile energy (this is a 1d energy functional).     |</span>
<span class="sd">    +-----------------------------------+-----------------------------------------------------------------------+</span>
<span class="sd">    | Weighted                          | Class for storing one 2d energy distribution in the                   |</span>
<span class="sd">    |                                   | :py:class: WeightedFunctionals instance.                              |</span>
<span class="sd">    +-----------------------------------+-----------------------------------------------------------------------+</span>
<span class="sd">    | WeightedFunctionals               | Class for storing a list of 2d energy functional distributions as     |</span>
<span class="sd">    |                                   | :py:class:`Weighted` instances that are weighted to form a            |</span>
<span class="sd">    |                                   | complete 2d energy distribution.                                      |</span>
<span class="sd">    +-----------------------------------+-----------------------------------------------------------------------+</span>
<span class="sd">    | EnergyFunctionalDataToPointwise   | For internal use. This class is used by the methods                   |</span>
<span class="sd">    |                                   | toPointwise_withLinearXYs of the 2d functional energy distribution    |</span>
<span class="sd">    |                                   | to convert the functional into an :py:class:`XYs2d` instance.         |</span>
<span class="sd">    +-----------------------------------+-----------------------------------------------------------------------+</span>
<span class="sd">    | Form                              | This class stores the enegy distribution part (i.e., :math:`P(E&#39;|E)`) |</span>
<span class="sd">    |                                   | for an uncorrelated distribution.                                     |</span>
<span class="sd">    +-----------------------------------+-----------------------------------------------------------------------+</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span> <span class="nn">math</span>

<span class="kn">from</span> <span class="nn">LUPY</span> <span class="kn">import</span> <span class="n">ancestry</span> <span class="k">as</span> <span class="n">ancestryModule</span>

<span class="kn">from</span> <span class="nn">pqu</span> <span class="kn">import</span> <span class="n">PQU</span> <span class="k">as</span> <span class="n">PQUModule</span>
<span class="kn">from</span> <span class="nn">fudge.core.utilities</span> <span class="kn">import</span> <span class="n">brb</span>

<span class="kn">from</span> <span class="nn">xData</span> <span class="kn">import</span> <span class="n">enums</span> <span class="k">as</span> <span class="n">xDataEnumsModule</span>
<span class="kn">from</span> <span class="nn">xData</span> <span class="kn">import</span> <span class="n">base</span> <span class="k">as</span> <span class="n">xDataBaseModule</span>
<span class="kn">from</span> <span class="nn">xData</span> <span class="kn">import</span> <span class="n">axes</span> <span class="k">as</span> <span class="n">axesModule</span>
<span class="kn">from</span> <span class="nn">xData</span> <span class="kn">import</span> <span class="n">XYs1d</span> <span class="k">as</span> <span class="n">XYs1dModule</span>
<span class="kn">from</span> <span class="nn">xData</span> <span class="kn">import</span> <span class="n">xs_pdf_cdf</span> <span class="k">as</span> <span class="n">xs_pdf_cdfModule</span>
<span class="kn">from</span> <span class="nn">xData</span> <span class="kn">import</span> <span class="n">multiD_XYs</span> <span class="k">as</span> <span class="n">multiD_XYsModule</span>
<span class="kn">from</span> <span class="nn">xData</span> <span class="kn">import</span> <span class="n">regions</span> <span class="k">as</span> <span class="n">regionsModule</span>

<span class="kn">from</span> <span class="nn">fudge</span> <span class="kn">import</span> <span class="n">physicalQuantity</span> <span class="k">as</span> <span class="n">physicalQuantityModule</span>

<span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">base</span> <span class="k">as</span> <span class="n">baseModule</span>
<span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">probabilities</span> <span class="k">as</span> <span class="n">probabilitiesModule</span>
<span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">miscellaneous</span> <span class="k">as</span> <span class="n">miscellaneousModule</span>

<div class="viewcode-block" id="defaultAxes"><a class="viewcode-back" href="../../../../fudge/fudge.productData.distributions.html#fudge.productData.distributions.energy.defaultAxes">[docs]</a><span class="k">def</span> <span class="nf">defaultAxes</span><span class="p">(</span> <span class="n">energyUnit</span> <span class="p">)</span> <span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns an :py:class:`Axes` instance for energy data (i.e., :math:`P(E&#39;|E)`.</span>

<span class="sd">    :param energyUnit:  Unit for the energy data.</span>

<span class="sd">    :return:            An :py:class:`Axes` instance.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">axes</span> <span class="o">=</span> <span class="n">axesModule</span><span class="o">.</span><span class="n">Axes</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">axesModule</span><span class="o">.</span><span class="n">Axis</span><span class="p">(</span> <span class="s1">&#39;energy_in&#39;</span><span class="p">,</span>  <span class="mi">2</span><span class="p">,</span> <span class="n">energyUnit</span> <span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">axesModule</span><span class="o">.</span><span class="n">Axis</span><span class="p">(</span> <span class="s1">&#39;energy_out&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">energyUnit</span> <span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">axesModule</span><span class="o">.</span><span class="n">Axis</span><span class="p">(</span> <span class="s1">&#39;P(energy_out|energy_in)&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;1/&#39;</span> <span class="o">+</span> <span class="n">energyUnit</span> <span class="p">)</span>
    <span class="k">return</span><span class="p">(</span> <span class="n">axes</span> <span class="p">)</span></div>

<div class="viewcode-block" id="XYs1d"><a class="viewcode-back" href="../../../../fudge/fudge.productData.distributions.html#fudge.productData.distributions.energy.XYs1d">[docs]</a><span class="k">class</span> <span class="nc">XYs1d</span><span class="p">(</span> <span class="n">XYs1dModule</span><span class="o">.</span><span class="n">XYs1d</span> <span class="p">)</span> <span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Class to Store :math:`P(E&#39;)` as a list of pairs of :math:`Ei&#39;_i`, :math:`P_i`.</span>
<span class="sd">    &quot;&quot;&quot;</span>

<div class="viewcode-block" id="XYs1d.averageEnergy"><a class="viewcode-back" href="../../../../fudge/fudge.productData.distributions.html#fudge.productData.distributions.energy.XYs1d.averageEnergy">[docs]</a>    <span class="k">def</span> <span class="nf">averageEnergy</span><span class="p">(</span> <span class="bp">self</span> <span class="p">)</span> <span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The method calculates the average outgoing energy of *self*.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">allowedInterpolations</span> <span class="o">=</span> <span class="p">[</span><span class="n">xDataEnumsModule</span><span class="o">.</span><span class="n">Interpolation</span><span class="o">.</span><span class="n">linlin</span><span class="p">,</span> <span class="n">xDataEnumsModule</span><span class="o">.</span><span class="n">Interpolation</span><span class="o">.</span><span class="n">flat</span><span class="p">]</span>
        <span class="n">xys</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">changeInterpolationIfNeeded</span><span class="p">(</span> <span class="n">allowedInterpolations</span><span class="p">,</span> <span class="n">XYs1dModule</span><span class="o">.</span><span class="n">defaultAccuracy</span> <span class="p">)</span>
        <span class="k">return</span><span class="p">(</span> <span class="n">xys</span><span class="o">.</span><span class="n">integrateWithWeight_x</span><span class="p">(</span> <span class="p">)</span> <span class="p">)</span></div>

<div class="viewcode-block" id="XYs1d.toLinearXYsClass"><a class="viewcode-back" href="../../../../fudge/fudge.productData.distributions.html#fudge.productData.distributions.energy.XYs1d.toLinearXYsClass">[docs]</a>    <span class="k">def</span> <span class="nf">toLinearXYsClass</span><span class="p">(</span> <span class="bp">self</span> <span class="p">)</span> <span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This method returns the class for representing linear point-wise 1-d data of *self*.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span><span class="p">(</span> <span class="n">XYs1d</span> <span class="p">)</span></div></div>

<div class="viewcode-block" id="Regions1d"><a class="viewcode-back" href="../../../../fudge/fudge.productData.distributions.html#fudge.productData.distributions.energy.Regions1d">[docs]</a><span class="k">class</span> <span class="nc">Regions1d</span><span class="p">(</span> <span class="n">regionsModule</span><span class="o">.</span><span class="n">Regions1d</span> <span class="p">)</span> <span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Stores :math:`P(E&#39;)` as a list of other 1d energy distribuitions that abut in :math:`E&#39;` and are contiguous. </span>
<span class="sd">    &quot;&quot;&quot;</span>

<div class="viewcode-block" id="Regions1d.averageEnergy"><a class="viewcode-back" href="../../../../fudge/fudge.productData.distributions.html#fudge.productData.distributions.energy.Regions1d.averageEnergy">[docs]</a>    <span class="k">def</span> <span class="nf">averageEnergy</span><span class="p">(</span> <span class="bp">self</span> <span class="p">)</span> <span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The method calculates the average outgoing energy of *self*.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">averageEnergy</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">region</span> <span class="ow">in</span> <span class="bp">self</span> <span class="p">:</span> <span class="n">averageEnergy</span> <span class="o">+=</span> <span class="n">region</span><span class="o">.</span><span class="n">averageEnergy</span><span class="p">(</span> <span class="p">)</span>
        <span class="k">return</span><span class="p">(</span> <span class="n">averageEnergy</span> <span class="p">)</span></div>

<div class="viewcode-block" id="Regions1d.integrateWithWeight_x"><a class="viewcode-back" href="../../../../fudge/fudge.productData.distributions.html#fudge.productData.distributions.energy.Regions1d.integrateWithWeight_x">[docs]</a>    <span class="k">def</span> <span class="nf">integrateWithWeight_x</span><span class="p">(</span> <span class="bp">self</span> <span class="p">)</span> <span class="p">:</span>
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the value of the integral :math:`\int dE&#39; E&#39; P(E&#39;).</span>

<span class="sd">        :return:        A float.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="nb">sum</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">region</span> <span class="ow">in</span> <span class="bp">self</span> <span class="p">:</span> <span class="nb">sum</span> <span class="o">+=</span> <span class="n">region</span><span class="o">.</span><span class="n">integrateWithWeight_x</span><span class="p">(</span> <span class="p">)</span>
        <span class="k">return</span><span class="p">(</span> <span class="nb">sum</span> <span class="p">)</span></div>

<div class="viewcode-block" id="Regions1d.toLinearXYsClass"><a class="viewcode-back" href="../../../../fudge/fudge.productData.distributions.html#fudge.productData.distributions.energy.Regions1d.toLinearXYsClass">[docs]</a>    <span class="k">def</span> <span class="nf">toLinearXYsClass</span><span class="p">(</span> <span class="bp">self</span> <span class="p">)</span> <span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This method returns the class for representing linear point-wise 1-d data of *self*.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span><span class="p">(</span> <span class="n">XYs1d</span> <span class="p">)</span></div>

<div class="viewcode-block" id="Regions1d.allowedSubElements"><a class="viewcode-back" href="../../../../fudge/fudge.productData.distributions.html#fudge.productData.distributions.energy.Regions1d.allowedSubElements">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">allowedSubElements</span><span class="p">():</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This method returns the list of classes that can be sub-nodes (i.e., 2-d function) of an :py:class:`Regions1d` instance.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span><span class="p">(</span> <span class="n">XYs1d</span><span class="p">,</span> <span class="p">)</span></div></div>

<div class="viewcode-block" id="Xs_pdf_cdf1d"><a class="viewcode-back" href="../../../../fudge/fudge.productData.distributions.html#fudge.productData.distributions.energy.Xs_pdf_cdf1d">[docs]</a><span class="k">class</span> <span class="nc">Xs_pdf_cdf1d</span><span class="p">(</span> <span class="n">xs_pdf_cdfModule</span><span class="o">.</span><span class="n">Xs_pdf_cdf1d</span> <span class="p">)</span> <span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This class stores both the :math:`P(E&#39;|E)` (i.e., pdf) and its cumlative distribution function cdf as three lists: one list</span>
<span class="sd">    for the :math:`E&#39;` values, and one list for the associated pdf value and one list for the associated cdf value for each :math:`E&#39;` value,</span>
<span class="sd">    &quot;&quot;&quot;</span>

<div class="viewcode-block" id="Xs_pdf_cdf1d.toLinearXYsClass"><a class="viewcode-back" href="../../../../fudge/fudge.productData.distributions.html#fudge.productData.distributions.energy.Xs_pdf_cdf1d.toLinearXYsClass">[docs]</a>    <span class="k">def</span> <span class="nf">toLinearXYsClass</span><span class="p">(</span> <span class="bp">self</span> <span class="p">)</span> <span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This method returns the class for representing linear point-wise 1-d data of *self*.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span><span class="p">(</span> <span class="n">XYs1d</span> <span class="p">)</span></div></div>

<div class="viewcode-block" id="Subform"><a class="viewcode-back" href="../../../../fudge/fudge.productData.distributions.html#fudge.productData.distributions.energy.Subform">[docs]</a><span class="k">class</span> <span class="nc">Subform</span><span class="p">(</span> <span class="n">baseModule</span><span class="o">.</span><span class="n">Subform</span> <span class="p">)</span> <span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Abstract base class for 2d energy subforms.&quot;&quot;&quot;</span>

<div class="viewcode-block" id="Subform.to_xs_pdf_cdf1d"><a class="viewcode-back" href="../../../../fudge/fudge.productData.distributions.html#fudge.productData.distributions.energy.Subform.to_xs_pdf_cdf1d">[docs]</a>    <span class="k">def</span> <span class="nf">to_xs_pdf_cdf1d</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">style</span><span class="p">,</span> <span class="n">tempInfo</span><span class="p">,</span> <span class="n">indent</span> <span class="p">)</span> <span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This method returns None.</span>

<span class="sd">        :param style:           The style for the returned data.</span>
<span class="sd">        :param tempInfo:        Dictionary of data needed to calculate the data.</span>
<span class="sd">        :param indent:          The indentation for any verbosity.</span>

<span class="sd">        :return:                None.</span>
<span class="sd">        &quot;&quot;&quot;</span>


        <span class="k">return</span><span class="p">(</span> <span class="kc">None</span> <span class="p">)</span></div></div>

<div class="viewcode-block" id="DiscretePrimaryGamma"><a class="viewcode-back" href="../../../../fudge/fudge.productData.distributions.html#fudge.productData.distributions.energy.DiscretePrimaryGamma">[docs]</a><span class="k">class</span> <span class="nc">DiscretePrimaryGamma</span><span class="p">(</span> <span class="n">Subform</span> <span class="p">)</span> <span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Abstract base class for classes :py:class:`DiscreteGamma` and :py:class:`PrimaryGamma`.</span>

<span class="sd">    :param value:       Discrete photon energy or nuclear binding energy needed to calcualte the ergy for a primary photon.</span>
<span class="sd">    :param domainMin:   Minimum projectile energy for which the photon is emitted.</span>
<span class="sd">    :param domainMax:   Maximum projectile energy for which the photon is emitted.</span>
<span class="sd">    :param axes:        Axes instance for the data.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">dimension</span> <span class="o">=</span> <span class="mi">2</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">domainMin</span><span class="p">,</span> <span class="n">domainMax</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="kc">None</span> <span class="p">)</span> <span class="p">:</span>

        <span class="n">Subform</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span> <span class="bp">self</span> <span class="p">)</span>

        <span class="k">if</span><span class="p">(</span> <span class="nb">isinstance</span><span class="p">(</span> <span class="n">value</span><span class="p">,</span> <span class="nb">int</span> <span class="p">)</span> <span class="p">)</span> <span class="p">:</span> <span class="n">value</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span> <span class="n">value</span> <span class="p">)</span>
        <span class="k">if</span><span class="p">(</span> <span class="ow">not</span><span class="p">(</span> <span class="nb">isinstance</span><span class="p">(</span> <span class="n">value</span><span class="p">,</span> <span class="nb">float</span> <span class="p">)</span> <span class="p">)</span> <span class="p">)</span> <span class="p">:</span> <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span> <span class="s1">&#39;value must be a float.&#39;</span> <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">value</span>

        <span class="k">if</span><span class="p">(</span> <span class="nb">isinstance</span><span class="p">(</span> <span class="n">domainMin</span><span class="p">,</span> <span class="nb">int</span> <span class="p">)</span> <span class="p">)</span> <span class="p">:</span> <span class="n">domainMin</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span> <span class="n">domainMin</span> <span class="p">)</span>
        <span class="k">if</span><span class="p">(</span> <span class="ow">not</span><span class="p">(</span> <span class="nb">isinstance</span><span class="p">(</span> <span class="n">domainMin</span><span class="p">,</span> <span class="nb">float</span> <span class="p">)</span> <span class="p">)</span> <span class="p">)</span> <span class="p">:</span> <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span> <span class="s1">&#39;domainMin must be a float.&#39;</span> <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__domainMin</span> <span class="o">=</span> <span class="n">domainMin</span>

        <span class="k">if</span><span class="p">(</span> <span class="nb">isinstance</span><span class="p">(</span> <span class="n">domainMax</span><span class="p">,</span> <span class="nb">int</span> <span class="p">)</span> <span class="p">)</span> <span class="p">:</span> <span class="n">domainMax</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span> <span class="n">domainMax</span> <span class="p">)</span>
        <span class="k">if</span><span class="p">(</span> <span class="ow">not</span><span class="p">(</span> <span class="nb">isinstance</span><span class="p">(</span> <span class="n">domainMax</span><span class="p">,</span> <span class="nb">float</span> <span class="p">)</span> <span class="p">)</span> <span class="p">)</span> <span class="p">:</span> <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span> <span class="s1">&#39;domainMax must be a float.&#39;</span> <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__domainMax</span> <span class="o">=</span> <span class="n">domainMax</span>

        <span class="k">if</span><span class="p">(</span> <span class="n">axes</span> <span class="ow">is</span> <span class="kc">None</span> <span class="p">)</span> <span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__axes</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">else</span> <span class="p">:</span>
            <span class="k">if</span><span class="p">(</span> <span class="ow">not</span><span class="p">(</span> <span class="nb">isinstance</span><span class="p">(</span> <span class="n">axes</span><span class="p">,</span> <span class="n">axesModule</span><span class="o">.</span><span class="n">Axes</span> <span class="p">)</span> <span class="p">)</span> <span class="p">)</span> <span class="p">:</span> <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span> <span class="s1">&#39;axes is not an axes instance&#39;</span> <span class="p">)</span>
            <span class="k">if</span><span class="p">(</span> <span class="nb">len</span><span class="p">(</span> <span class="n">axes</span> <span class="p">)</span> <span class="o">&lt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dimension</span> <span class="p">)</span> <span class="p">:</span> <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span> <span class="s1">&#39;len( axes ) = </span><span class="si">%d</span><span class="s1"> != ( self.dimension + 1 ) = </span><span class="si">%d</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span> <span class="nb">len</span><span class="p">(</span> <span class="n">axes</span> <span class="p">),</span> <span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">dimension</span> <span class="o">+</span> <span class="mi">1</span> <span class="p">)</span> <span class="p">)</span> <span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__axes</span> <span class="o">=</span> <span class="n">axes</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span> <span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__axes</span><span class="o">.</span><span class="n">setAncestor</span><span class="p">(</span> <span class="bp">self</span> <span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">axes</span><span class="p">(</span> <span class="bp">self</span> <span class="p">)</span> <span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns a return to the axes of *self*.&quot;&quot;&quot;</span>

        <span class="k">return</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">__axes</span> <span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">domainMin</span><span class="p">(</span> <span class="bp">self</span> <span class="p">)</span> <span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the minimum projectile energy for *self*.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">__domainMin</span> <span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">domainMax</span><span class="p">(</span> <span class="bp">self</span> <span class="p">)</span> <span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the maximum projectile energy for *self*.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">__domainMax</span> <span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">domainUnit</span><span class="p">(</span> <span class="bp">self</span> <span class="p">)</span> <span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the energy unit of the projectile.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">__axes</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">unit</span> <span class="p">)</span>

<div class="viewcode-block" id="DiscretePrimaryGamma.convertUnits"><a class="viewcode-back" href="../../../../fudge/fudge.productData.distributions.html#fudge.productData.distributions.energy.DiscretePrimaryGamma.convertUnits">[docs]</a>    <span class="k">def</span> <span class="nf">convertUnits</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">unitMap</span> <span class="p">)</span> <span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Converts all data in *self* per *unitMap*.</span>

<span class="sd">        :param unitMap:     A dictionary in which each key is a unit that will be replaced by its value which must be an equivalent unit.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">factors</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">convertUnits</span><span class="p">(</span> <span class="n">unitMap</span> <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">*=</span> <span class="n">factors</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__domainMin</span> <span class="o">*=</span> <span class="n">factors</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__domainMax</span> <span class="o">*=</span> <span class="n">factors</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span></div>

<div class="viewcode-block" id="DiscretePrimaryGamma.copy"><a class="viewcode-back" href="../../../../fudge/fudge.productData.distributions.html#fudge.productData.distributions.energy.DiscretePrimaryGamma.copy">[docs]</a>    <span class="k">def</span> <span class="nf">copy</span><span class="p">(</span> <span class="bp">self</span> <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a copy of *self*.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">__domainMin</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">__domainMax</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">axes</span> <span class="p">)</span></div>

    <span class="n">__copy__</span> <span class="o">=</span> <span class="n">copy</span>

<div class="viewcode-block" id="DiscretePrimaryGamma.energySpectrumAtEnergy"><a class="viewcode-back" href="../../../../fudge/fudge.productData.distributions.html#fudge.productData.distributions.energy.DiscretePrimaryGamma.energySpectrumAtEnergy">[docs]</a>    <span class="k">def</span> <span class="nf">energySpectrumAtEnergy</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">energy</span><span class="p">,</span> <span class="n">discreteGammaResolution</span> <span class="o">=</span> <span class="mf">1e-2</span> <span class="p">)</span> <span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calculates the outgoing particle&#39;s energy spectrum at projectile energy *energy*,</span>

<span class="sd">        :param energyIn:                    Energy of the projectile.</span>
<span class="sd">        :param discreteGammaResolution:     Relative width of triangle presenting the energy spectrum.</span>

<span class="sd">        :return:                    XYs1d instance for the energy spectrum.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span><span class="p">(</span> <span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">__domainMin</span> <span class="o">&gt;</span> <span class="n">energy</span> <span class="p">)</span> <span class="ow">or</span> <span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">__domainMax</span> <span class="o">&lt;</span> <span class="n">energy</span> <span class="p">)</span> <span class="p">)</span> <span class="p">:</span> <span class="k">return</span><span class="p">(</span> <span class="n">XYs1d</span><span class="p">(</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">defaultAxes</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">domainUnit</span> <span class="p">)</span> <span class="p">)</span> <span class="p">)</span>

        <span class="n">photonEnergy</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">energyAtEnergy</span><span class="p">(</span> <span class="n">energy</span> <span class="p">)</span>
        <span class="n">energy1</span> <span class="o">=</span> <span class="n">photonEnergy</span> <span class="o">*</span> <span class="p">(</span> <span class="mf">1.0</span> <span class="o">-</span> <span class="n">discreteGammaResolution</span> <span class="p">)</span>
        <span class="n">energy2</span> <span class="o">=</span> <span class="n">photonEnergy</span> <span class="o">*</span> <span class="p">(</span> <span class="mf">1.0</span> <span class="o">+</span> <span class="n">discreteGammaResolution</span> <span class="p">)</span>
        <span class="n">height</span> <span class="o">=</span> <span class="mf">2.0</span> <span class="o">/</span> <span class="p">(</span> <span class="n">energy2</span> <span class="o">-</span> <span class="n">energy1</span> <span class="p">)</span>
        <span class="k">return</span><span class="p">(</span> <span class="n">XYs1d</span><span class="p">(</span> <span class="n">data</span> <span class="o">=</span> <span class="p">[</span> <span class="p">[</span> <span class="n">energy1</span><span class="p">,</span> <span class="mf">0.0</span> <span class="p">],</span> <span class="p">[</span> <span class="n">photonEnergy</span><span class="p">,</span> <span class="n">height</span> <span class="p">],</span> <span class="p">[</span> <span class="n">energy2</span><span class="p">,</span> <span class="mf">0.0</span> <span class="p">]</span> <span class="p">],</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">defaultAxes</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">domainUnit</span> <span class="p">)</span> <span class="p">)</span> <span class="p">)</span></div>

<div class="viewcode-block" id="DiscretePrimaryGamma.fixDomains"><a class="viewcode-back" href="../../../../fudge/fudge.productData.distributions.html#fudge.productData.distributions.energy.DiscretePrimaryGamma.fixDomains">[docs]</a>    <span class="k">def</span> <span class="nf">fixDomains</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">domainMin</span><span class="p">,</span> <span class="n">domainMax</span><span class="p">,</span> <span class="n">fixToDomain</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Sets *domainMin* and *domainMax* per the arguments.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">OldDomainMin</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">domainMin</span>
        <span class="n">OldDomainMax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">domainMax</span>

        <span class="n">domainMin</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">domainMin</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">domainMin</span><span class="p">)</span>
        <span class="n">domainMax</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">domainMax</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">domainMax</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">fixToDomain</span> <span class="o">==</span> <span class="n">xDataEnumsModule</span><span class="o">.</span><span class="n">FixDomain</span><span class="o">.</span><span class="n">lower</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">domainMin</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">__domainMin</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">__domainMin</span> <span class="o">=</span> <span class="n">domainMin</span>
        <span class="k">elif</span> <span class="n">fixToDomain</span> <span class="o">==</span> <span class="n">xDataEnumsModule</span><span class="o">.</span><span class="n">FixDomain</span><span class="o">.</span><span class="n">upper</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__domainMax</span> <span class="o">=</span> <span class="n">domainMax</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__domainMin</span> <span class="o">=</span> <span class="n">domainMin</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__domainMax</span> <span class="o">=</span> <span class="n">domainMax</span>

        <span class="k">if</span> <span class="n">OldDomainMin</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">domainMin</span> <span class="ow">and</span> <span class="n">OldDomainMax</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">domainMax</span><span class="p">:</span> <span class="k">return</span> <span class="mi">0</span>
        <span class="k">return</span> <span class="mi">1</span></div>

<div class="viewcode-block" id="DiscretePrimaryGamma.toXML_strList"><a class="viewcode-back" href="../../../../fudge/fudge.productData.distributions.html#fudge.productData.distributions.energy.DiscretePrimaryGamma.toXML_strList">[docs]</a>    <span class="k">def</span> <span class="nf">toXML_strList</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">indent</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span> <span class="p">)</span> <span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a list of str instances representing the XML lines of *self*.</span>

<span class="sd">        :param indent:          The amount of indentation for each line. Child nodes and text may be indented more.</span>
<span class="sd">        :param kwargs:          A dictionary of extra arguments that controls how *self* is converted to a list of XML strings.</span>

<span class="sd">        :return:                List of str instances representing the XML lines of self.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">indent2</span> <span class="o">=</span> <span class="n">indent</span> <span class="o">+</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span> <span class="s1">&#39;incrementalIndent&#39;</span><span class="p">,</span> <span class="s1">&#39;  &#39;</span> <span class="p">)</span>

        <span class="n">extraAttribute</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">PrimaryGamma</span><span class="p">):</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">finalState</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">extraAttribute</span> <span class="o">=</span> <span class="s1">&#39; finalState=&quot;</span><span class="si">%s</span><span class="s1">&quot;&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">finalState</span>

        <span class="n">XMLStringList</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1">&lt;</span><span class="si">%s</span><span class="s1"> value=&quot;</span><span class="si">%s</span><span class="s1">&quot; domainMin=&quot;</span><span class="si">%s</span><span class="s1">&quot; domainMax=&quot;</span><span class="si">%s</span><span class="s1">&quot;</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">indent</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">moniker</span><span class="p">,</span> <span class="n">PQUModule</span><span class="o">.</span><span class="n">floatToShortestString</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="mi">12</span><span class="p">),</span> 
                <span class="n">PQUModule</span><span class="o">.</span><span class="n">floatToShortestString</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__domainMin</span><span class="p">,</span> <span class="mi">12</span><span class="p">),</span> <span class="n">PQUModule</span><span class="o">.</span><span class="n">floatToShortestString</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__domainMax</span><span class="p">,</span> <span class="mi">12</span><span class="p">),</span> <span class="n">extraAttribute</span><span class="p">)]</span>

        <span class="k">if</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">axes</span> <span class="ow">is</span> <span class="kc">None</span> <span class="p">)</span> <span class="p">:</span> 
            <span class="n">XMLStringList</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+=</span> <span class="s1">&#39;/&gt;&#39;</span>
        <span class="k">else</span> <span class="p">:</span>
            <span class="n">XMLStringList</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+=</span> <span class="s1">&#39;&gt;&#39;</span>
            <span class="n">XMLStringList</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">toXML_strList</span><span class="p">(</span> <span class="n">indent</span><span class="o">=</span><span class="n">indent2</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span> <span class="p">)</span>
            <span class="n">XMLStringList</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+=</span> <span class="s1">&#39;&lt;/</span><span class="si">%s</span><span class="s1">&gt;&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">moniker</span>

        <span class="k">return</span> <span class="n">XMLStringList</span></div>

<div class="viewcode-block" id="DiscretePrimaryGamma.parseNodeUsingClass"><a class="viewcode-back" href="../../../../fudge/fudge.productData.distributions.html#fudge.productData.distributions.energy.DiscretePrimaryGamma.parseNodeUsingClass">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">parseNodeUsingClass</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">node</span><span class="p">,</span> <span class="n">xPath</span><span class="p">,</span> <span class="n">linkData</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Parse *node* into an instance of *cls*.</span>

<span class="sd">        :param cls:         Form class to return.</span>
<span class="sd">        :param node:        Node to parse.</span>
<span class="sd">        :param xPath:       List containing xPath to current node, useful mostly for debugging.</span>
<span class="sd">        :param linkData:    dict that collects unresolved links.</span>
<span class="sd">        :param kwargs:      A dictionary of extra arguments that controls how *self* is converted to a list of XML strings.</span>

<span class="sd">        :return: an instance of *cls* representing *node*.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">value</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;value&#39;</span><span class="p">))</span>
        <span class="n">domainMin</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;domainMin&#39;</span><span class="p">))</span>
        <span class="n">domainMax</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;domainMax&#39;</span><span class="p">))</span>
        <span class="n">finalState</span> <span class="o">=</span> <span class="n">node</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;finalState&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

        <span class="n">axes</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">for</span> <span class="n">child</span> <span class="ow">in</span> <span class="n">node</span><span class="p">:</span>
            <span class="k">if</span><span class="p">(</span> <span class="n">child</span><span class="o">.</span><span class="n">tag</span> <span class="o">==</span> <span class="n">axesModule</span><span class="o">.</span><span class="n">Axes</span><span class="o">.</span><span class="n">moniker</span> <span class="p">)</span> <span class="p">:</span>
                <span class="n">axes</span> <span class="o">=</span> <span class="n">axesModule</span><span class="o">.</span><span class="n">Axes</span><span class="o">.</span><span class="n">parseNodeUsingClass</span><span class="p">(</span><span class="n">child</span><span class="p">,</span> <span class="n">xPath</span><span class="p">,</span> <span class="n">linkData</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="k">else</span> <span class="p">:</span>
                <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s1">&#39;Invalid child node with tag = &quot;</span><span class="si">%s</span><span class="s1">&quot;&#39;</span> <span class="o">%</span> <span class="n">child</span><span class="o">.</span><span class="n">tag</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">issubclass</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">PrimaryGamma</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">domainMin</span><span class="p">,</span> <span class="n">domainMax</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="n">axes</span><span class="p">,</span> <span class="n">finalState</span><span class="o">=</span><span class="n">finalState</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">domainMin</span><span class="p">,</span> <span class="n">domainMax</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="n">axes</span><span class="p">)</span></div>

<div class="viewcode-block" id="DiscretePrimaryGamma.getEnergyArray"><a class="viewcode-back" href="../../../../fudge/fudge.productData.distributions.html#fudge.productData.distributions.energy.DiscretePrimaryGamma.getEnergyArray">[docs]</a>    <span class="k">def</span> <span class="nf">getEnergyArray</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">EMin</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">EMax</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This method returns the list of projectile energies that *self* is specific at.</span>

<span class="sd">        :parem EMin:        If *self* does not have an projectile energy values, the default minimum energy to return.</span>
<span class="sd">        :parem EMax:        If *self* does not have an projectile energy values, the default maximum energy to return.</span>

<span class="sd">        :return:            Python list of float.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">domainMin</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">domainMax</span><span class="p">]</span></div></div>

<div class="viewcode-block" id="DiscreteGamma"><a class="viewcode-back" href="../../../../fudge/fudge.productData.distributions.html#fudge.productData.distributions.energy.DiscreteGamma">[docs]</a><span class="k">class</span> <span class="nc">DiscreteGamma</span><span class="p">(</span><span class="n">DiscretePrimaryGamma</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This class stores the data for a discrete (i.e., secondary) gamma that results from the decay of a nucleus</span>
<span class="sd">    from one nuclear energy level to a lower nuclear energy level,</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">moniker</span> <span class="o">=</span> <span class="s1">&#39;discreteGamma&#39;</span>

<div class="viewcode-block" id="DiscreteGamma.check"><a class="viewcode-back" href="../../../../fudge/fudge.productData.distributions.html#fudge.productData.distributions.energy.DiscreteGamma.check">[docs]</a>    <span class="k">def</span> <span class="nf">check</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">info</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Does a check of *self*&#39;s data.</span>

<span class="sd">        :param info:        A dictionary with parameters used for determining if a difference is relevant.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="kn">from</span> <span class="nn">fudge</span> <span class="kn">import</span> <span class="n">warning</span>

        <span class="n">warnings</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span> <span class="n">warnings</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">warning</span><span class="o">.</span><span class="n">NegativeDiscreteGammaEnergy</span><span class="p">())</span>
        <span class="k">return</span> <span class="n">warnings</span></div>

<div class="viewcode-block" id="DiscreteGamma.averageEp"><a class="viewcode-back" href="../../../../fudge/fudge.productData.distributions.html#fudge.productData.distributions.energy.DiscreteGamma.averageEp">[docs]</a>    <span class="k">def</span> <span class="nf">averageEp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">E</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calculated the average energy of the outgoing photon which is just its energy.</span>

<span class="sd">        :param E:       The energy of the projectile energy. This is not needed for a discrete photon.</span>

<span class="sd">        :return:                Python float.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">energyAtEnergy</span><span class="p">(</span><span class="n">E</span><span class="p">)</span></div>

<div class="viewcode-block" id="DiscreteGamma.energyAtEnergy"><a class="viewcode-back" href="../../../../fudge/fudge.productData.distributions.html#fudge.productData.distributions.energy.DiscreteGamma.energyAtEnergy">[docs]</a>    <span class="k">def</span> <span class="nf">energyAtEnergy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">energyIn</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the energy of the outgoing photon which is just its energy.</span>

<span class="sd">        :param energyIn:        The energy of the projectile energy. This is not needed for a discrete photon.</span>

<span class="sd">        :return:                Python float.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">energyIn</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">domainMin</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">0</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span></div>

<div class="viewcode-block" id="DiscreteGamma.integrate"><a class="viewcode-back" href="../../../../fudge/fudge.productData.distributions.html#fudge.productData.distributions.energy.DiscreteGamma.integrate">[docs]</a>    <span class="k">def</span> <span class="nf">integrate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">energyIn</span><span class="p">,</span> <span class="n">energyOut</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This meethod integrates the energu distribution at projectile energy over the specified outgoing energy range.</span>
<span class="sd">        See function :py:func:`miscellaneousModule.domainLimits` for how to specify *energyOut*.</span>
<span class="sd">        </span>
<span class="sd">        :param energyIn:            The energy of the projectile.</span>
<span class="sd">        :param energyOut:           The outgoing energy range to integrate over.</span>

<span class="sd">        :return:                    A float representing the value of the integration.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">domainMin</span> <span class="o">&lt;=</span> <span class="n">energyIn</span> <span class="o">&lt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">domainMax</span><span class="p">:</span>
            <span class="n">domainMin</span><span class="p">,</span> <span class="n">domainMax</span> <span class="o">=</span> <span class="n">miscellaneousModule</span><span class="o">.</span><span class="n">domainLimits</span><span class="p">(</span><span class="n">energyOut</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">domainMin</span> <span class="o">&lt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">&lt;=</span> <span class="n">domainMax</span><span class="p">:</span> <span class="k">return</span> <span class="mf">1.0</span>

        <span class="k">return</span> <span class="mf">0.0</span></div></div>


<div class="viewcode-block" id="PrimaryGamma"><a class="viewcode-back" href="../../../../fudge/fudge.productData.distributions.html#fudge.productData.distributions.energy.PrimaryGamma">[docs]</a><span class="k">class</span> <span class="nc">PrimaryGamma</span><span class="p">(</span><span class="n">DiscretePrimaryGamma</span><span class="p">):</span>

    <span class="n">moniker</span> <span class="o">=</span> <span class="s1">&#39;primaryGamma&#39;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">domainMin</span><span class="p">,</span> <span class="n">domainMax</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">finalState</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Constructor.</span>

<span class="sd">        :param value:           The neutron binding energy.</span>
<span class="sd">        :param domainMin:       The minimum projectile energy that the primary photon is emitted.</span>
<span class="sd">        :param domainMax:       The maximum projectile energy that the primary photon is emitted.</span>
<span class="sd">        :param axes:            The axes for *self*.</span>
<span class="sd">        :param finalState:      The nuclear state the compound is in after the primary photon (gamma) is emitted.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">DiscretePrimaryGamma</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">domainMin</span><span class="p">,</span> <span class="n">domainMax</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="n">axes</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__massRatio</span> <span class="o">=</span> <span class="kc">None</span>     <span class="c1"># In ENDF lingo this is AWR / ( AWR + 1 ).</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">finalState</span> <span class="o">=</span> <span class="n">finalState</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">finalState</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns the finalState.&quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__finalState</span>

    <span class="nd">@finalState</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">finalState</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the final state member to *value*.</span>

<span class="sd">        :param value:   The value to set finalState to.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="kc">None</span><span class="p">))):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;Invalid finalState type: got &quot;</span><span class="si">%s</span><span class="s1">&quot;.&#39;</span> <span class="o">%</span> <span class="nb">type</span><span class="p">(</span><span class="n">value</span><span class="p">))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">__finalState</span> <span class="o">=</span> <span class="n">value</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">massRatio</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the ratio of the target mass to the sum of the projectile and target masses.</span>

<span class="sd">        :return:        Python float.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__massRatio</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__massRatio</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">findAttributeInAncestry</span><span class="p">(</span><span class="s2">&quot;getMassRatio&quot;</span><span class="p">)()</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__massRatio</span>

<div class="viewcode-block" id="PrimaryGamma.check"><a class="viewcode-back" href="../../../../fudge/fudge.productData.distributions.html#fudge.productData.distributions.energy.PrimaryGamma.check">[docs]</a>    <span class="k">def</span> <span class="nf">check</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">info</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Does a check of *self*&#39;s data.</span>

<span class="sd">        :param info:        A dictionary with parameters used for determining if a difference is relevant.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="kn">from</span> <span class="nn">fudge</span> <span class="kn">import</span> <span class="n">warning</span>

        <span class="n">warnings</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">Qvalue</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">findAttributeInAncestry</span><span class="p">(</span><span class="s1">&#39;getQ&#39;</span><span class="p">)(</span><span class="s1">&#39;eV&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">PQUModule</span><span class="o">.</span><span class="n">PQU</span><span class="p">):</span>
            <span class="n">testValue</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">getValueAs</span><span class="p">(</span><span class="s1">&#39;eV&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">testValue</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span>
        <span class="k">if</span> <span class="n">testValue</span> <span class="o">&gt;</span> <span class="n">Qvalue</span><span class="p">:</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">warning</span><span class="o">.</span><span class="n">PrimaryGammaEnergyTooLarge</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="mi">100</span> <span class="o">*</span> <span class="n">testValue</span> <span class="o">/</span> <span class="n">Qvalue</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">warnings</span></div>

<div class="viewcode-block" id="PrimaryGamma.averageEp"><a class="viewcode-back" href="../../../../fudge/fudge.productData.distributions.html#fudge.productData.distributions.energy.PrimaryGamma.averageEp">[docs]</a>    <span class="k">def</span> <span class="nf">averageEp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">energyIn</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calculated the average energy of the outgoing photon at projectile energy *energyIn*.</span>

<span class="sd">        :param energyIn:       The energy of the projectile energy.</span>

<span class="sd">        :return:                Python float.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">energyAtEnergy</span><span class="p">(</span><span class="n">energyIn</span><span class="p">)</span></div>

<div class="viewcode-block" id="PrimaryGamma.energyAtEnergy"><a class="viewcode-back" href="../../../../fudge/fudge.productData.distributions.html#fudge.productData.distributions.energy.PrimaryGamma.energyAtEnergy">[docs]</a>    <span class="k">def</span> <span class="nf">energyAtEnergy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">energyIn</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the energy of the outgoing photon for projectile energy *energyIn*.</span>

<span class="sd">        :param energyIn:        The energy of the projectile energy.</span>

<span class="sd">        :return:                Python float.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">energyIn</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">domainMin</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">0</span>
        <span class="k">return</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">massRatio</span> <span class="o">*</span> <span class="n">energyIn</span></div>

<div class="viewcode-block" id="PrimaryGamma.integrate"><a class="viewcode-back" href="../../../../fudge/fudge.productData.distributions.html#fudge.productData.distributions.energy.PrimaryGamma.integrate">[docs]</a>    <span class="k">def</span> <span class="nf">integrate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">energyIn</span><span class="p">,</span> <span class="n">energyOut</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This meethod integrates the energu distribution at projectile energy over the specified outgoing energy range.</span>
<span class="sd">        See function :py:func:`miscellaneousModule.domainLimits` for how to specify *energyOut*.</span>
<span class="sd">        </span>
<span class="sd">        :param energyIn:            The energy of the projectile.</span>
<span class="sd">        :param energyOut:           The outgoing energy range to integrate over.</span>

<span class="sd">        :return:                    Python float.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">gammaEnergy</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">massRatio</span> <span class="o">*</span> <span class="n">energyIn</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">domainMin</span> <span class="o">&lt;=</span> <span class="n">energyIn</span> <span class="o">&lt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">domainMax</span><span class="p">:</span>
            <span class="n">domainMin</span><span class="p">,</span> <span class="n">domainMax</span> <span class="o">=</span> <span class="n">miscellaneousModule</span><span class="o">.</span><span class="n">domainLimits</span><span class="p">(</span><span class="n">energyOut</span><span class="p">,</span> <span class="n">gammaEnergy</span><span class="p">,</span> <span class="n">gammaEnergy</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">domainMin</span> <span class="o">&lt;=</span> <span class="n">gammaEnergy</span> <span class="o">&lt;=</span> <span class="n">domainMax</span><span class="p">:</span> <span class="k">return</span> <span class="mf">1.0</span>

        <span class="k">return</span> <span class="mf">0.0</span></div></div>


<div class="viewcode-block" id="XYs2d"><a class="viewcode-back" href="../../../../fudge/fudge.productData.distributions.html#fudge.productData.distributions.energy.XYs2d">[docs]</a><span class="k">class</span> <span class="nc">XYs2d</span><span class="p">(</span> <span class="n">Subform</span><span class="p">,</span> <span class="n">probabilitiesModule</span><span class="o">.</span><span class="n">PofX1GivenX2</span> <span class="p">)</span> <span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Class to store :math:`P(E&#39;|E)` as a list of pairs of :math:`E`, :math:`P(E&#39;)`. The :math:`P(E&#39;)` can be any of the</span>
<span class="sd">    1d energy distributions.</span>

<span class="sd">    :param kwargs:      A dictionary of extra arguments that controls how *self* is converted to a list of XML strings.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span> <span class="p">):</span>

        <span class="n">probabilitiesModule</span><span class="o">.</span><span class="n">PofX1GivenX2</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span> <span class="p">)</span>
        <span class="n">Subform</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span> <span class="bp">self</span> <span class="p">)</span>

<div class="viewcode-block" id="XYs2d.evaluate"><a class="viewcode-back" href="../../../../fudge/fudge.productData.distributions.html#fudge.productData.distributions.energy.XYs2d.evaluate">[docs]</a>    <span class="k">def</span> <span class="nf">evaluate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">domainValue</span><span class="p">,</span> <span class="n">extrapolation</span><span class="o">=</span><span class="n">xDataEnumsModule</span><span class="o">.</span><span class="n">Extrapolation</span><span class="o">.</span><span class="n">none</span><span class="p">,</span> <span class="n">epsilon</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a :math:`P(E&#39;)` at projectile energy *domainValue*.</span>

<span class="sd">        :param domainValue:     The energy of the projectile.</span>
<span class="sd">        :param extrapolation:   Specifies how to extrapolate *self* for *domainValue* outside the domain of the projectile&#39;s energy.</span>

<span class="sd">        :return:                A 1d energy distribution.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># FIXME silently converting InterpolationQualifier.none to unitbase.</span>
        <span class="n">interpolationQualifier</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">interpolationQualifier</span>
        <span class="k">if</span> <span class="n">interpolationQualifier</span> <span class="ow">is</span> <span class="n">xDataEnumsModule</span><span class="o">.</span><span class="n">InterpolationQualifier</span><span class="o">.</span><span class="n">none</span><span class="p">:</span>
            <span class="n">interpolationQualifier</span> <span class="o">=</span> <span class="n">xDataEnumsModule</span><span class="o">.</span><span class="n">InterpolationQualifier</span><span class="o">.</span><span class="n">unitBase</span>

        <span class="k">return</span> <span class="n">probabilitiesModule</span><span class="o">.</span><span class="n">PofX1GivenX2</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">domainValue</span><span class="p">,</span> <span class="n">extrapolation</span> <span class="o">=</span> <span class="n">extrapolation</span><span class="p">,</span> <span class="n">epsilon</span> <span class="o">=</span> <span class="n">epsilon</span><span class="p">,</span>
                                                         <span class="n">interpolationQualifier</span><span class="o">=</span><span class="n">interpolationQualifier</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>


<div class="viewcode-block" id="XYs2d.getAtEnergy"><a class="viewcode-back" href="../../../../fudge/fudge.productData.distributions.html#fudge.productData.distributions.energy.XYs2d.getAtEnergy">[docs]</a>    <span class="k">def</span> <span class="nf">getAtEnergy</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">energy</span> <span class="p">)</span> <span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;This method is deprecated, use getSpectrumAtEnergy.&quot;&quot;&quot;</span>

        <span class="k">return</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">getSpectrumAtEnergy</span><span class="p">(</span> <span class="n">energy</span> <span class="p">)</span> <span class="p">)</span></div>

<div class="viewcode-block" id="XYs2d.energySpectrumAtEnergy"><a class="viewcode-back" href="../../../../fudge/fudge.productData.distributions.html#fudge.productData.distributions.energy.XYs2d.energySpectrumAtEnergy">[docs]</a>    <span class="k">def</span> <span class="nf">energySpectrumAtEnergy</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">energy</span> <span class="p">)</span> <span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calculates the outgoing particle&#39;s energy spectrum at projectile energy *energy*,</span>

<span class="sd">        :param energy:              Energy of the projectile.</span>

<span class="sd">        :return:                    XYs1d instance for the energy spectrum.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">spectrum</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="n">energy</span><span class="p">,</span> <span class="n">extrapolation</span><span class="o">=</span><span class="n">xDataEnumsModule</span><span class="o">.</span><span class="n">Extrapolation</span><span class="o">.</span><span class="n">flat</span><span class="p">)</span>
        <span class="k">if</span><span class="p">(</span> <span class="nb">isinstance</span><span class="p">(</span> <span class="n">spectrum</span><span class="p">,</span> <span class="n">Regions1d</span> <span class="p">)</span> <span class="p">)</span> <span class="p">:</span> <span class="n">spectrum</span> <span class="o">=</span> <span class="n">spectrum</span><span class="o">.</span><span class="n">toPointwise_withLinearXYs</span><span class="p">(</span> <span class="n">lowerEps</span> <span class="o">=</span> <span class="mf">1e-6</span><span class="p">,</span> <span class="n">upperEps</span> <span class="o">=</span> <span class="mf">1e-6</span> <span class="p">)</span>
        <span class="k">return</span><span class="p">(</span> <span class="n">spectrum</span> <span class="p">)</span></div>

<div class="viewcode-block" id="XYs2d.getSpectrumAtEnergy"><a class="viewcode-back" href="../../../../fudge/fudge.productData.distributions.html#fudge.productData.distributions.energy.XYs2d.getSpectrumAtEnergy">[docs]</a>    <span class="k">def</span> <span class="nf">getSpectrumAtEnergy</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">energy</span> <span class="p">)</span> <span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns the results of calling **energySpectrumAtEnergy**. This method is deprecated.&quot;&quot;&quot;</span>

        <span class="k">return</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">energySpectrumAtEnergy</span><span class="p">(</span> <span class="n">energy</span> <span class="p">)</span> <span class="p">)</span></div>

<div class="viewcode-block" id="XYs2d.getEnergyArray"><a class="viewcode-back" href="../../../../fudge/fudge.productData.distributions.html#fudge.productData.distributions.energy.XYs2d.getEnergyArray">[docs]</a>    <span class="k">def</span> <span class="nf">getEnergyArray</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">EMin</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">EMax</span> <span class="o">=</span> <span class="kc">None</span> <span class="p">)</span> <span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This method returns the list of projectile energies that *self* is specific at.</span>

<span class="sd">        :parem EMin:        If *self* does not have an projectile energy values, the default minimum energy to return.</span>
<span class="sd">        :parem EMax:        If *self* does not have an projectile energy values, the default maximum energy to return.</span>

<span class="sd">        :return:            Python list of float.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">Es</span> <span class="o">=</span> <span class="p">[</span> <span class="n">data</span><span class="o">.</span><span class="n">outerDomainValue</span> <span class="k">for</span> <span class="n">data</span> <span class="ow">in</span> <span class="bp">self</span> <span class="p">]</span>
        <span class="k">if</span><span class="p">(</span> <span class="n">EMin</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">)</span> <span class="p">:</span>
            <span class="k">if</span><span class="p">(</span> <span class="n">EMin</span> <span class="o">&lt;</span> <span class="p">(</span> <span class="mf">1.0</span> <span class="o">-</span> <span class="mf">1e-15</span> <span class="p">)</span> <span class="o">*</span> <span class="n">Es</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="p">)</span> <span class="p">:</span> <span class="n">Es</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span> <span class="mi">0</span><span class="p">,</span> <span class="n">EMin</span> <span class="p">)</span>
        <span class="k">if</span><span class="p">(</span> <span class="n">EMax</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">)</span> <span class="p">:</span>
            <span class="k">if</span><span class="p">(</span> <span class="n">EMax</span> <span class="o">&gt;</span> <span class="n">Es</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="p">)</span> <span class="p">:</span> <span class="n">Es</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="n">EMax</span> <span class="p">)</span>
        <span class="k">return</span><span class="p">(</span> <span class="n">Es</span> <span class="p">)</span></div>

<div class="viewcode-block" id="XYs2d.averageEp"><a class="viewcode-back" href="../../../../fudge/fudge.productData.distributions.html#fudge.productData.distributions.energy.XYs2d.averageEp">[docs]</a>    <span class="k">def</span> <span class="nf">averageEp</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">energy</span> <span class="p">)</span> <span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calculated the average energy of the outgoing photon at projectile energy *energy*.</span>

<span class="sd">        :param energy:       The energy of the projectile energy.</span>

<span class="sd">        :return:                Python float.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">code</span><span class="p">,</span> <span class="n">lower</span><span class="p">,</span> <span class="n">upper</span><span class="p">,</span> <span class="n">frac</span><span class="p">,</span> <span class="n">interpolation</span><span class="p">,</span> <span class="n">interpolationQualifier</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getBoundingSubFunctions</span><span class="p">(</span> <span class="n">energy</span> <span class="p">)</span>
        <span class="k">if</span><span class="p">(</span> <span class="n">code</span> <span class="ow">is</span> <span class="kc">None</span> <span class="p">)</span> <span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span> <span class="s1">&#39;No distribution&#39;</span> <span class="p">)</span>
        <span class="k">elif</span><span class="p">(</span> <span class="n">code</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span> <span class="p">)</span> <span class="p">:</span>
            <span class="n">EpLowerMin</span><span class="p">,</span> <span class="n">EpLowerMax</span> <span class="o">=</span> <span class="n">lower</span><span class="o">.</span><span class="n">domainMin</span><span class="p">,</span> <span class="n">lower</span><span class="o">.</span><span class="n">domainMax</span>
            <span class="n">EpUpperMin</span><span class="p">,</span> <span class="n">EpUpperMax</span> <span class="o">=</span> <span class="n">upper</span><span class="o">.</span><span class="n">domainMin</span><span class="p">,</span> <span class="n">upper</span><span class="o">.</span><span class="n">domainMax</span>
            <span class="n">EpMidMin</span> <span class="o">=</span> <span class="p">(</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">frac</span> <span class="p">)</span> <span class="o">*</span> <span class="n">EpLowerMin</span> <span class="o">+</span> <span class="n">frac</span> <span class="o">*</span> <span class="n">EpUpperMin</span>
            <span class="n">EpMidMax</span> <span class="o">=</span> <span class="p">(</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">frac</span> <span class="p">)</span> <span class="o">*</span> <span class="n">EpLowerMax</span> <span class="o">+</span> <span class="n">frac</span> <span class="o">*</span> <span class="n">EpUpperMax</span>
            <span class="n">EpLower</span> <span class="o">=</span> <span class="p">(</span> <span class="n">lower</span><span class="o">.</span><span class="n">integrateWithWeight_x</span><span class="p">(</span> <span class="p">)</span> <span class="o">-</span> <span class="n">EpLowerMin</span> <span class="p">)</span> <span class="o">/</span> <span class="p">(</span> <span class="n">EpLowerMax</span> <span class="o">-</span> <span class="n">EpLowerMin</span> <span class="p">)</span> <span class="o">*</span> \
                    <span class="p">(</span> <span class="n">EpMidMax</span> <span class="o">-</span> <span class="n">EpMidMin</span> <span class="p">)</span> <span class="o">+</span> <span class="n">EpMidMin</span>
            <span class="n">EpUpper</span> <span class="o">=</span> <span class="p">(</span> <span class="n">upper</span><span class="o">.</span><span class="n">integrateWithWeight_x</span><span class="p">(</span> <span class="p">)</span> <span class="o">-</span> <span class="n">EpUpperMin</span> <span class="p">)</span> <span class="o">/</span> <span class="p">(</span> <span class="n">EpUpperMax</span> <span class="o">-</span> <span class="n">EpUpperMin</span> <span class="p">)</span> <span class="o">*</span> \
                    <span class="p">(</span> <span class="n">EpMidMax</span> <span class="o">-</span> <span class="n">EpMidMin</span> <span class="p">)</span> <span class="o">+</span> <span class="n">EpMidMin</span>
            <span class="k">return</span><span class="p">(</span> <span class="p">(</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">frac</span> <span class="p">)</span> <span class="o">*</span> <span class="n">EpLower</span> <span class="o">+</span> <span class="n">frac</span> <span class="o">*</span> <span class="n">EpUpper</span> <span class="p">)</span>
        <span class="k">else</span> <span class="p">:</span>
            <span class="k">return</span><span class="p">(</span> <span class="n">lower</span><span class="o">.</span><span class="n">integrateWithWeight_x</span><span class="p">(</span> <span class="p">)</span> <span class="p">)</span></div>

<div class="viewcode-block" id="XYs2d.check"><a class="viewcode-back" href="../../../../fudge/fudge.productData.distributions.html#fudge.productData.distributions.energy.XYs2d.check">[docs]</a>    <span class="k">def</span> <span class="nf">check</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">info</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Does a check of *self*&#39;s data.</span>

<span class="sd">        :param info:        A dictionary with parameters used for determining if a difference is relevant.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="kn">from</span> <span class="nn">fudge</span> <span class="kn">import</span> <span class="n">warning</span>

        <span class="n">warnings</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">interpolation</span> <span class="ow">is</span> <span class="n">xDataEnumsModule</span><span class="o">.</span><span class="n">Interpolation</span><span class="o">.</span><span class="n">flat</span><span class="p">:</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">warning</span><span class="o">.</span><span class="n">FlatIncidentEnergyInterpolation</span><span class="p">())</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">interpolationQualifier</span> <span class="ow">is</span> <span class="n">xDataEnumsModule</span><span class="o">.</span><span class="n">InterpolationQualifier</span><span class="o">.</span><span class="n">none</span><span class="p">:</span>
            <span class="n">domains</span> <span class="o">=</span> <span class="nb">set</span><span class="p">([(</span><span class="n">xys1d</span><span class="o">.</span><span class="n">domainMin</span><span class="p">,</span> <span class="n">xys1d</span><span class="o">.</span><span class="n">domainMax</span><span class="p">)</span> <span class="k">for</span> <span class="n">xys1d</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">])</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">domains</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">transportable</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">findAttributeInAncestry</span><span class="p">(</span><span class="s1">&#39;pid&#39;</span><span class="p">)</span> <span class="ow">in</span> <span class="n">info</span><span class="p">[</span><span class="s1">&#39;transportables&#39;</span><span class="p">]</span>
                <span class="n">warnings</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">warning</span><span class="o">.</span><span class="n">MissingInterpolationQualifier</span><span class="p">(</span><span class="n">transportable</span><span class="p">))</span>

        <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">)):</span>
            <span class="n">integral</span> <span class="o">=</span> <span class="bp">self</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span><span class="o">.</span><span class="n">integrate</span><span class="p">()</span>
            <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">integral</span> <span class="o">-</span> <span class="mf">1.0</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">info</span><span class="p">[</span><span class="s1">&#39;normTolerance&#39;</span><span class="p">]:</span>
                <span class="n">incidentEnergy</span> <span class="o">=</span> <span class="n">PQUModule</span><span class="o">.</span><span class="n">PQU</span><span class="p">(</span><span class="bp">self</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span><span class="o">.</span><span class="n">outerDomainValue</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">unit</span><span class="p">)</span>
                <span class="n">warnings</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">warning</span><span class="o">.</span><span class="n">UnnormalizedDistribution</span><span class="p">(</span><span class="n">incidentEnergy</span><span class="p">,</span> <span class="n">idx</span><span class="p">,</span> <span class="n">integral</span><span class="p">,</span> <span class="bp">self</span><span class="p">[</span><span class="n">idx</span><span class="p">]))</span>

            <span class="k">if</span> <span class="bp">self</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span><span class="o">.</span><span class="n">rangeMin</span> <span class="o">&lt;</span> <span class="mf">0.0</span><span class="p">:</span>
                <span class="n">incidentEnergy</span> <span class="o">=</span> <span class="n">PQUModule</span><span class="o">.</span><span class="n">PQU</span><span class="p">(</span><span class="bp">self</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span><span class="o">.</span><span class="n">outerDomainValue</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">unit</span><span class="p">)</span>
                <span class="n">warnings</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">warning</span><span class="o">.</span><span class="n">NegativeProbability</span><span class="p">(</span><span class="bp">self</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span><span class="o">.</span><span class="n">rangeMin</span><span class="p">,</span> <span class="n">incidentEnergy</span><span class="p">,</span> <span class="n">obj</span><span class="o">=</span><span class="bp">self</span><span class="p">[</span><span class="n">idx</span><span class="p">]))</span>

        <span class="k">return</span> <span class="n">warnings</span></div>

<div class="viewcode-block" id="XYs2d.sqrtEp_AverageAtE"><a class="viewcode-back" href="../../../../fudge/fudge.productData.distributions.html#fudge.productData.distributions.energy.XYs2d.sqrtEp_AverageAtE">[docs]</a>    <span class="k">def</span> <span class="nf">sqrtEp_AverageAtE</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">E</span> <span class="p">)</span> <span class="p">:</span>
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This method returns the value of the integral :math:`\int dE&#39; \sqrt{E&#39;} P(E&#39;) at projectile energy *E*.</span>

<span class="sd">        :param E:   Energy of the projectile.</span>

<span class="sd">        :return:    Python float.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">energySpectrumAtEnergy</span><span class="p">(</span> <span class="n">E</span> <span class="p">)</span><span class="o">.</span><span class="n">integrateWithWeight_sqrt_x</span><span class="p">(</span> <span class="p">)</span> <span class="p">)</span></div>

<div class="viewcode-block" id="XYs2d.toPointwise_withLinearXYs"><a class="viewcode-back" href="../../../../fudge/fudge.productData.distributions.html#fudge.productData.distributions.energy.XYs2d.toPointwise_withLinearXYs">[docs]</a>    <span class="k">def</span> <span class="nf">toPointwise_withLinearXYs</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span> <span class="p">)</span> <span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a pointwise represent of *self*.</span>

<span class="sd">        :param kwargs:              A dictionary that contains data to control the way this method acts.</span>

<span class="sd">        :return:                    An :py:class:`XYs2d` instance.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span><span class="p">(</span> <span class="n">multiD_XYsModule</span><span class="o">.</span><span class="n">XYs2d</span><span class="o">.</span><span class="n">toPointwise_withLinearXYs</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="bp">cls</span> <span class="o">=</span> <span class="n">XYs2d</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span> <span class="p">)</span> <span class="p">)</span></div>

<div class="viewcode-block" id="XYs2d.to_xs_pdf_cdf1d"><a class="viewcode-back" href="../../../../fudge/fudge.productData.distributions.html#fudge.productData.distributions.energy.XYs2d.to_xs_pdf_cdf1d">[docs]</a>    <span class="k">def</span> <span class="nf">to_xs_pdf_cdf1d</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">style</span><span class="p">,</span> <span class="n">tempInfo</span><span class="p">,</span> <span class="n">indent</span> <span class="p">)</span> <span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This method returns a copy of *self* as a :py:class:`XYs2d` representation with the</span>
<span class="sd">        P(E&#39;) data as :py:class:`Xs_pdf_cdf1d` instances.</span>

<span class="sd">        :param style:           The style for the returned data.</span>
<span class="sd">        :param tempInfo:        Dictionary of data needed to calculate the data.</span>
<span class="sd">        :param indent:          The indentation for any verbosity.</span>
<span class="sd">                    </span>
<span class="sd">        :return:                :py:class:`XYs2d`</span>
<span class="sd">        &quot;&quot;&quot;</span>     

        <span class="n">linear</span> <span class="o">=</span> <span class="bp">self</span>
        <span class="k">for</span> <span class="n">xys</span> <span class="ow">in</span> <span class="bp">self</span> <span class="p">:</span>
            <span class="k">if</span><span class="p">(</span> <span class="nb">isinstance</span><span class="p">(</span> <span class="n">xys</span><span class="p">,</span> <span class="n">XYs1d</span> <span class="p">)</span> <span class="p">)</span> <span class="p">:</span>
                <span class="k">if</span> <span class="n">xys</span><span class="o">.</span><span class="n">interpolation</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="n">xDataEnumsModule</span><span class="o">.</span><span class="n">Interpolation</span><span class="o">.</span><span class="n">linlin</span><span class="p">,</span> <span class="n">xDataEnumsModule</span><span class="o">.</span><span class="n">Interpolation</span><span class="o">.</span><span class="n">flat</span><span class="p">]:</span>
                    <span class="n">linear</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">toPointwise_withLinearXYs</span><span class="p">(</span> <span class="n">accuracy</span> <span class="o">=</span> <span class="n">XYs1dModule</span><span class="o">.</span><span class="n">defaultAccuracy</span><span class="p">,</span> <span class="n">upperEps</span> <span class="o">=</span> <span class="mf">1e-8</span> <span class="p">)</span>
                    <span class="k">break</span>
            <span class="k">else</span> <span class="p">:</span>
                <span class="n">linear</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">toPointwise_withLinearXYs</span><span class="p">(</span> <span class="n">accuracy</span> <span class="o">=</span> <span class="n">XYs1dModule</span><span class="o">.</span><span class="n">defaultAccuracy</span><span class="p">,</span> <span class="n">upperEps</span> <span class="o">=</span> <span class="mf">1e-8</span> <span class="p">)</span>
                <span class="k">break</span>
        <span class="n">subform</span> <span class="o">=</span> <span class="n">XYs2d</span><span class="p">(</span> <span class="n">axes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="p">,</span> <span class="n">interpolation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">interpolation</span><span class="p">,</span> 
                <span class="n">interpolationQualifier</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">interpolationQualifier</span> <span class="p">)</span>
        <span class="k">for</span> <span class="n">xys</span> <span class="ow">in</span> <span class="n">linear</span><span class="p">:</span>
            <span class="n">subform</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Xs_pdf_cdf1d</span><span class="o">.</span><span class="n">fromXYs</span><span class="p">(</span><span class="n">xys</span><span class="p">,</span> <span class="n">xys</span><span class="o">.</span><span class="n">outerDomainValue</span><span class="p">,</span> <span class="n">thinEpsilon</span><span class="o">=</span><span class="mf">1e-14</span><span class="p">))</span>

        <span class="k">return</span> <span class="n">subform</span></div>

<div class="viewcode-block" id="XYs2d.allowedSubElements"><a class="viewcode-back" href="../../../../fudge/fudge.productData.distributions.html#fudge.productData.distributions.energy.XYs2d.allowedSubElements">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">allowedSubElements</span><span class="p">(</span> <span class="p">)</span> <span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This method returns the list of classes that can be sub-nodes (i.e., 2-d function) of an :py:class:`XYs2d` instance.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span><span class="p">(</span> <span class="p">(</span> <span class="n">XYs1d</span><span class="p">,</span> <span class="n">Regions1d</span><span class="p">,</span> <span class="n">Xs_pdf_cdf1d</span> <span class="p">)</span> <span class="p">)</span></div></div>

<div class="viewcode-block" id="Regions2d"><a class="viewcode-back" href="../../../../fudge/fudge.productData.distributions.html#fudge.productData.distributions.energy.Regions2d">[docs]</a><span class="k">class</span> <span class="nc">Regions2d</span><span class="p">(</span> <span class="n">Subform</span><span class="p">,</span> <span class="n">regionsModule</span><span class="o">.</span><span class="n">Regions2d</span> <span class="p">)</span> <span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Stores :math:`P(E&#39;|E)` as a list of other 2d energy distributions, that abut to form a contiguous distribution in E. </span>

<span class="sd">    :param kwargs:              A dictionary that contains data to control the way this method acts.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span> <span class="p">):</span>

        <span class="n">regionsModule</span><span class="o">.</span><span class="n">Regions2d</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span> <span class="p">)</span>
        <span class="n">Subform</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span> <span class="bp">self</span> <span class="p">)</span>

<div class="viewcode-block" id="Regions2d.check"><a class="viewcode-back" href="../../../../fudge/fudge.productData.distributions.html#fudge.productData.distributions.energy.Regions2d.check">[docs]</a>    <span class="k">def</span> <span class="nf">check</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">info</span> <span class="p">)</span> <span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Does a check of *self*&#39;s data.</span>

<span class="sd">        :param info:        A dictionary with parameters used for determining if a difference is relevant.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="kn">from</span> <span class="nn">fudge</span> <span class="kn">import</span> <span class="n">warning</span>

        <span class="n">warnings</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">region</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span> <span class="bp">self</span> <span class="p">):</span>
            <span class="n">regionWarnings</span> <span class="o">=</span> <span class="n">region</span><span class="o">.</span><span class="n">check</span><span class="p">(</span> <span class="n">info</span> <span class="p">)</span>
            <span class="k">if</span> <span class="n">regionWarnings</span><span class="p">:</span>
                <span class="n">warnings</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="n">warning</span><span class="o">.</span><span class="n">Context</span><span class="p">(</span><span class="s2">&quot;Region </span><span class="si">%d</span><span class="s2">:&quot;</span> <span class="o">%</span> <span class="n">idx</span><span class="p">,</span> <span class="n">regionWarnings</span><span class="p">)</span> <span class="p">)</span>
        <span class="k">return</span> <span class="n">warnings</span></div>

<div class="viewcode-block" id="Regions2d.toPointwise_withLinearXYs"><a class="viewcode-back" href="../../../../fudge/fudge.productData.distributions.html#fudge.productData.distributions.energy.Regions2d.toPointwise_withLinearXYs">[docs]</a>    <span class="k">def</span> <span class="nf">toPointwise_withLinearXYs</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span> <span class="p">)</span> <span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a pointwise represent of *self*.</span>

<span class="sd">        :param kwargs:              A dictionary that contains data to control the way this method acts.</span>

<span class="sd">        :return:                    An :py:class:`XYs2d` instance.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span><span class="p">(</span> <span class="n">regionsModule</span><span class="o">.</span><span class="n">Regions2d</span><span class="o">.</span><span class="n">toPointwise_withLinearXYs</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="bp">cls</span> <span class="o">=</span> <span class="n">XYs2d</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span> <span class="p">)</span> <span class="p">)</span></div>

<div class="viewcode-block" id="Regions2d.to_xs_pdf_cdf1d"><a class="viewcode-back" href="../../../../fudge/fudge.productData.distributions.html#fudge.productData.distributions.energy.Regions2d.to_xs_pdf_cdf1d">[docs]</a>    <span class="k">def</span> <span class="nf">to_xs_pdf_cdf1d</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">style</span><span class="p">,</span> <span class="n">tempInfo</span><span class="p">,</span> <span class="n">indent</span> <span class="p">)</span> <span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This method returns a copy of *self* as a :py:class:`Regions2d` representation with the</span>
<span class="sd">        P(E&#39;) data as :py:class:`Xs_pdf_cdf1d` instances.</span>

<span class="sd">        :param style:           The style for the returned data.</span>
<span class="sd">        :param tempInfo:        Dictionary of data needed to calculate the data.</span>
<span class="sd">        :param indent:          The indentation for any verbosity.</span>
<span class="sd">                    </span>
<span class="sd">        :return:                :py:class:`Regions2d`</span>
<span class="sd">        &quot;&quot;&quot;</span>     

        <span class="n">_regions2d</span> <span class="o">=</span> <span class="n">Regions2d</span><span class="p">(</span> <span class="n">axes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">axes</span> <span class="p">)</span>
        <span class="k">for</span> <span class="n">region</span> <span class="ow">in</span> <span class="bp">self</span> <span class="p">:</span> <span class="n">_regions2d</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="n">region</span><span class="o">.</span><span class="n">to_xs_pdf_cdf1d</span><span class="p">(</span> <span class="n">style</span><span class="p">,</span> <span class="n">tempInfo</span><span class="p">,</span> <span class="n">indent</span> <span class="p">)</span> <span class="p">)</span>
        <span class="k">return</span><span class="p">(</span> <span class="n">_regions2d</span> <span class="p">)</span></div>

<div class="viewcode-block" id="Regions2d.allowedSubElements"><a class="viewcode-back" href="../../../../fudge/fudge.productData.distributions.html#fudge.productData.distributions.energy.Regions2d.allowedSubElements">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">allowedSubElements</span><span class="p">(</span> <span class="p">)</span> <span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This method returns the list of classes that can be sub-nodes (i.e., 2-d function) of an :py:class:`Regions2d` instance.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span><span class="p">(</span> <span class="p">(</span> <span class="n">XYs2d</span><span class="p">,</span> <span class="p">)</span> <span class="p">)</span></div></div>

<div class="viewcode-block" id="EnergyFunctionalData"><a class="viewcode-back" href="../../../../fudge/fudge.productData.distributions.html#fudge.productData.distributions.energy.EnergyFunctionalData">[docs]</a><span class="k">class</span> <span class="nc">EnergyFunctionalData</span><span class="p">(</span> <span class="n">ancestryModule</span><span class="o">.</span><span class="n">AncestryIO</span> <span class="p">)</span> <span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Abstract class for some parameters in many of the 2d energy functionals.</span>

<span class="sd">    The following table list the primary members of this class:</span>
<span class="sd">    </span>
<span class="sd">    +-----------+-----------------------------------------------------------+</span>
<span class="sd">    | Member    | Description                                               |</span>
<span class="sd">    +===========+===========================================================+</span>
<span class="sd">    | data      | This member stores the actual data.                       |           </span>
<span class="sd">    +-----------+-----------------------------------------------------------+</span>

<span class="sd">    :param data:    The data for the function.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">ancestryMembers</span> <span class="o">=</span> <span class="p">(</span> <span class="s1">&#39;data&#39;</span><span class="p">,</span> <span class="p">)</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">data</span> <span class="p">)</span> <span class="p">:</span>

        <span class="n">ancestryModule</span><span class="o">.</span><span class="n">AncestryIO</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span> <span class="bp">self</span> <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">data</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">setAncestor</span><span class="p">(</span> <span class="bp">self</span> <span class="p">)</span>

<div class="viewcode-block" id="EnergyFunctionalData.convertUnits"><a class="viewcode-back" href="../../../../fudge/fudge.productData.distributions.html#fudge.productData.distributions.energy.EnergyFunctionalData.convertUnits">[docs]</a>    <span class="k">def</span> <span class="nf">convertUnits</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">unitMap</span> <span class="p">)</span> <span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Converts all data in *self* per *unitMap*.</span>

<span class="sd">        :param unitMap:     A dictionary in which each key is a unit that will be replaced by its value which must be an equivalent unit.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">convertUnits</span><span class="p">(</span> <span class="n">unitMap</span> <span class="p">)</span></div>

<div class="viewcode-block" id="EnergyFunctionalData.copy"><a class="viewcode-back" href="../../../../fudge/fudge.productData.distributions.html#fudge.productData.distributions.energy.EnergyFunctionalData.copy">[docs]</a>    <span class="k">def</span> <span class="nf">copy</span><span class="p">(</span> <span class="bp">self</span> <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a copy of *self*.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span> <span class="p">)</span> <span class="p">)</span></div>

    <span class="n">__copy__</span> <span class="o">=</span> <span class="n">copy</span>

<div class="viewcode-block" id="EnergyFunctionalData.toXML_strList"><a class="viewcode-back" href="../../../../fudge/fudge.productData.distributions.html#fudge.productData.distributions.energy.EnergyFunctionalData.toXML_strList">[docs]</a>    <span class="k">def</span> <span class="nf">toXML_strList</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">indent</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span> <span class="p">)</span> <span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a list of str instances representing the XML lines of *self*.</span>

<span class="sd">        :param indent:          The minimum amount of indentation.</span>
<span class="sd">        :param kwargs:          A dictionary of extra arguments that controls how *self* is converted to a list of XML strings.</span>

<span class="sd">        :return:                List of str instances representing the XML lines of self.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">xml</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1">&lt;</span><span class="si">%s</span><span class="s1">&gt;&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">indent</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">moniker</span><span class="p">)]</span>
        <span class="n">xml</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">toXML_strList</span><span class="p">(</span> <span class="n">indent</span> <span class="o">+</span> <span class="s1">&#39;  &#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span> <span class="p">)</span>
        <span class="n">xml</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+=</span> <span class="s1">&#39;&lt;/</span><span class="si">%s</span><span class="s1">&gt;&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">moniker</span>
        <span class="k">return</span> <span class="n">xml</span></div>

<div class="viewcode-block" id="EnergyFunctionalData.parseNodeUsingClass"><a class="viewcode-back" href="../../../../fudge/fudge.productData.distributions.html#fudge.productData.distributions.energy.EnergyFunctionalData.parseNodeUsingClass">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">parseNodeUsingClass</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">element</span><span class="p">,</span> <span class="n">xPath</span><span class="p">,</span> <span class="n">linkData</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Parse *element* into an instance of *cls*.</span>

<span class="sd">        :param cls:         Form class to return.</span>
<span class="sd">        :param element:     Node to parse.</span>
<span class="sd">        :param xPath:       List containing xPath to current node, useful mostly for debugging.</span>
<span class="sd">        :param linkData:    dict that collects unresolved links.</span>
<span class="sd">        :param kwargs:      A dictionary of extra arguments that controls how *self* is converted to a list of XML strings.</span>

<span class="sd">        :return: an instance of *cls* representing *element*.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">xPath</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="n">element</span><span class="o">.</span><span class="n">tag</span> <span class="p">)</span>
        <span class="n">subClass</span> <span class="o">=</span> <span class="p">{</span>
            <span class="n">XYs1d</span><span class="o">.</span><span class="n">moniker</span>           <span class="p">:</span> <span class="n">XYs1dModule</span><span class="o">.</span><span class="n">XYs1d</span><span class="p">,</span>
            <span class="n">Regions1d</span><span class="o">.</span><span class="n">moniker</span>       <span class="p">:</span> <span class="n">regionsModule</span><span class="o">.</span><span class="n">Regions1d</span><span class="p">,</span>
            <span class="n">Xs_pdf_cdf1d</span><span class="o">.</span><span class="n">moniker</span>    <span class="p">:</span> <span class="n">xs_pdf_cdfModule</span><span class="o">.</span><span class="n">Xs_pdf_cdf1d</span>
        <span class="p">}</span><span class="o">.</span><span class="n">get</span><span class="p">(</span> <span class="n">element</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">tag</span> <span class="p">)</span>
        <span class="k">if</span><span class="p">(</span> <span class="n">subClass</span> <span class="ow">is</span> <span class="kc">None</span> <span class="p">)</span> <span class="p">:</span> <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span> <span class="s2">&quot;encountered unknown energy functional subform: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">element</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">tag</span> <span class="p">)</span>
        <span class="n">EFD</span> <span class="o">=</span> <span class="bp">cls</span><span class="p">(</span><span class="n">subClass</span><span class="o">.</span><span class="n">parseNodeUsingClass</span><span class="p">(</span><span class="n">element</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">xPath</span><span class="p">,</span> <span class="n">linkData</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">))</span>
        <span class="n">xPath</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">EFD</span></div></div>

<div class="viewcode-block" id="A"><a class="viewcode-back" href="../../../../fudge/fudge.productData.distributions.html#fudge.productData.distributions.energy.A">[docs]</a><span class="k">class</span> <span class="nc">A</span><span class="p">(</span> <span class="n">EnergyFunctionalData</span> <span class="p">)</span> <span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Class for storing the A function for the :py:class:`Watt` energy functional. </span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">moniker</span> <span class="o">=</span> <span class="s1">&#39;a&#39;</span></div>

<div class="viewcode-block" id="B"><a class="viewcode-back" href="../../../../fudge/fudge.productData.distributions.html#fudge.productData.distributions.energy.B">[docs]</a><span class="k">class</span> <span class="nc">B</span><span class="p">(</span> <span class="n">EnergyFunctionalData</span> <span class="p">)</span> <span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Class for storing the B function for the :py:class:`Watt` energy functional. </span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">moniker</span> <span class="o">=</span> <span class="s1">&#39;b&#39;</span></div>

<div class="viewcode-block" id="Theta"><a class="viewcode-back" href="../../../../fudge/fudge.productData.distributions.html#fudge.productData.distributions.energy.Theta">[docs]</a><span class="k">class</span> <span class="nc">Theta</span><span class="p">(</span> <span class="n">EnergyFunctionalData</span> <span class="p">)</span> <span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Class for storing the :math:`\theta` function for several of the energy functionals.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">moniker</span> <span class="o">=</span> <span class="s1">&#39;theta&#39;</span></div>

<div class="viewcode-block" id="G"><a class="viewcode-back" href="../../../../fudge/fudge.productData.distributions.html#fudge.productData.distributions.energy.G">[docs]</a><span class="k">class</span> <span class="nc">G</span><span class="p">(</span> <span class="n">EnergyFunctionalData</span> <span class="p">)</span> <span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Class for storing the G function for the :py:class:`GeneralEvaporation` functional.  </span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">moniker</span> <span class="o">=</span> <span class="s1">&#39;g&#39;</span></div>

<div class="viewcode-block" id="T_M"><a class="viewcode-back" href="../../../../fudge/fudge.productData.distributions.html#fudge.productData.distributions.energy.T_M">[docs]</a><span class="k">class</span> <span class="nc">T_M</span><span class="p">(</span> <span class="n">EnergyFunctionalData</span> <span class="p">)</span> <span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Class for storing the :math:`T_M` function for the :py:class:`MadlandNix` functional.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">moniker</span> <span class="o">=</span> <span class="s1">&#39;T_M&#39;</span></div>

<div class="viewcode-block" id="FunctionalBase"><a class="viewcode-back" href="../../../../fudge/fudge.productData.distributions.html#fudge.productData.distributions.energy.FunctionalBase">[docs]</a><span class="k">class</span> <span class="nc">FunctionalBase</span><span class="p">(</span> <span class="n">Subform</span> <span class="p">)</span> <span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Abstract base class for the 2d energy functional distributions.</span>

<span class="sd">    The following table list the primary members of this class:</span>
<span class="sd">    </span>
<span class="sd">    +---------------+-------------------------------------------------------------------+</span>
<span class="sd">    | Member        | Description                                                       |</span>
<span class="sd">    +===============+===================================================================+</span>
<span class="sd">    | LF            | This member is the ENDF-6 LF flag.                                |</span>
<span class="sd">    +---------------+-------------------------------------------------------------------+</span>
<span class="sd">    | U             | Constant that defines the upper energy limit for the              |</span>
<span class="sd">    |               | secondary particle so that 0  E&#39;  E - U.                        |</span>
<span class="sd">    +---------------+-------------------------------------------------------------------+</span>
<span class="sd">    | parameter1    | 1d function needed by most functionals.                           |</span>
<span class="sd">    +---------------+-------------------------------------------------------------------+</span>
<span class="sd">    | parameter2    | Addition 1d function needed by :py:class:`GeneralEvaporation`     |</span>
<span class="sd">    |               | and :py:class:`MadlandNix` instances.                             |</span>
<span class="sd">    +---------------+-------------------------------------------------------------------+</span>

<span class="sd">    :param LF:              The data for the function.</span>
<span class="sd">    :param U:               Constant that defines the upper energy limit for the secondary particle so that 0  E&#39;  E - U.</span>
<span class="sd">    :param parameter1:      For a :py:class:`GeneralEvaporation`, :py:class:`SimpleMaxwellianFission` or :py:class:`Evaporation` </span>
<span class="sd">                            instance this is the :math:`\theta(E)` function. For a :py:class:`Watt` instance this is the :py:class:`A`</span>
<span class="sd">                            function and for a :py:class:`MadlandNix` instance this is the :py:class:`T_M` function.</span>
<span class="sd">    :param parameter2:      For a :py:class:`GeneralEvaporation` instance this is the :py:class:`B` function and for a :py:class:`Watt` </span>
<span class="sd">                            instance this is the :py:class:`B` function.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">ancestryMembers</span> <span class="o">=</span> <span class="p">(</span> <span class="s1">&#39;parameter1&#39;</span><span class="p">,</span> <span class="s1">&#39;parameter2&#39;</span> <span class="p">)</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">LF</span><span class="p">,</span> <span class="n">U</span><span class="p">,</span> <span class="n">parameter1</span><span class="p">,</span> <span class="n">parameter2</span> <span class="o">=</span> <span class="kc">None</span> <span class="p">)</span> <span class="p">:</span>

        <span class="n">Subform</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span> <span class="bp">self</span> <span class="p">)</span>

        <span class="k">if</span><span class="p">(</span> <span class="n">U</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">)</span> <span class="p">:</span>
            <span class="k">if</span><span class="p">(</span> <span class="ow">not</span><span class="p">(</span> <span class="nb">isinstance</span><span class="p">(</span> <span class="n">U</span><span class="p">,</span> <span class="n">physicalQuantityModule</span><span class="o">.</span><span class="n">U</span> <span class="p">)</span> <span class="p">)</span> <span class="p">)</span> <span class="p">:</span> <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span> <span class="s1">&#39;Invalid U type&#39;</span> <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">U</span> <span class="o">=</span> <span class="n">U</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">LF</span> <span class="o">=</span> <span class="n">LF</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">parameter1</span> <span class="o">=</span> <span class="n">parameter1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parameter1</span><span class="o">.</span><span class="n">setAncestor</span><span class="p">(</span> <span class="bp">self</span> <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">parameter2</span> <span class="o">=</span> <span class="n">parameter2</span>
        <span class="k">if</span><span class="p">(</span> <span class="n">parameter2</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">)</span> <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameter2</span><span class="o">.</span><span class="n">setAncestor</span><span class="p">(</span> <span class="bp">self</span> <span class="p">)</span>

<div class="viewcode-block" id="FunctionalBase.convertUnits"><a class="viewcode-back" href="../../../../fudge/fudge.productData.distributions.html#fudge.productData.distributions.energy.FunctionalBase.convertUnits">[docs]</a>    <span class="k">def</span> <span class="nf">convertUnits</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">unitMap</span> <span class="p">)</span> <span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Converts all data in *self* per *unitMap*.</span>

<span class="sd">        :param unitMap:     A dictionary in which each key is a unit that will be replaced by its value which must be an equivalent unit.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">U</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">)</span> <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">U</span><span class="o">.</span><span class="n">convertUnits</span><span class="p">(</span> <span class="n">unitMap</span> <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parameter1</span><span class="o">.</span><span class="n">convertUnits</span><span class="p">(</span> <span class="n">unitMap</span> <span class="p">)</span>
        <span class="k">if</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameter2</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">)</span> <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameter2</span><span class="o">.</span><span class="n">convertUnits</span><span class="p">(</span> <span class="n">unitMap</span> <span class="p">)</span></div>

<div class="viewcode-block" id="FunctionalBase.copy"><a class="viewcode-back" href="../../../../fudge/fudge.productData.distributions.html#fudge.productData.distributions.energy.FunctionalBase.copy">[docs]</a>    <span class="k">def</span> <span class="nf">copy</span><span class="p">(</span> <span class="bp">self</span> <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a copy of *self*.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">U</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">U</span>
        <span class="k">if</span> <span class="n">U</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span> <span class="n">U</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">U</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameter2</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span><span class="n">U</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameter1</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span>
        <span class="k">else</span> <span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span><span class="n">U</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameter1</span><span class="o">.</span><span class="n">copy</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameter2</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span></div>

    <span class="n">__copy__</span> <span class="o">=</span> <span class="n">copy</span>

<div class="viewcode-block" id="FunctionalBase.check"><a class="viewcode-back" href="../../../../fudge/fudge.productData.distributions.html#fudge.productData.distributions.energy.FunctionalBase.check">[docs]</a>    <span class="k">def</span> <span class="nf">check</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">info</span> <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Does a check of *self*&#39;s data.</span>

<span class="sd">        :param info:        A dictionary with parameters used for determining if a difference is relevant.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="kn">from</span> <span class="nn">fudge</span> <span class="kn">import</span> <span class="n">warning</span>

        <span class="n">warnings</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span><span class="p">(</span> <span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">domainMin</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">U</span><span class="o">.</span><span class="n">value</span> <span class="p">)</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="p">)</span> <span class="p">:</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="n">warning</span><span class="o">.</span><span class="n">EnergyDistributionBadU</span><span class="p">(</span> <span class="bp">self</span> <span class="p">)</span> <span class="p">)</span>
        <span class="k">return</span><span class="p">(</span> <span class="n">warnings</span> <span class="p">)</span></div>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">domainMin</span><span class="p">(</span> <span class="bp">self</span> <span class="p">)</span> <span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the minimum projectile energy for *self*.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameter1</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">domainMin</span> <span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">domainMax</span><span class="p">(</span> <span class="bp">self</span> <span class="p">)</span> <span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the maximum projectile energy for *self*.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameter1</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">domainMax</span> <span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">domainUnit</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the energy unit of the projectile.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameter1</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">unit</span>

<div class="viewcode-block" id="FunctionalBase.getEnergyArray"><a class="viewcode-back" href="../../../../fudge/fudge.productData.distributions.html#fudge.productData.distributions.energy.FunctionalBase.getEnergyArray">[docs]</a>    <span class="k">def</span> <span class="nf">getEnergyArray</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">EMin</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">EMax</span> <span class="o">=</span> <span class="kc">None</span> <span class="p">)</span> <span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This method returns the list of projectile energies that *self* is specific at.</span>

<span class="sd">        :parem EMin:        If *self* does not have an projectile energy values, the default minimum energy to return.</span>
<span class="sd">        :parem EMax:        If *self* does not have an projectile energy values, the default maximum energy to return.</span>

<span class="sd">        :return:            Python list of float.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span><span class="p">(</span> <span class="nb">isinstance</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameter1</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">regionsModule</span><span class="o">.</span><span class="n">Regions1d</span> <span class="p">)</span> <span class="p">)</span> <span class="p">:</span>
            <span class="n">Es</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">region</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameter1</span><span class="o">.</span><span class="n">data</span> <span class="p">:</span>
                <span class="n">Es</span> <span class="o">=</span> <span class="n">Es</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span> <span class="n">E</span> <span class="k">for</span> <span class="n">E</span><span class="p">,</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">region</span> <span class="p">]</span>
        <span class="k">else</span> <span class="p">:</span>
            <span class="n">Es</span> <span class="o">=</span> <span class="p">[</span> <span class="n">E</span> <span class="k">for</span> <span class="n">E</span><span class="p">,</span> <span class="n">p</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameter1</span><span class="o">.</span><span class="n">data</span> <span class="p">]</span>
        <span class="k">if</span><span class="p">(</span> <span class="n">EMin</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">)</span> <span class="p">:</span>
            <span class="k">if</span><span class="p">(</span> <span class="n">EMin</span> <span class="o">&lt;</span> <span class="p">(</span> <span class="mf">1.0</span> <span class="o">-</span> <span class="mf">1e-15</span> <span class="p">)</span> <span class="o">*</span> <span class="n">Es</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="p">)</span> <span class="p">:</span> <span class="n">Es</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span> <span class="mi">0</span><span class="p">,</span> <span class="n">EMin</span> <span class="p">)</span>
        <span class="k">if</span><span class="p">(</span> <span class="n">EMax</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">)</span> <span class="p">:</span>
            <span class="k">if</span><span class="p">(</span> <span class="n">EMax</span> <span class="o">&gt;</span> <span class="n">Es</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="p">)</span> <span class="p">:</span> <span class="n">Es</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="n">EMax</span> <span class="p">)</span>
        <span class="k">return</span><span class="p">(</span> <span class="n">Es</span> <span class="p">)</span></div>

<div class="viewcode-block" id="FunctionalBase.fixDomains"><a class="viewcode-back" href="../../../../fudge/fudge.productData.distributions.html#fudge.productData.distributions.energy.FunctionalBase.fixDomains">[docs]</a>    <span class="k">def</span> <span class="nf">fixDomains</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">energyMin</span><span class="p">,</span> <span class="n">energyMax</span><span class="p">,</span> <span class="n">domainToFix</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calls the *fixDomains* for the **parameter1** member and if *self* is a **Watt** spectrum the **parameter2** member.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">numberOfFixes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameter1</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">fixDomains</span><span class="p">(</span><span class="n">energyMin</span><span class="p">,</span> <span class="n">energyMax</span><span class="p">,</span> <span class="n">domainToFix</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Watt</span><span class="p">):</span> <span class="n">numberOfFixes</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameter2</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">fixDomains</span><span class="p">(</span><span class="n">energyMin</span><span class="p">,</span> <span class="n">energyMax</span><span class="p">,</span> <span class="n">domainToFix</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">numberOfFixes</span></div>

<div class="viewcode-block" id="FunctionalBase.toXML_strList"><a class="viewcode-back" href="../../../../fudge/fudge.productData.distributions.html#fudge.productData.distributions.energy.FunctionalBase.toXML_strList">[docs]</a>    <span class="k">def</span> <span class="nf">toXML_strList</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">indent</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span> <span class="p">)</span> <span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a list of str instances representing the XML lines of *self*.</span>

<span class="sd">        :param indent:          The minimum amount of indentation.</span>
<span class="sd">        :param kwargs:          A dictionary of extra arguments that controls how *self* is converted to a list of XML strings.</span>

<span class="sd">        :return:                List of str instances representing the XML lines of self.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">indent2</span> <span class="o">=</span> <span class="n">indent</span> <span class="o">+</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span> <span class="s1">&#39;incrementalIndent&#39;</span><span class="p">,</span> <span class="s1">&#39;  &#39;</span> <span class="p">)</span>

        <span class="n">xmlString</span> <span class="o">=</span> <span class="p">[</span> <span class="bp">self</span><span class="o">.</span><span class="n">XMLStartTagString</span><span class="p">(</span> <span class="n">indent</span> <span class="o">=</span> <span class="n">indent</span> <span class="p">)</span> <span class="p">]</span>
        <span class="k">if</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">LF</span> <span class="o">==</span> <span class="mi">12</span> <span class="p">)</span> <span class="p">:</span> 
            <span class="n">xmlString</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">EFL</span><span class="o">.</span><span class="n">toXML_strList</span><span class="p">(</span> <span class="n">indent2</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span> <span class="p">)</span>
            <span class="n">xmlString</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">EFH</span><span class="o">.</span><span class="n">toXML_strList</span><span class="p">(</span> <span class="n">indent2</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span> <span class="p">)</span>
        <span class="k">else</span> <span class="p">:</span>
            <span class="n">xmlString</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">U</span><span class="o">.</span><span class="n">toXML_strList</span><span class="p">(</span> <span class="n">indent2</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span> <span class="p">)</span>
        <span class="n">xmlString</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameter1</span><span class="o">.</span><span class="n">toXML_strList</span><span class="p">(</span> <span class="n">indent2</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span> <span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameter2</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span> <span class="n">xmlString</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameter2</span><span class="o">.</span><span class="n">toXML_strList</span><span class="p">(</span> <span class="n">indent2</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span> <span class="p">)</span>
        <span class="n">xmlString</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+=</span> <span class="s1">&#39;&lt;/</span><span class="si">%s</span><span class="s1">&gt;&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">moniker</span>
        <span class="k">return</span><span class="p">(</span> <span class="n">xmlString</span> <span class="p">)</span></div></div>

<div class="viewcode-block" id="GeneralEvaporation"><a class="viewcode-back" href="../../../../fudge/fudge.productData.distributions.html#fudge.productData.distributions.energy.GeneralEvaporation">[docs]</a><span class="k">class</span> <span class="nc">GeneralEvaporation</span><span class="p">(</span> <span class="n">FunctionalBase</span> <span class="p">)</span> <span class="p">:</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Class for storing the 2d general evaporation energy distribution. The distribution is of the form</span>
<span class="sd">    :math:`g(E&#39; / theta(E))`.</span>

<span class="sd">    The following table list the primary members of this class:</span>
<span class="sd">    </span>
<span class="sd">    +---------------+-------------------------------------------------------------------+</span>
<span class="sd">    | Member        | Description                                                       |</span>
<span class="sd">    +===============+===================================================================+</span>
<span class="sd">    | U             | Constant that defines the upper energy limit for the              |</span>
<span class="sd">    |               | secondary particle so that 0  E&#39;  E - U.                        |</span>
<span class="sd">    +---------------+-------------------------------------------------------------------+</span>
<span class="sd">    | thetas        | The :math:`theta(E)` function.                                    |</span>
<span class="sd">    +---------------+-------------------------------------------------------------------+</span>
<span class="sd">    | gs            | The :math:`g(x)` function.                                        |</span>
<span class="sd">    +---------------+-------------------------------------------------------------------+</span>

<span class="sd">    :param U:               Constant that defines the upper energy limit for the secondary particle so that 0  E&#39;  E - U.</span>
<span class="sd">                            This is not used/needed so should be removed.</span>
<span class="sd">    :param thetas:          The :math:`theta(E)` function.</span>
<span class="sd">    :param gs:              The :math:`g(x)` function.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">moniker</span> <span class="o">=</span> <span class="s1">&#39;generalEvaporation&#39;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">U</span><span class="p">,</span> <span class="n">thetas</span><span class="p">,</span> <span class="n">gs</span> <span class="p">)</span> <span class="p">:</span>

        <span class="n">FunctionalBase</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="n">U</span><span class="p">,</span> <span class="n">thetas</span><span class="p">,</span> <span class="n">gs</span> <span class="p">)</span>

<div class="viewcode-block" id="GeneralEvaporation.convertUnits"><a class="viewcode-back" href="../../../../fudge/fudge.productData.distributions.html#fudge.productData.distributions.energy.GeneralEvaporation.convertUnits">[docs]</a>    <span class="k">def</span> <span class="nf">convertUnits</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">unitMap</span> <span class="p">)</span> <span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Overriding method from base class due to a processing error</span>
<span class="sd">        (axes for &#39;g&#39; parameter not copied during processing).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1">#FIXME: This method should be removed once processed libraries are replaced.</span>

        <span class="k">if</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">U</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">)</span> <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">U</span><span class="o">.</span><span class="n">convertUnits</span><span class="p">(</span> <span class="n">unitMap</span> <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parameter1</span><span class="o">.</span><span class="n">convertUnits</span><span class="p">(</span> <span class="n">unitMap</span> <span class="p">)</span></div>
        <span class="c1"># skip &#39;g&#39;: it&#39;s unitless and may not have axes defined</span>
        <span class="c1">#if( self.parameter2 is not None ) : self.parameter2.convertUnits( unitMap )</span>

<div class="viewcode-block" id="GeneralEvaporation.averageEp"><a class="viewcode-back" href="../../../../fudge/fudge.productData.distributions.html#fudge.productData.distributions.energy.GeneralEvaporation.averageEp">[docs]</a>    <span class="k">def</span> <span class="nf">averageEp</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">E</span> <span class="p">)</span> <span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calculated the average energy of the outgoing photon at projectile energy *E*.</span>

<span class="sd">        :param E:       The energy of the projectile energy.</span>

<span class="sd">        :return:                Python float.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameter1</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span> <span class="n">E</span> <span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameter2</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">integrateWithWeight_x</span><span class="p">(</span> <span class="p">)</span> <span class="p">)</span></div>

<div class="viewcode-block" id="GeneralEvaporation.sqrtEp_AverageAtE"><a class="viewcode-back" href="../../../../fudge/fudge.productData.distributions.html#fudge.productData.distributions.energy.GeneralEvaporation.sqrtEp_AverageAtE">[docs]</a>    <span class="k">def</span> <span class="nf">sqrtEp_AverageAtE</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">E</span> <span class="p">)</span> <span class="p">:</span>
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This method returns the value of the integral :math:`\int dE&#39; \sqrt{E&#39;} P(E&#39;) at projectile energy *E*.</span>

<span class="sd">        :param E:   Energy of the projectile.</span>

<span class="sd">        :return:    Python float.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span><span class="p">(</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameter1</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span> <span class="n">E</span> <span class="p">)</span> <span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameter2</span><span class="o">.</span><span class="n">data</span> <span class="p">)</span><span class="o">.</span><span class="n">integrateWithWeight_sqrt_x</span><span class="p">(</span> <span class="p">)</span></div>

<div class="viewcode-block" id="GeneralEvaporation.energySpectrumAtEnergy"><a class="viewcode-back" href="../../../../fudge/fudge.productData.distributions.html#fudge.productData.distributions.energy.GeneralEvaporation.energySpectrumAtEnergy">[docs]</a>    <span class="k">def</span> <span class="nf">energySpectrumAtEnergy</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">energyIn</span> <span class="p">)</span> <span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calculates the outgoing particle&#39;s energy spectrum at projectile energy *energyIn*,</span>

<span class="sd">        :param energyIn:            Energy of the projectile.</span>

<span class="sd">        :return:                    XYs1d instance for the energy spectrum.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">theta</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameter1</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="n">energyIn</span><span class="p">)</span>
        <span class="n">spectrum</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameter2</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">toPointwise_withLinearXYs</span><span class="p">(</span> <span class="n">accuracy</span> <span class="o">=</span> <span class="mf">1e-5</span><span class="p">,</span> <span class="n">lowerEps</span> <span class="o">=</span> <span class="mf">1e-6</span><span class="p">,</span> <span class="n">upperEps</span> <span class="o">=</span> <span class="mf">1e-6</span> <span class="p">)</span>
        <span class="n">spectrum</span> <span class="o">=</span> <span class="n">spectrum</span><span class="o">.</span><span class="n">nf_pointwiseXY</span><span class="o">.</span><span class="n">scaleOffsetXAndY</span><span class="p">(</span><span class="n">xScale</span> <span class="o">=</span> <span class="n">theta</span><span class="p">,</span> <span class="n">yScale</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="n">theta</span> <span class="p">)</span>
        <span class="k">return</span><span class="p">(</span> <span class="n">XYs1d</span><span class="p">(</span> <span class="n">spectrum</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">defaultAxes</span><span class="p">(</span> <span class="n">energyUnit</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">domainUnit</span> <span class="p">)</span> <span class="p">)</span> <span class="p">)</span></div>

<div class="viewcode-block" id="GeneralEvaporation.isLinear"><a class="viewcode-back" href="../../../../fudge/fudge.productData.distributions.html#fudge.productData.distributions.energy.GeneralEvaporation.isLinear">[docs]</a>    <span class="k">def</span> <span class="nf">isLinear</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">qualifierOk</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">flatIsOk</span> <span class="o">=</span> <span class="kc">False</span> <span class="p">)</span> <span class="p">:</span>
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the results of isLinear called on the axes of :math:`g(E&#39;|E)`.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameter2</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">isLinear</span><span class="p">(</span> <span class="n">qualifierOk</span> <span class="o">=</span> <span class="n">qualifierOk</span><span class="p">,</span> <span class="n">flatIsOk</span> <span class="o">=</span> <span class="n">flatIsOk</span> <span class="p">)</span> <span class="p">)</span></div>

<div class="viewcode-block" id="GeneralEvaporation.to_xs_pdf_cdf1d"><a class="viewcode-back" href="../../../../fudge/fudge.productData.distributions.html#fudge.productData.distributions.energy.GeneralEvaporation.to_xs_pdf_cdf1d">[docs]</a>    <span class="k">def</span> <span class="nf">to_xs_pdf_cdf1d</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">style</span><span class="p">,</span> <span class="n">tempInfo</span><span class="p">,</span> <span class="n">indent</span> <span class="p">)</span> <span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This method returns a copy of *self* with its g data as a :py:class:`Xs_pdf_cdf1d` instance.</span>

<span class="sd">        :param style:           The style for the returned data.</span>
<span class="sd">        :param tempInfo:        Dictionary of data needed to calculate the data.</span>
<span class="sd">        :param indent:          The indentation for any verbosity.</span>
<span class="sd">    </span>
<span class="sd">        :return:                :py:class:`GeneralEvaporation`</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">_gs</span> <span class="o">=</span> <span class="n">G</span><span class="p">(</span><span class="n">Xs_pdf_cdf1d</span><span class="o">.</span><span class="n">fromXYs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parameter2</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">thinEpsilon</span><span class="o">=</span><span class="mf">1e-14</span><span class="p">))</span>
        <span class="n">_gs</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">axes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameter2</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">_form</span> <span class="o">=</span> <span class="n">GeneralEvaporation</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">U</span><span class="p">,</span> <span class="n">thetas</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameter1</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span> <span class="p">),</span> <span class="n">gs</span> <span class="o">=</span> <span class="n">_gs</span> <span class="p">)</span>
        <span class="k">return</span><span class="p">(</span> <span class="n">_form</span> <span class="p">)</span></div>

<div class="viewcode-block" id="GeneralEvaporation.toPointwise_withLinearXYs"><a class="viewcode-back" href="../../../../fudge/fudge.productData.distributions.html#fudge.productData.distributions.energy.GeneralEvaporation.toPointwise_withLinearXYs">[docs]</a>    <span class="k">def</span> <span class="nf">toPointwise_withLinearXYs</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>  <span class="p">)</span> <span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a pointwise represent of *self*.</span>

<span class="sd">        :param kwargs:              A dictionary that contains data to control the way this method acts.</span>

<span class="sd">        :return:                    An :py:class:`XYs2d` instance.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">pwl</span> <span class="o">=</span> <span class="n">XYs2d</span><span class="p">(</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">defaultAxes</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameter1</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">domainUnit</span> <span class="p">)</span> <span class="p">)</span>
        <span class="n">thetas</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameter1</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">toPointwise_withLinearXYs</span><span class="p">(</span> <span class="o">**</span><span class="n">kwargs</span> <span class="p">)</span>
        <span class="n">gs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameter2</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">toPointwise_withLinearXYs</span><span class="p">(</span> <span class="o">**</span><span class="n">kwargs</span> <span class="p">)</span>
        <span class="k">for</span> <span class="n">E_in</span><span class="p">,</span> <span class="n">theta</span> <span class="ow">in</span> <span class="n">thetas</span> <span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="p">[</span> <span class="p">[</span> <span class="n">theta</span> <span class="o">*</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">/</span> <span class="n">theta</span> <span class="p">]</span> <span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">gs</span> <span class="p">]</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">XYs1d</span><span class="p">(</span> <span class="n">data</span><span class="p">,</span> <span class="n">outerDomainValue</span> <span class="o">=</span> <span class="n">E_in</span> <span class="p">)</span>
            <span class="n">data</span><span class="o">.</span><span class="n">normalize</span><span class="p">(</span> <span class="n">insitu</span> <span class="o">=</span> <span class="kc">True</span> <span class="p">)</span>
            <span class="n">pwl</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="n">data</span> <span class="p">)</span>
        <span class="k">return</span><span class="p">(</span> <span class="n">pwl</span> <span class="p">)</span></div>

<div class="viewcode-block" id="GeneralEvaporation.parseNodeUsingClass"><a class="viewcode-back" href="../../../../fudge/fudge.productData.distributions.html#fudge.productData.distributions.energy.GeneralEvaporation.parseNodeUsingClass">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">parseNodeUsingClass</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">element</span><span class="p">,</span> <span class="n">xPath</span><span class="p">,</span> <span class="n">linkData</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Parse *element* into an instance of *cls*.</span>

<span class="sd">        :param cls:         Form class to return.</span>
<span class="sd">        :param element:     Node to parse.</span>
<span class="sd">        :param xPath:       List containing xPath to current node, useful mostly for debugging.</span>
<span class="sd">        :param linkData:    dict that collects unresolved links.</span>
<span class="sd">        :param kwargs:      A dictionary of extra arguments that controls how *self* is converted to a list of XML strings.</span>

<span class="sd">        :return: an instance of *cls* representing *element*.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">xPath</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="n">element</span><span class="o">.</span><span class="n">tag</span> <span class="p">)</span>
        <span class="n">theta_</span> <span class="o">=</span> <span class="n">Theta</span><span class="o">.</span><span class="n">parseNodeUsingClass</span><span class="p">(</span><span class="n">element</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">Theta</span><span class="o">.</span><span class="n">moniker</span><span class="p">),</span> <span class="n">xPath</span><span class="p">,</span> <span class="n">linkData</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">g_</span> <span class="o">=</span> <span class="n">G</span><span class="o">.</span><span class="n">parseNodeUsingClass</span><span class="p">(</span><span class="n">element</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">G</span><span class="o">.</span><span class="n">moniker</span><span class="p">),</span> <span class="n">xPath</span><span class="p">,</span> <span class="n">linkData</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">U</span> <span class="o">=</span> <span class="n">physicalQuantityModule</span><span class="o">.</span><span class="n">U</span><span class="o">.</span><span class="n">parseNodeUsingClass</span><span class="p">(</span><span class="n">element</span><span class="o">.</span><span class="n">find</span><span class="p">(</span> <span class="s1">&#39;U&#39;</span> <span class="p">),</span> <span class="n">xPath</span><span class="p">,</span> <span class="n">linkData</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">GES</span> <span class="o">=</span> <span class="bp">cls</span><span class="p">(</span> <span class="n">U</span><span class="p">,</span> <span class="n">theta_</span><span class="p">,</span> <span class="n">g_</span> <span class="p">)</span>
        <span class="n">xPath</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">GES</span></div></div>

<div class="viewcode-block" id="SimpleMaxwellianFission1d"><a class="viewcode-back" href="../../../../fudge/fudge.productData.distributions.html#fudge.productData.distributions.energy.SimpleMaxwellianFission1d">[docs]</a><span class="k">class</span> <span class="nc">SimpleMaxwellianFission1d</span><span class="p">:</span>       <span class="c1"># FIXME, needs units</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This class represents a :py:class:`SimpleMaxwellianFission` instance evaluated at the specified projectile energy.</span>
<span class="sd">    The 1d function is :math:`P(E&#39;) = \sqrt{E&#39;} \, \exp(-E&#39; /  \theta) / I` with :math:`\theta = \theta(E)` where E is the projectile energy</span>
<span class="sd">    for this function.</span>

<span class="sd">    The following table list the primary members of this class:</span>
<span class="sd">    </span>
<span class="sd">    +---------------+-------------------------------------------------------------------+</span>
<span class="sd">    | Member        | Description                                                       |</span>
<span class="sd">    +===============+===================================================================+</span>
<span class="sd">    | energy        | The projectile energy this function is evaluated at.              |</span>
<span class="sd">    +---------------+-------------------------------------------------------------------+</span>
<span class="sd">    | U             | Constant that defines the upper energy limit for the              |</span>
<span class="sd">    |               | secondary particle so that 0  E&#39;  E - U.                        |</span>
<span class="sd">    +---------------+-------------------------------------------------------------------+</span>
<span class="sd">    | theta         | The value of :math:`theta(E)` at E = *energy*.                    |</span>
<span class="sd">    +---------------+-------------------------------------------------------------------+</span>

<span class="sd">    :param energy:          The projectile energy which :math:`theta = theta(E)` is evaluated at.</span>
<span class="sd">    :param U:               Constant that defines the upper energy limit for the secondary particle so that 0  E&#39;  E - U.</span>
<span class="sd">                            This is not used/needed so should be removed.</span>
<span class="sd">    :param theta:           The value of :math:`theta = theta(E)` evaluated for E = energy.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">energy</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">U</span> <span class="p">)</span> <span class="p">:</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">energy</span> <span class="o">=</span> <span class="n">energy</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">theta</span> <span class="o">=</span> <span class="n">theta</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">U</span> <span class="o">=</span> <span class="n">U</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">norm</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">evaluateIndefiniteIntegral</span><span class="p">(</span> <span class="n">energy</span> <span class="o">-</span> <span class="n">U</span> <span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">domainMin</span><span class="p">(</span> <span class="bp">self</span> <span class="p">)</span> <span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the minimum projectile energy for *self*.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span><span class="p">(</span> <span class="mf">0.0</span> <span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">domainMax</span><span class="p">(</span> <span class="bp">self</span> <span class="p">)</span> <span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the maximum projectile energy for *self*.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">U</span> <span class="p">)</span>

<div class="viewcode-block" id="SimpleMaxwellianFission1d.evaluate"><a class="viewcode-back" href="../../../../fudge/fudge.productData.distributions.html#fudge.productData.distributions.energy.SimpleMaxwellianFission1d.evaluate">[docs]</a>    <span class="k">def</span> <span class="nf">evaluate</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">energy</span> <span class="p">)</span> <span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the value of *self* evaluated at outgoing particle energy *energy*.</span>

<span class="sd">        :param energy:      The energy of the outgoing particle.</span>

<span class="sd">        :return:            Python float.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span><span class="p">(</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span> <span class="n">energy</span> <span class="p">)</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span> <span class="o">-</span><span class="n">energy</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">theta</span> <span class="p">)</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">norm</span> <span class="p">)</span></div>

<div class="viewcode-block" id="SimpleMaxwellianFission1d.evaluateIndefiniteIntegral"><a class="viewcode-back" href="../../../../fudge/fudge.productData.distributions.html#fudge.productData.distributions.energy.SimpleMaxwellianFission1d.evaluateIndefiniteIntegral">[docs]</a>    <span class="k">def</span> <span class="nf">evaluateIndefiniteIntegral</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">energy</span> <span class="p">)</span> <span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the value of the integral of *self* from E&#39; = 0 to E&#39; = *energy*.</span>

<span class="sd">        :param energy:      The energy of the outgoing particle.</span>

<span class="sd">        :return:            Python float.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">X</span> <span class="o">=</span> <span class="n">energy</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">theta</span>
        <span class="n">sqrtX</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span> <span class="n">X</span> <span class="p">)</span>
        <span class="k">return</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">theta</span><span class="o">**</span><span class="mf">1.5</span> <span class="o">*</span> <span class="p">(</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span> <span class="n">math</span><span class="o">.</span><span class="n">pi</span> <span class="p">)</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">erf</span><span class="p">(</span> <span class="n">sqrtX</span> <span class="p">)</span> <span class="o">-</span> <span class="n">sqrtX</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span> <span class="o">-</span><span class="n">X</span> <span class="p">)</span> <span class="p">)</span> <span class="p">)</span></div>

<div class="viewcode-block" id="SimpleMaxwellianFission1d.integrate"><a class="viewcode-back" href="../../../../fudge/fudge.productData.distributions.html#fudge.productData.distributions.energy.SimpleMaxwellianFission1d.integrate">[docs]</a>    <span class="k">def</span> <span class="nf">integrate</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">energyMin</span><span class="p">,</span> <span class="n">energyMax</span> <span class="p">)</span> <span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This meethod integrates the distribution at projectile energy over the specified outgoing energy, mu and phi ranges.</span>
<span class="sd">        See function :py:func:`miscellaneousModule.domainLimits` for how to specify *energyOut*, *muOut* and *phiOut*.</span>
<span class="sd">        </span>
<span class="sd">        :param energyMin:           The minimum value for the outgoing energy range.</span>
<span class="sd">        :param energyMax:           The maximum value for the outgoing energy range.</span>

<span class="sd">        :return:                    A float representing the value of the integration.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">energyMin</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span> <span class="mf">0.0</span><span class="p">,</span> <span class="nb">min</span><span class="p">(</span> <span class="n">energyMin</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">U</span> <span class="p">)</span> <span class="p">)</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">theta</span>
        <span class="n">energyMax</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span> <span class="mf">0.0</span><span class="p">,</span> <span class="nb">min</span><span class="p">(</span> <span class="n">energyMax</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">U</span> <span class="p">)</span> <span class="p">)</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">theta</span>

        <span class="k">return</span><span class="p">(</span> <span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">evaluateIndefiniteIntegral</span><span class="p">(</span> <span class="n">energyMax</span> <span class="p">)</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">evaluateIndefiniteIntegral</span><span class="p">(</span> <span class="n">energyMin</span> <span class="p">)</span> <span class="p">)</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">norm</span> <span class="p">)</span></div></div>

<div class="viewcode-block" id="SimpleMaxwellianFission"><a class="viewcode-back" href="../../../../fudge/fudge.productData.distributions.html#fudge.productData.distributions.energy.SimpleMaxwellianFission">[docs]</a><span class="k">class</span> <span class="nc">SimpleMaxwellianFission</span><span class="p">(</span> <span class="n">FunctionalBase</span> <span class="p">)</span> <span class="p">:</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Class for storing the 2d simple Maxwellian fission distribution. The distribution is defined as</span>
<span class="sd">    :math:`P(E&#39;) = \sqrt{E&#39;} \, \exp(-E&#39; /  \theta(E)) / I`.</span>

<span class="sd">    The following table list the primary members of this class:</span>
<span class="sd">    </span>
<span class="sd">    +---------------+-------------------------------------------------------------------+</span>
<span class="sd">    | Member        | Description                                                       |</span>
<span class="sd">    +===============+===================================================================+</span>
<span class="sd">    | U             | Constant that defines the upper energy limit for the              |</span>
<span class="sd">    |               | secondary particle so that 0  E&#39;  E - U.                        |</span>
<span class="sd">    +---------------+-------------------------------------------------------------------+</span>
<span class="sd">    | thetas        | The :math:`theta(E)` function.                                    |</span>
<span class="sd">    +---------------+-------------------------------------------------------------------+</span>

<span class="sd">    :param U:               Constant that defines the upper energy limit for the secondary particle so that 0  E&#39;  E - U.</span>
<span class="sd">                            This is not used/needed so should be removed.</span>
<span class="sd">    :param thetas:          The :math:`theta(E)` function.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">moniker</span> <span class="o">=</span> <span class="s1">&#39;simpleMaxwellianFission&#39;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">U</span><span class="p">,</span> <span class="n">thetas</span> <span class="p">)</span> <span class="p">:</span>

        <span class="n">FunctionalBase</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="n">U</span><span class="p">,</span> <span class="n">thetas</span> <span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">theta</span><span class="p">(</span> <span class="bp">self</span> <span class="p">)</span> <span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns a reference to the 1d :math:`\theta(E)` function.&quot;&quot;&quot;</span>

        <span class="k">return</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameter1</span> <span class="p">)</span>

<div class="viewcode-block" id="SimpleMaxwellianFission.averageEp"><a class="viewcode-back" href="../../../../fudge/fudge.productData.distributions.html#fudge.productData.distributions.energy.SimpleMaxwellianFission.averageEp">[docs]</a>    <span class="k">def</span> <span class="nf">averageEp</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">E</span> <span class="p">)</span> <span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calculated the average energy of the outgoing photon at projectile energy *E*.</span>

<span class="sd">        :param E:       The energy of the projectile energy.</span>

<span class="sd">        :return:                Python float.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">theta</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameter1</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span> <span class="n">E</span> <span class="p">)</span>
        <span class="n">a</span> <span class="o">=</span> <span class="p">(</span> <span class="n">E</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">U</span><span class="o">.</span><span class="n">value</span> <span class="p">)</span> <span class="o">/</span> <span class="n">theta</span>
        <span class="k">if</span><span class="p">(</span> <span class="n">a</span> <span class="o">&lt;</span> <span class="mf">1e-4</span> <span class="p">)</span> <span class="p">:</span> <span class="k">return</span><span class="p">(</span> <span class="n">theta</span> <span class="o">*</span> <span class="n">a</span> <span class="o">*</span> <span class="p">(</span> <span class="mf">1575.</span> <span class="o">-</span> <span class="n">a</span> <span class="o">*</span> <span class="p">(</span> <span class="mf">180.</span> <span class="o">+</span> <span class="mi">8</span> <span class="o">*</span> <span class="n">a</span> <span class="p">)</span> <span class="p">)</span> <span class="o">/</span> <span class="mf">2625.</span> <span class="p">)</span>
        <span class="n">sqrt_a</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span> <span class="n">a</span> <span class="p">)</span>
        <span class="n">exp_a</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span> <span class="o">-</span><span class="n">a</span> <span class="p">)</span>
        <span class="n">erf_sqrt_a</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span> <span class="n">math</span><span class="o">.</span><span class="n">pi</span> <span class="p">)</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">erf</span><span class="p">(</span> <span class="n">sqrt_a</span> <span class="p">)</span>
        <span class="k">return</span><span class="p">(</span> <span class="n">theta</span> <span class="o">*</span> <span class="p">(</span> <span class="mf">0.75</span> <span class="o">*</span> <span class="n">erf_sqrt_a</span> <span class="o">-</span> <span class="n">sqrt_a</span> <span class="o">*</span> <span class="p">(</span> <span class="mf">1.5</span> <span class="o">+</span> <span class="n">a</span> <span class="p">)</span> <span class="o">*</span> <span class="n">exp_a</span> <span class="p">)</span> <span class="o">/</span> <span class="p">(</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">erf_sqrt_a</span> <span class="o">-</span> <span class="n">sqrt_a</span> <span class="o">*</span> <span class="n">exp_a</span> <span class="p">)</span> <span class="p">)</span></div>

<div class="viewcode-block" id="SimpleMaxwellianFission.sqrtEp_AverageAtE"><a class="viewcode-back" href="../../../../fudge/fudge.productData.distributions.html#fudge.productData.distributions.energy.SimpleMaxwellianFission.sqrtEp_AverageAtE">[docs]</a>    <span class="k">def</span> <span class="nf">sqrtEp_AverageAtE</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">E</span> <span class="p">)</span> <span class="p">:</span>
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This method returns the value of the integral :math:`\int dE&#39; \sqrt{E&#39;} P(E&#39;) at projectile energy *E*.</span>

<span class="sd">        :param E:   Energy of the projectile.</span>

<span class="sd">        :return:    Python float.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">theta</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameter1</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span> <span class="n">E</span> <span class="p">)</span>
        <span class="n">a</span> <span class="o">=</span> <span class="p">(</span> <span class="n">E</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">U</span><span class="o">.</span><span class="n">value</span> <span class="p">)</span> <span class="o">/</span> <span class="n">theta</span>
        <span class="k">if</span><span class="p">(</span> <span class="n">a</span> <span class="o">&lt;</span> <span class="mf">1e-4</span> <span class="p">)</span> <span class="p">:</span> <span class="k">return</span><span class="p">(</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span> <span class="n">theta</span> <span class="o">*</span> <span class="n">a</span> <span class="p">)</span> <span class="o">*</span> <span class="p">(</span> <span class="mf">2100.</span> <span class="o">-</span> <span class="n">a</span> <span class="o">*</span> <span class="p">(</span> <span class="mf">140.</span> <span class="o">+</span> <span class="mf">9.</span> <span class="o">*</span> <span class="n">a</span> <span class="p">)</span> <span class="p">)</span> <span class="o">/</span> <span class="mf">2800.</span> <span class="p">)</span>
        <span class="n">sqrt_a</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span> <span class="n">a</span> <span class="p">)</span>
        <span class="n">exp_a</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span> <span class="o">-</span><span class="n">a</span> <span class="p">)</span>
        <span class="n">erf_sqrt_a</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span> <span class="n">math</span><span class="o">.</span><span class="n">pi</span> <span class="p">)</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">erf</span><span class="p">(</span> <span class="n">sqrt_a</span> <span class="p">)</span>
        <span class="k">return</span><span class="p">(</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span> <span class="n">theta</span> <span class="p">)</span> <span class="o">*</span> <span class="p">(</span> <span class="mi">1</span> <span class="o">-</span> <span class="p">(</span> <span class="mf">1.</span> <span class="o">+</span> <span class="n">a</span> <span class="p">)</span> <span class="o">*</span> <span class="n">exp_a</span> <span class="p">)</span> <span class="o">/</span> <span class="p">(</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">erf_sqrt_a</span> <span class="o">-</span> <span class="n">sqrt_a</span> <span class="o">*</span> <span class="n">exp_a</span> <span class="p">)</span> <span class="p">)</span></div>

<div class="viewcode-block" id="SimpleMaxwellianFission.energySpectrumAtEnergy"><a class="viewcode-back" href="../../../../fudge/fudge.productData.distributions.html#fudge.productData.distributions.energy.SimpleMaxwellianFission.energySpectrumAtEnergy">[docs]</a>    <span class="k">def</span> <span class="nf">energySpectrumAtEnergy</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">energyIn</span> <span class="p">)</span> <span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calculates the outgoing particle&#39;s energy spectrum at projectile energy *energyIn*,</span>

<span class="sd">        :param energyIn:            Energy of the projectile.</span>

<span class="sd">        :return:                    XYs1d instance for the energy spectrum.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">def</span> <span class="nf">A</span><span class="p">(</span> <span class="n">energyOut</span><span class="p">,</span> <span class="bp">self</span> <span class="p">)</span> <span class="p">:</span>

            <span class="k">return</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span> <span class="n">energyOut</span> <span class="p">)</span> <span class="p">)</span>

        <span class="n">spectrum1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span> <span class="n">energyIn</span> <span class="p">)</span>
        <span class="n">spectrum2</span> <span class="o">=</span> <span class="n">XYs1dModule</span><span class="o">.</span><span class="n">pointwiseXY_C</span><span class="o">.</span><span class="n">createFromFunction</span><span class="p">(</span> <span class="p">[</span> <span class="mf">0.0</span><span class="p">,</span> <span class="n">energyIn</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">U</span><span class="o">.</span><span class="n">value</span> <span class="p">],</span> <span class="n">A</span><span class="p">,</span> <span class="n">spectrum1</span><span class="p">,</span> <span class="mf">1e-3</span><span class="p">,</span> <span class="mi">12</span> <span class="p">)</span>
        <span class="k">return</span><span class="p">(</span> <span class="n">XYs1d</span><span class="p">(</span> <span class="n">spectrum2</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">defaultAxes</span><span class="p">(</span> <span class="n">energyUnit</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">domainUnit</span> <span class="p">)</span> <span class="p">)</span> <span class="p">)</span></div>

<div class="viewcode-block" id="SimpleMaxwellianFission.evaluate"><a class="viewcode-back" href="../../../../fudge/fudge.productData.distributions.html#fudge.productData.distributions.energy.SimpleMaxwellianFission.evaluate">[docs]</a>    <span class="k">def</span> <span class="nf">evaluate</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">energy</span> <span class="p">)</span> <span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a 1d function of *self* evaluated at projectile energy *energy*.</span>

<span class="sd">        :param energy:      The energy of the outgoing particle.</span>

<span class="sd">        :return:            :py:class:`SimpleMaxwellianFission1d` instance.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span><span class="p">(</span> <span class="n">SimpleMaxwellianFission1d</span><span class="p">(</span> <span class="n">energy</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">theta</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span> <span class="n">energy</span> <span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">U</span><span class="o">.</span><span class="n">value</span> <span class="p">)</span> <span class="p">)</span></div>

<div class="viewcode-block" id="SimpleMaxwellianFission.toPointwise_withLinearXYs"><a class="viewcode-back" href="../../../../fudge/fudge.productData.distributions.html#fudge.productData.distributions.energy.SimpleMaxwellianFission.toPointwise_withLinearXYs">[docs]</a>    <span class="k">def</span> <span class="nf">toPointwise_withLinearXYs</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span> <span class="p">)</span> <span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a pointwise represent of *self*.</span>

<span class="sd">        :param kwargs:              A dictionary that contains data to control the way this method acts.</span>

<span class="sd">        :return:                    An :py:class:`XYs2d` instance.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">def</span> <span class="nf">evaluateAtX</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">x</span> <span class="p">)</span> <span class="p">:</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            A function needed by :py:class:`EnergyFunctionalDataToPointwise` to evaluate a simple Maxwellian fission</span>
<span class="sd">            distribution at the outgoing particle energy *x* for :math:`\theta(E)` = self.p1.</span>

<span class="sd">            :param x:       The energy of the outgoing particle.</span>

<span class="sd">            :return:        Python float.</span>
<span class="sd">            &quot;&quot;&quot;</span>

            <span class="k">return</span><span class="p">(</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span> <span class="n">x</span> <span class="p">)</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span> <span class="o">-</span><span class="n">x</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">p1</span> <span class="p">)</span> <span class="p">)</span>

        <span class="n">ef</span> <span class="o">=</span> <span class="n">EnergyFunctionalDataToPointwise</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">evaluateAtX</span> <span class="p">)</span>
        <span class="k">return</span><span class="p">(</span> <span class="n">ef</span><span class="o">.</span><span class="n">toPointwise_withLinearXYs</span><span class="p">(</span> <span class="o">**</span><span class="n">kwargs</span> <span class="p">)</span> <span class="p">)</span></div>

<div class="viewcode-block" id="SimpleMaxwellianFission.parseNodeUsingClass"><a class="viewcode-back" href="../../../../fudge/fudge.productData.distributions.html#fudge.productData.distributions.energy.SimpleMaxwellianFission.parseNodeUsingClass">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">parseNodeUsingClass</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">MFelement</span><span class="p">,</span> <span class="n">xPath</span><span class="p">,</span> <span class="n">linkData</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Parse *MFelement* into an instance of *cls*.</span>

<span class="sd">        :param cls:         Form class to return.</span>
<span class="sd">        :param MFelement:   Node to parse.</span>
<span class="sd">        :param xPath:       List containing xPath to current node, useful mostly for debugging.</span>
<span class="sd">        :param linkData:    dict that collects unresolved links.</span>
<span class="sd">        :param kwargs:      A dictionary of extra arguments that controls how *self* is converted to a list of XML strings.</span>

<span class="sd">        :return: an instance of *cls* representing *MFelement*.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">xPath</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="n">MFelement</span><span class="o">.</span><span class="n">tag</span> <span class="p">)</span>
        <span class="n">theta_</span> <span class="o">=</span> <span class="n">Theta</span><span class="o">.</span><span class="n">parseNodeUsingClass</span><span class="p">(</span><span class="n">MFelement</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">Theta</span><span class="o">.</span><span class="n">moniker</span><span class="p">),</span> <span class="n">xPath</span><span class="p">,</span> <span class="n">linkData</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">U</span> <span class="o">=</span> <span class="n">physicalQuantityModule</span><span class="o">.</span><span class="n">U</span><span class="o">.</span><span class="n">parseNodeUsingClass</span><span class="p">(</span><span class="n">MFelement</span><span class="o">.</span><span class="n">find</span><span class="p">(</span> <span class="s1">&#39;U&#39;</span> <span class="p">),</span> <span class="n">xPath</span><span class="p">,</span> <span class="n">linkData</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">SMF</span> <span class="o">=</span> <span class="bp">cls</span><span class="p">(</span> <span class="n">U</span><span class="p">,</span> <span class="n">theta_</span> <span class="p">)</span>
        <span class="n">xPath</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">SMF</span></div></div>

<div class="viewcode-block" id="Evaporation1d"><a class="viewcode-back" href="../../../../fudge/fudge.productData.distributions.html#fudge.productData.distributions.energy.Evaporation1d">[docs]</a><span class="k">class</span> <span class="nc">Evaporation1d</span><span class="p">:</span>       <span class="c1"># FIXME, needs units</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This class represents an :py:class:`Evaporation` instance evaluated at the specified projectile energy.</span>
<span class="sd">    The 1d function is :math:`P(E&#39;) = E&#39; \, \exp(-E&#39; /  \theta) / I` with :math:`\theta = \theta(E)` where E is the projectile energy</span>
<span class="sd">    for this function.</span>

<span class="sd">    The following table list the primary members of this class:</span>
<span class="sd">    </span>
<span class="sd">    +---------------+-------------------------------------------------------------------+</span>
<span class="sd">    | Member        | Description                                                       |</span>
<span class="sd">    +===============+===================================================================+</span>
<span class="sd">    | energy        | The projectile energy this function is evaluated at.              |</span>
<span class="sd">    +---------------+-------------------------------------------------------------------+</span>
<span class="sd">    | theta         | The value of :math:`theta(E)` at E = *energy*.                    |</span>
<span class="sd">    +---------------+-------------------------------------------------------------------+</span>
<span class="sd">    | U             | Constant that defines the upper energy limit for the              |</span>
<span class="sd">    |               | secondary particle so that 0  E&#39;  E - U.                        |</span>
<span class="sd">    +---------------+-------------------------------------------------------------------+</span>

<span class="sd">    :param energy:          The projectile energy which :math:`theta = theta(E)` is evaluated at.</span>
<span class="sd">    :param theta:           The value of :math:`theta = theta(E)` evaluated for E = energy.</span>
<span class="sd">    :param U:               Constant that defines the upper energy limit for the secondary particle so that 0  E&#39;  E - U.</span>
<span class="sd">                            This is not used/needed so should be removed.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">energy</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">U</span> <span class="p">)</span> <span class="p">:</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">energy</span> <span class="o">=</span> <span class="n">energy</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">theta</span> <span class="o">=</span> <span class="n">theta</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">U</span> <span class="o">=</span> <span class="n">U</span>

        <span class="n">x</span> <span class="o">=</span> <span class="p">(</span> <span class="n">energy</span> <span class="o">-</span> <span class="n">U</span> <span class="p">)</span> <span class="o">/</span> <span class="n">theta</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">norm</span> <span class="o">=</span> <span class="n">theta</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="p">(</span> <span class="mf">1.0</span> <span class="o">-</span> <span class="n">math</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span> <span class="o">-</span><span class="n">x</span> <span class="p">)</span> <span class="o">*</span> <span class="p">(</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">x</span> <span class="p">)</span> <span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">domainMin</span><span class="p">(</span> <span class="bp">self</span> <span class="p">)</span> <span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the minimum projectile energy for *self*.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span><span class="p">(</span> <span class="mf">0.0</span> <span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">domainMax</span><span class="p">(</span> <span class="bp">self</span> <span class="p">)</span> <span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the maximum projectile energy for *self*.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">U</span> <span class="p">)</span>

<div class="viewcode-block" id="Evaporation1d.evaluate"><a class="viewcode-back" href="../../../../fudge/fudge.productData.distributions.html#fudge.productData.distributions.energy.Evaporation1d.evaluate">[docs]</a>    <span class="k">def</span> <span class="nf">evaluate</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">energy</span> <span class="p">)</span> <span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the value of *self* evaluated at outgoing particle energy *energy*.</span>

<span class="sd">        :param energy:      The energy of the outgoing particle.</span>

<span class="sd">        :return:            Python float.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span><span class="p">(</span> <span class="n">energy</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span> <span class="o">-</span><span class="n">energy</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">theta</span> <span class="p">)</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">norm</span> <span class="p">)</span></div>

<div class="viewcode-block" id="Evaporation1d.integrate"><a class="viewcode-back" href="../../../../fudge/fudge.productData.distributions.html#fudge.productData.distributions.energy.Evaporation1d.integrate">[docs]</a>    <span class="k">def</span> <span class="nf">integrate</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">energyMin</span><span class="p">,</span> <span class="n">energyMax</span> <span class="p">)</span> <span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This meethod integrates the distribution at projectile energy over the specified outgoing energy, mu and phi ranges.</span>
<span class="sd">        See function :py:func:`miscellaneousModule.domainLimits` for how to specify *energyOut*, *muOut* and *phiOut*.</span>
<span class="sd">        </span>
<span class="sd">        :param energyMin:           The minimum value for the outgoing energy range.</span>
<span class="sd">        :param energyMax:           The maximum value for the outgoing energy range.</span>

<span class="sd">        :return:                    A float representing the value of the integration.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">energyMin</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span> <span class="mf">0.0</span><span class="p">,</span> <span class="nb">min</span><span class="p">(</span> <span class="n">energyMin</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">U</span> <span class="p">)</span> <span class="p">)</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">theta</span>
        <span class="n">energyMax</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span> <span class="mf">0.0</span><span class="p">,</span> <span class="nb">min</span><span class="p">(</span> <span class="n">energyMax</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">U</span> <span class="p">)</span> <span class="p">)</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">theta</span>

        <span class="n">value1</span> <span class="o">=</span> <span class="p">(</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">energyMin</span> <span class="p">)</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span> <span class="o">-</span><span class="n">energyMin</span> <span class="p">)</span>
        <span class="n">value2</span> <span class="o">=</span> <span class="p">(</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">energyMax</span> <span class="p">)</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span> <span class="o">-</span><span class="n">energyMax</span> <span class="p">)</span>
        <span class="n">integral</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">theta</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="p">(</span> <span class="n">value1</span> <span class="o">-</span> <span class="n">value2</span> <span class="p">)</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">norm</span>

        <span class="k">return</span><span class="p">(</span> <span class="n">integral</span> <span class="p">)</span></div></div>

<div class="viewcode-block" id="Evaporation"><a class="viewcode-back" href="../../../../fudge/fudge.productData.distributions.html#fudge.productData.distributions.energy.Evaporation">[docs]</a><span class="k">class</span> <span class="nc">Evaporation</span><span class="p">(</span> <span class="n">FunctionalBase</span> <span class="p">)</span> <span class="p">:</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Class for storing the 2d evaporation energy distribution. The distribution is of the form</span>
<span class="sd">    :math:`E&#39; \, \exp(-E&#39;/theta(E)) / I`.</span>

<span class="sd">    The following table list the primary members of this class:</span>
<span class="sd">    </span>
<span class="sd">    +---------------+-------------------------------------------------------------------+</span>
<span class="sd">    | Member        | Description                                                       |</span>
<span class="sd">    +===============+===================================================================+</span>
<span class="sd">    | U             | Constant that defines the upper energy limit for the              |</span>
<span class="sd">    |               | secondary particle so that 0  E&#39;  E - U.                        |</span>
<span class="sd">    +---------------+-------------------------------------------------------------------+</span>
<span class="sd">    | thetas        | The :math:`theta(E)` function.                                    |</span>
<span class="sd">    +---------------+-------------------------------------------------------------------+</span>

<span class="sd">    :param U:               Constant that defines the upper energy limit for the secondary particle so that 0  E&#39;  E - U.</span>
<span class="sd">                            This is not used/needed so should be removed.</span>
<span class="sd">    :param thetas:          The :math:`theta(E)` function.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">moniker</span> <span class="o">=</span> <span class="s1">&#39;evaporation&#39;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">U</span><span class="p">,</span> <span class="n">thetas</span> <span class="p">)</span> <span class="p">:</span>

        <span class="n">FunctionalBase</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="n">U</span><span class="p">,</span> <span class="n">thetas</span> <span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">theta</span><span class="p">(</span> <span class="bp">self</span> <span class="p">)</span> <span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns a reference to the 1d :math:`\theta(E)` function.&quot;&quot;&quot;</span>

        <span class="k">return</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameter1</span> <span class="p">)</span>

<div class="viewcode-block" id="Evaporation.averageEp"><a class="viewcode-back" href="../../../../fudge/fudge.productData.distributions.html#fudge.productData.distributions.energy.Evaporation.averageEp">[docs]</a>    <span class="k">def</span> <span class="nf">averageEp</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">E</span> <span class="p">)</span> <span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calculated the average energy of the outgoing photon at projectile energy *E*.</span>

<span class="sd">        :param E:       The energy of the projectile energy.</span>

<span class="sd">        :return:                Python float.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span><span class="p">(</span> <span class="nb">isinstance</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameter1</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">regionsModule</span><span class="o">.</span><span class="n">Regions1d</span> <span class="p">)</span> <span class="p">)</span> <span class="p">:</span>
            <span class="k">for</span> <span class="n">region</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameter1</span><span class="o">.</span><span class="n">data</span> <span class="p">:</span>
                <span class="k">if</span><span class="p">(</span> <span class="n">E</span> <span class="o">&lt;=</span> <span class="n">region</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="p">)</span> <span class="p">:</span> <span class="k">break</span>
            <span class="n">theta</span> <span class="o">=</span> <span class="n">region</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span> <span class="n">E</span> <span class="p">)</span>
        <span class="k">else</span> <span class="p">:</span>
            <span class="n">theta</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameter1</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span> <span class="n">E</span> <span class="p">)</span>
        <span class="n">a</span> <span class="o">=</span> <span class="p">(</span> <span class="n">E</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">U</span><span class="o">.</span><span class="n">value</span> <span class="p">)</span> <span class="o">/</span> <span class="n">theta</span>
        <span class="k">if</span><span class="p">(</span> <span class="n">a</span> <span class="o">&lt;</span> <span class="mf">1e-4</span> <span class="p">)</span> <span class="p">:</span> <span class="k">return</span><span class="p">(</span> <span class="n">theta</span> <span class="o">*</span> <span class="n">a</span> <span class="o">*</span> <span class="p">(</span> <span class="mf">180.</span> <span class="o">-</span> <span class="n">a</span> <span class="o">*</span> <span class="p">(</span> <span class="mf">15.</span> <span class="o">+</span> <span class="n">a</span> <span class="p">)</span> <span class="p">)</span> <span class="o">/</span> <span class="mf">270.</span> <span class="p">)</span>
        <span class="n">exp_a</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span> <span class="o">-</span><span class="n">a</span> <span class="p">)</span>
        <span class="k">return</span><span class="p">(</span> <span class="n">theta</span> <span class="o">*</span> <span class="p">(</span> <span class="mf">2.</span> <span class="o">-</span> <span class="n">a</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">exp_a</span> <span class="o">/</span> <span class="p">(</span> <span class="mf">1.</span> <span class="o">-</span> <span class="p">(</span> <span class="mf">1.</span> <span class="o">+</span> <span class="n">a</span> <span class="p">)</span> <span class="o">*</span> <span class="n">exp_a</span> <span class="p">)</span> <span class="p">)</span> <span class="p">)</span></div>

<div class="viewcode-block" id="Evaporation.evaluate"><a class="viewcode-back" href="../../../../fudge/fudge.productData.distributions.html#fudge.productData.distributions.energy.Evaporation.evaluate">[docs]</a>    <span class="k">def</span> <span class="nf">evaluate</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">energy</span> <span class="p">)</span> <span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a 1d function of *self* evaluated at projectile energy *energy*.</span>

<span class="sd">        :param energy:      The energy of the outgoing particle.</span>

<span class="sd">        :return:            :py:class:`Evaporation1d` instance.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span><span class="p">(</span> <span class="n">Evaporation1d</span><span class="p">(</span> <span class="n">energy</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">theta</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span> <span class="n">energy</span> <span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">U</span><span class="o">.</span><span class="n">value</span> <span class="p">)</span> <span class="p">)</span></div>

<div class="viewcode-block" id="Evaporation.energySpectrumAtEnergy"><a class="viewcode-back" href="../../../../fudge/fudge.productData.distributions.html#fudge.productData.distributions.energy.Evaporation.energySpectrumAtEnergy">[docs]</a>    <span class="k">def</span> <span class="nf">energySpectrumAtEnergy</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">energyIn</span> <span class="p">)</span> <span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calculates the outgoing particle&#39;s energy spectrum at projectile energy *energyIn*,</span>

<span class="sd">        :param energyIn:            Energy of the projectile.</span>

<span class="sd">        :return:                    XYs1d instance for the energy spectrum.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">def</span> <span class="nf">A</span><span class="p">(</span> <span class="n">energyOut</span><span class="p">,</span> <span class="bp">self</span> <span class="p">)</span> <span class="p">:</span>

            <span class="k">return</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span> <span class="n">energyOut</span> <span class="p">)</span> <span class="p">)</span>

        <span class="n">spectrum1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span> <span class="n">energyIn</span> <span class="p">)</span>
        <span class="n">spectrum2</span> <span class="o">=</span> <span class="n">XYs1dModule</span><span class="o">.</span><span class="n">pointwiseXY_C</span><span class="o">.</span><span class="n">createFromFunction</span><span class="p">(</span> <span class="p">[</span> <span class="mf">0.0</span><span class="p">,</span> <span class="n">energyIn</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">U</span><span class="o">.</span><span class="n">value</span> <span class="p">],</span> <span class="n">A</span><span class="p">,</span> <span class="n">spectrum1</span><span class="p">,</span> <span class="mf">1e-3</span><span class="p">,</span> <span class="mi">12</span> <span class="p">)</span>
        <span class="k">return</span><span class="p">(</span> <span class="n">XYs1d</span><span class="p">(</span> <span class="n">spectrum2</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">defaultAxes</span><span class="p">(</span> <span class="n">energyUnit</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">domainUnit</span> <span class="p">)</span> <span class="p">)</span> <span class="p">)</span></div>

<div class="viewcode-block" id="Evaporation.sqrtEp_AverageAtE"><a class="viewcode-back" href="../../../../fudge/fudge.productData.distributions.html#fudge.productData.distributions.energy.Evaporation.sqrtEp_AverageAtE">[docs]</a>    <span class="k">def</span> <span class="nf">sqrtEp_AverageAtE</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">E</span> <span class="p">)</span> <span class="p">:</span>
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This method returns the value of the integral :math:`\int dE&#39; \sqrt{E&#39;} P(E&#39;) at projectile energy *E*.</span>

<span class="sd">        :param E:   Energy of the projectile.</span>

<span class="sd">        :return:    Python float.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">theta</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameter1</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span> <span class="n">E</span> <span class="p">)</span>
        <span class="n">a</span> <span class="o">=</span> <span class="p">(</span> <span class="n">E</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">U</span><span class="o">.</span><span class="n">value</span> <span class="p">)</span> <span class="o">/</span> <span class="n">theta</span>
        <span class="k">if</span><span class="p">(</span> <span class="n">a</span> <span class="o">&lt;</span> <span class="mf">1e-4</span> <span class="p">)</span> <span class="p">:</span> <span class="k">return</span><span class="p">(</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span> <span class="n">theta</span> <span class="o">*</span> <span class="n">a</span> <span class="p">)</span> <span class="o">*</span> <span class="p">(</span> <span class="mf">252.</span> <span class="o">-</span> <span class="n">a</span> <span class="o">*</span> <span class="p">(</span> <span class="mf">12.</span> <span class="o">+</span> <span class="n">a</span> <span class="p">)</span> <span class="p">)</span> <span class="o">/</span> <span class="mf">315.</span> <span class="p">)</span>
        <span class="n">sqrt_a</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span> <span class="n">a</span> <span class="p">)</span>
        <span class="n">exp_a</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span> <span class="o">-</span><span class="n">a</span> <span class="p">)</span>
        <span class="k">return</span><span class="p">(</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span> <span class="n">theta</span> <span class="p">)</span> <span class="o">*</span> <span class="p">(</span> <span class="mf">1.32934038817913702</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">erf</span><span class="p">(</span> <span class="n">sqrt_a</span> <span class="p">)</span> <span class="o">-</span> <span class="n">sqrt_a</span> <span class="o">*</span> <span class="p">(</span> <span class="mf">1.5</span> <span class="o">+</span> <span class="n">a</span> <span class="p">)</span> <span class="o">*</span> <span class="n">exp_a</span> <span class="p">)</span> <span class="o">/</span> <span class="p">(</span> <span class="mf">1.</span> <span class="o">-</span> <span class="p">(</span> <span class="mf">1.</span> <span class="o">+</span> <span class="n">a</span> <span class="p">)</span> <span class="o">*</span> <span class="n">exp_a</span> <span class="p">)</span> <span class="p">)</span></div>

<div class="viewcode-block" id="Evaporation.toPointwise_withLinearXYs"><a class="viewcode-back" href="../../../../fudge/fudge.productData.distributions.html#fudge.productData.distributions.energy.Evaporation.toPointwise_withLinearXYs">[docs]</a>    <span class="k">def</span> <span class="nf">toPointwise_withLinearXYs</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span> <span class="p">)</span> <span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a pointwise represent of *self*.</span>

<span class="sd">        :param kwargs:              A dictionary that contains data to control the way this method acts.</span>

<span class="sd">        :return:                    An :py:class:`XYs2d` instance.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">def</span> <span class="nf">evaluateAtX</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">x</span> <span class="p">)</span> <span class="p">:</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            A function needed by :py:func:`EnergyFunctionalDataToPointwise` to evaluate an evaporation </span>
<span class="sd">            distribution at the outgoing particle energy *x* for :math:`\theta(x)` = self.p1.</span>

<span class="sd">            :param x:       The energy of the outgoing particle.</span>

<span class="sd">            :return:        Python float.</span>
<span class="sd">            &quot;&quot;&quot;</span>


            <span class="k">return</span><span class="p">(</span> <span class="n">x</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span> <span class="o">-</span><span class="n">x</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">p1</span> <span class="p">)</span> <span class="p">)</span>

        <span class="n">ef</span> <span class="o">=</span> <span class="n">EnergyFunctionalDataToPointwise</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">evaluateAtX</span> <span class="p">)</span>
        <span class="k">return</span><span class="p">(</span> <span class="n">ef</span><span class="o">.</span><span class="n">toPointwise_withLinearXYs</span><span class="p">(</span> <span class="o">**</span><span class="n">kwargs</span> <span class="p">)</span> <span class="p">)</span></div>

<div class="viewcode-block" id="Evaporation.parseNodeUsingClass"><a class="viewcode-back" href="../../../../fudge/fudge.productData.distributions.html#fudge.productData.distributions.energy.Evaporation.parseNodeUsingClass">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">parseNodeUsingClass</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">evapElement</span><span class="p">,</span> <span class="n">xPath</span><span class="p">,</span> <span class="n">linkData</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Parse *evapElement* into an instance of *cls*.</span>

<span class="sd">        :param cls:         Form class to return.</span>
<span class="sd">        :param evapElement: Node to parse.</span>
<span class="sd">        :param xPath:       List containing xPath to current node, useful mostly for debugging.</span>
<span class="sd">        :param linkData:    dict that collects unresolved links.</span>
<span class="sd">        :param kwargs:      A dictionary of extra arguments that controls how *self* is converted to a list of XML strings.</span>

<span class="sd">        :return: an instance of *cls* representing *evapElement*.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">xPath</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="n">evapElement</span><span class="o">.</span><span class="n">tag</span> <span class="p">)</span>
        <span class="n">theta_</span> <span class="o">=</span> <span class="n">Theta</span><span class="o">.</span><span class="n">parseNodeUsingClass</span><span class="p">(</span><span class="n">evapElement</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">Theta</span><span class="o">.</span><span class="n">moniker</span><span class="p">),</span> <span class="n">xPath</span><span class="p">,</span> <span class="n">linkData</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">U</span> <span class="o">=</span> <span class="n">physicalQuantityModule</span><span class="o">.</span><span class="n">U</span><span class="o">.</span><span class="n">parseNodeUsingClass</span><span class="p">(</span><span class="n">evapElement</span><span class="o">.</span><span class="n">find</span><span class="p">(</span> <span class="s1">&#39;U&#39;</span> <span class="p">),</span> <span class="n">xPath</span><span class="p">,</span> <span class="n">linkData</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">ES</span> <span class="o">=</span> <span class="n">Evaporation</span><span class="p">(</span> <span class="n">U</span><span class="p">,</span> <span class="n">theta_</span> <span class="p">)</span>
        <span class="n">xPath</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">ES</span></div></div>

<div class="viewcode-block" id="Watt"><a class="viewcode-back" href="../../../../fudge/fudge.productData.distributions.html#fudge.productData.distributions.energy.Watt">[docs]</a><span class="k">class</span> <span class="nc">Watt</span><span class="p">(</span> <span class="n">FunctionalBase</span> <span class="p">)</span> <span class="p">:</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Class for storing the 2d Watt energy distribution. The distribution is of the form</span>
<span class="sd">    :math:`E&#39; \, \exp(-E&#39;/a(E)) \, \sinh(\sqrt{b(E) \, E&#39;})/ I` where :math:`a(E)` and :math:`b(E)`</span>
<span class="sd">    are 1d function of the projectile energy :math:`E`.</span>

<span class="sd">    The following table list the primary members of this class:</span>
<span class="sd">    </span>
<span class="sd">    +---------------+-------------------------------------------------------------------+</span>
<span class="sd">    | Member        | Description                                                       |</span>
<span class="sd">    +===============+===================================================================+</span>
<span class="sd">    | U             | Constant that defines the upper energy limit for the              |</span>
<span class="sd">    |               | secondary particle so that 0  E&#39;  E - U.                        |</span>
<span class="sd">    +---------------+-------------------------------------------------------------------+</span>
<span class="sd">    | a             | The :math:`a(E)` function.                                        |</span>
<span class="sd">    +---------------+-------------------------------------------------------------------+</span>
<span class="sd">    | b             | The :math:`b(E)` function.                                        |</span>
<span class="sd">    +---------------+-------------------------------------------------------------------+</span>

<span class="sd">    :param U:               Constant that defines the upper energy limit for the secondary particle so that 0  E&#39;  E - U.</span>
<span class="sd">                            This is not used/needed so should be removed.</span>
<span class="sd">    :param a:               The :math:`a(E)` function.</span>
<span class="sd">    :param b:               The :math:`b(E)` function.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">moniker</span> <span class="o">=</span> <span class="s1">&#39;evaporation&#39;</span>

    <span class="n">moniker</span> <span class="o">=</span> <span class="s1">&#39;Watt&#39;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">U</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="p">)</span> <span class="p">:</span>

        <span class="n">FunctionalBase</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="n">U</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="p">)</span>

<div class="viewcode-block" id="Watt.averageEp"><a class="viewcode-back" href="../../../../fudge/fudge.productData.distributions.html#fudge.productData.distributions.energy.Watt.averageEp">[docs]</a>    <span class="k">def</span> <span class="nf">averageEp</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">E</span> <span class="p">)</span> <span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calculated the average energy of the outgoing photon at projectile energy *E*.</span>

<span class="sd">        :param E:       The energy of the projectile energy.</span>

<span class="sd">        :return:                Python float.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameter1</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span> <span class="n">E</span> <span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameter2</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span> <span class="n">E</span> <span class="p">)</span>
        <span class="n">domainMax_a</span>  <span class="o">=</span> <span class="p">(</span> <span class="n">E</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">U</span><span class="o">.</span><span class="n">value</span> <span class="p">)</span> <span class="o">/</span> <span class="n">a</span>
        <span class="n">domainMax_b</span>  <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span> <span class="n">b</span> <span class="o">*</span> <span class="p">(</span> <span class="n">E</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">U</span><span class="o">.</span><span class="n">value</span> <span class="p">)</span> <span class="p">)</span>
        <span class="n">ab</span> <span class="o">=</span> <span class="n">a</span> <span class="o">*</span> <span class="n">b</span>
        <span class="n">sqrt_ab</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span> <span class="n">ab</span> <span class="p">)</span>
        <span class="n">I</span> <span class="o">=</span> <span class="mf">0.25</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span> <span class="n">math</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">ab</span> <span class="p">)</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span> <span class="mf">0.25</span> <span class="o">*</span> <span class="n">ab</span> <span class="p">)</span> <span class="o">*</span> \
            <span class="p">(</span> <span class="n">math</span><span class="o">.</span><span class="n">erf</span><span class="p">(</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span> <span class="n">domainMax_a</span> <span class="p">)</span> <span class="o">-</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">sqrt_ab</span> <span class="p">)</span> <span class="o">+</span> <span class="n">math</span><span class="o">.</span><span class="n">erf</span><span class="p">(</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span> <span class="n">domainMax_a</span> <span class="p">)</span> <span class="o">+</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">sqrt_ab</span> <span class="p">)</span> <span class="p">)</span> \
            <span class="o">-</span> <span class="n">math</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span> <span class="o">-</span><span class="n">domainMax_a</span> <span class="p">)</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">sinh</span><span class="p">(</span> <span class="n">domainMax_b</span> <span class="p">)</span>
        <span class="n">EI</span> <span class="o">=</span> <span class="n">a</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span> <span class="n">math</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">ab</span> <span class="p">)</span> <span class="o">*</span> <span class="p">(</span> <span class="n">ab</span> <span class="o">+</span> <span class="mi">6</span> <span class="p">)</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span> <span class="mf">0.25</span> <span class="o">*</span> <span class="n">ab</span> <span class="p">)</span> <span class="o">*</span> \
            <span class="p">(</span> <span class="n">math</span><span class="o">.</span><span class="n">erf</span><span class="p">(</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span> <span class="n">domainMax_a</span> <span class="p">)</span> <span class="o">-</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">sqrt_ab</span> <span class="p">)</span> <span class="o">+</span> <span class="n">math</span><span class="o">.</span><span class="n">erf</span><span class="p">(</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span> <span class="n">domainMax_a</span> <span class="p">)</span> <span class="o">+</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">sqrt_ab</span> <span class="p">)</span> <span class="p">)</span> \
            <span class="o">-</span> <span class="mf">0.25</span> <span class="o">*</span> <span class="n">a</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span> <span class="o">-</span><span class="n">domainMax_a</span> <span class="p">)</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">sinh</span><span class="p">(</span> <span class="n">domainMax_b</span> <span class="p">)</span> <span class="o">*</span> <span class="p">(</span> <span class="mf">2.</span> <span class="o">*</span> <span class="n">domainMax_b</span> <span class="o">+</span> <span class="n">ab</span> <span class="o">+</span> <span class="mf">4.</span> <span class="o">+</span> <span class="mf">4.</span> <span class="o">*</span> <span class="n">domainMax_a</span> <span class="p">)</span>
        <span class="k">return</span><span class="p">(</span> <span class="n">EI</span> <span class="o">/</span> <span class="p">(</span> <span class="mi">16</span> <span class="o">*</span> <span class="n">I</span> <span class="p">)</span> <span class="p">)</span></div>

<div class="viewcode-block" id="Watt.energySpectrumAtEnergy"><a class="viewcode-back" href="../../../../fudge/fudge.productData.distributions.html#fudge.productData.distributions.energy.Watt.energySpectrumAtEnergy">[docs]</a>    <span class="k">def</span> <span class="nf">energySpectrumAtEnergy</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">energyIn</span> <span class="p">)</span> <span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calculates the outgoing particle&#39;s energy spectrum at projectile energy *energyIn*,</span>

<span class="sd">        :param energyIn:            Energy of the projectile.</span>

<span class="sd">        :return:                    XYs1d instance for the energy spectrum.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span> <span class="n">energyIn</span> <span class="p">)</span> <span class="p">)</span></div>

<div class="viewcode-block" id="Watt.evaluate"><a class="viewcode-back" href="../../../../fudge/fudge.productData.distributions.html#fudge.productData.distributions.energy.Watt.evaluate">[docs]</a>    <span class="k">def</span> <span class="nf">evaluate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">energyIn</span><span class="p">,</span> <span class="n">extrapolation</span><span class="o">=</span><span class="n">xDataEnumsModule</span><span class="o">.</span><span class="n">Extrapolation</span><span class="o">.</span><span class="n">none</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This method returns a 1d function of *self* evaluated at projectile energy *energyIn*.</span>

<span class="sd">        :param energyIn:        The projectile energy to evaluate *self* at.</span>
<span class="sd">        :param extrapolation:   This argument is not used.</span>

<span class="sd">        :return:                Instance of :py:class:`XYs1d`.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">def</span> <span class="nf">A</span><span class="p">(</span> <span class="n">energyOut</span><span class="p">,</span> <span class="n">parameters</span> <span class="p">)</span> <span class="p">:</span>

            <span class="n">a_parameter</span><span class="p">,</span> <span class="n">b_parameter</span> <span class="o">=</span> <span class="n">parameters</span>
            <span class="k">return</span><span class="p">(</span> <span class="n">math</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span> <span class="o">-</span><span class="n">energyOut</span> <span class="o">/</span> <span class="n">a_parameter</span> <span class="p">)</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">sinh</span><span class="p">(</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span> <span class="n">b_parameter</span> <span class="o">*</span> <span class="n">energyOut</span> <span class="p">)</span> <span class="p">)</span> <span class="p">)</span>

        <span class="n">energyUnit</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameter1</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">domainUnit</span>
        <span class="n">energyOut</span> <span class="o">=</span> <span class="n">PQUModule</span><span class="o">.</span><span class="n">PQU</span><span class="p">(</span> <span class="mf">1e-8</span><span class="p">,</span> <span class="s1">&#39;MeV&#39;</span> <span class="p">)</span><span class="o">.</span><span class="n">getValueAs</span><span class="p">(</span> <span class="n">energyUnit</span> <span class="p">)</span>
        <span class="n">energyOutMax</span> <span class="o">=</span> <span class="n">energyIn</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">U</span><span class="o">.</span><span class="n">value</span>
        <span class="n">energyOuts</span> <span class="o">=</span> <span class="p">[</span> <span class="mf">0.0</span> <span class="p">]</span>
        <span class="k">while</span><span class="p">(</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">energyOut</span> <span class="o">&lt;</span> <span class="n">energyOutMax</span> <span class="p">)</span> <span class="p">:</span>
            <span class="n">energyOuts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="n">energyOut</span> <span class="p">)</span>
            <span class="n">energyOut</span> <span class="o">*=</span> <span class="mf">10.0</span>
        <span class="n">energyOuts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="n">energyOutMax</span> <span class="p">)</span>

        <span class="n">a_parameter</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameter1</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span> <span class="n">energyIn</span> <span class="p">)</span>
        <span class="n">b_parameter</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameter2</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span> <span class="n">energyIn</span> <span class="p">)</span>
        <span class="n">xys1d</span> <span class="o">=</span> <span class="n">XYs1d</span><span class="o">.</span><span class="n">createFromFunction</span><span class="p">(</span> <span class="n">defaultAxes</span><span class="p">(</span> <span class="n">energyUnit</span> <span class="o">=</span> <span class="n">energyUnit</span> <span class="p">),</span> <span class="n">energyOuts</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="p">[</span> <span class="n">a_parameter</span><span class="p">,</span> <span class="n">b_parameter</span> <span class="p">],</span> <span class="mf">1e-3</span><span class="p">,</span> <span class="mi">10</span> <span class="p">)</span>

        <span class="n">xys1d</span><span class="o">.</span><span class="n">outerDomainValue</span> <span class="o">=</span> <span class="n">energyIn</span>
        <span class="n">xys1d</span><span class="o">.</span><span class="n">normalize</span><span class="p">(</span> <span class="n">insitu</span> <span class="o">=</span> <span class="kc">True</span> <span class="p">)</span>

        <span class="k">return</span><span class="p">(</span> <span class="n">xys1d</span> <span class="p">)</span></div>

<div class="viewcode-block" id="Watt.getEnergyArray"><a class="viewcode-back" href="../../../../fudge/fudge.productData.distributions.html#fudge.productData.distributions.energy.Watt.getEnergyArray">[docs]</a>    <span class="k">def</span> <span class="nf">getEnergyArray</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">EMin</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">EMax</span> <span class="o">=</span> <span class="kc">None</span> <span class="p">)</span> <span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This method returns the list of projectile energies that *self* is specific at.</span>

<span class="sd">        :parem EMin:        If *self* does not have an projectile energy values, the default minimum energy to return.</span>
<span class="sd">        :parem EMax:        If *self* does not have an projectile energy values, the default maximum energy to return.</span>

<span class="sd">        :return:            Python list of float.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">aMin</span><span class="p">,</span> <span class="n">aMax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameter1</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">domainMin</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameter1</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">domainMax</span>
        <span class="k">if</span><span class="p">(</span> <span class="n">EMin</span> <span class="ow">is</span> <span class="kc">None</span> <span class="p">)</span> <span class="p">:</span> <span class="n">EMin</span> <span class="o">=</span> <span class="n">aMin</span>
        <span class="k">if</span><span class="p">(</span> <span class="n">EMax</span> <span class="ow">is</span> <span class="kc">None</span> <span class="p">)</span> <span class="p">:</span> <span class="n">EMax</span> <span class="o">=</span> <span class="n">aMax</span>
        <span class="k">if</span><span class="p">(</span> <span class="n">EMin</span> <span class="o">&lt;</span> <span class="n">aMin</span> <span class="p">)</span> <span class="p">:</span> <span class="n">EMin</span> <span class="o">=</span> <span class="n">aMin</span>
        <span class="k">if</span><span class="p">(</span> <span class="n">EMax</span> <span class="o">&lt;</span> <span class="n">aMax</span> <span class="p">)</span> <span class="p">:</span> <span class="n">EMax</span> <span class="o">=</span> <span class="n">aMax</span>
        <span class="n">Es</span> <span class="o">=</span> <span class="p">[</span> <span class="n">EMin</span><span class="p">,</span> <span class="n">EMax</span> <span class="p">]</span>
        <span class="k">for</span> <span class="n">E</span><span class="p">,</span> <span class="n">a</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameter1</span><span class="o">.</span><span class="n">data</span> <span class="p">:</span>
            <span class="k">if</span><span class="p">(</span> <span class="n">E</span> <span class="o">&lt;=</span> <span class="n">EMin</span> <span class="p">)</span> <span class="p">:</span> <span class="k">continue</span>
            <span class="k">if</span><span class="p">(</span> <span class="n">E</span> <span class="o">&gt;=</span> <span class="n">EMax</span> <span class="p">)</span> <span class="p">:</span> <span class="k">continue</span>
            <span class="k">if</span><span class="p">(</span> <span class="n">E</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">Es</span> <span class="p">)</span> <span class="p">:</span> <span class="n">Es</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="n">E</span> <span class="p">)</span>
        <span class="k">for</span> <span class="n">E</span><span class="p">,</span> <span class="n">b</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameter2</span><span class="o">.</span><span class="n">data</span> <span class="p">:</span>
            <span class="k">if</span><span class="p">(</span> <span class="n">E</span> <span class="o">&lt;=</span> <span class="n">EMin</span> <span class="p">)</span> <span class="p">:</span> <span class="k">continue</span>
            <span class="k">if</span><span class="p">(</span> <span class="n">E</span> <span class="o">&gt;=</span> <span class="n">EMax</span> <span class="p">)</span> <span class="p">:</span> <span class="k">continue</span>
            <span class="k">if</span><span class="p">(</span> <span class="n">E</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">Es</span> <span class="p">)</span> <span class="p">:</span> <span class="n">Es</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="n">E</span> <span class="p">)</span>
        <span class="n">Es</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span> <span class="p">)</span>
        <span class="k">return</span><span class="p">(</span> <span class="n">Es</span> <span class="p">)</span></div>

<div class="viewcode-block" id="Watt.toPointwise_withLinearXYs"><a class="viewcode-back" href="../../../../fudge/fudge.productData.distributions.html#fudge.productData.distributions.energy.Watt.toPointwise_withLinearXYs">[docs]</a>    <span class="k">def</span> <span class="nf">toPointwise_withLinearXYs</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span> <span class="p">)</span> <span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a pointwise represent of *self*.</span>

<span class="sd">        :param kwargs:              A dictionary that contains data to control the way this method acts.</span>

<span class="sd">        :return:                    An :py:class:`XYs2d` instance.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">def</span> <span class="nf">evaluateAtX</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">x</span> <span class="p">)</span> <span class="p">:</span>
<span class="w">            </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            A function needed by :py:func:`EnergyFunctionalDataToPointwise` to evaluate a Watt distribution</span>
<span class="sd">            distribution at the outgoing particle energy *x* for :math:`\A(E)` = self.p1 and :math:`\B(E)` = self.p2.</span>

<span class="sd">            :param x:       The energy of the outgoing particle.</span>

<span class="sd">            :return:        Python float.</span>
<span class="sd">            &quot;&quot;&quot;</span>


            <span class="k">return</span><span class="p">(</span> <span class="n">math</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span> <span class="o">-</span><span class="n">x</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">p1</span> <span class="p">)</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">sinh</span><span class="p">(</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">p2</span> <span class="o">*</span> <span class="n">x</span> <span class="p">)</span> <span class="p">)</span> <span class="p">)</span>

        <span class="n">ef</span> <span class="o">=</span> <span class="n">EnergyFunctionalDataToPointwise</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">evaluateAtX</span> <span class="p">)</span>
        <span class="k">return</span><span class="p">(</span> <span class="n">ef</span><span class="o">.</span><span class="n">toPointwise_withLinearXYs</span><span class="p">(</span> <span class="o">**</span><span class="n">kwargs</span> <span class="p">)</span> <span class="p">)</span></div>

<div class="viewcode-block" id="Watt.parseNodeUsingClass"><a class="viewcode-back" href="../../../../fudge/fudge.productData.distributions.html#fudge.productData.distributions.energy.Watt.parseNodeUsingClass">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">parseNodeUsingClass</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">WattElement</span><span class="p">,</span> <span class="n">xPath</span><span class="p">,</span> <span class="n">linkData</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Parse *WattElement* into an instance of *cls*.</span>

<span class="sd">        :param cls:         Form class to return.</span>
<span class="sd">        :param WattElement: Node to parse.</span>
<span class="sd">        :param xPath:       List containing xPath to current node, useful mostly for debugging.</span>
<span class="sd">        :param linkData:    dict that collects unresolved links.</span>
<span class="sd">        :param kwargs:      A dictionary of extra arguments that controls how *self* is converted to a list of XML strings.</span>

<span class="sd">        :return: an instance of *cls* representing *WattElement*.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">xPath</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="n">WattElement</span><span class="o">.</span><span class="n">tag</span> <span class="p">)</span>
        <span class="n">_a</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">parseNodeUsingClass</span><span class="p">(</span><span class="n">WattElement</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">A</span><span class="o">.</span><span class="n">moniker</span><span class="p">),</span> <span class="n">xPath</span><span class="p">,</span> <span class="n">linkData</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">_b</span> <span class="o">=</span> <span class="n">B</span><span class="o">.</span><span class="n">parseNodeUsingClass</span><span class="p">(</span><span class="n">WattElement</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">B</span><span class="o">.</span><span class="n">moniker</span><span class="p">),</span> <span class="n">xPath</span><span class="p">,</span> <span class="n">linkData</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">U</span> <span class="o">=</span> <span class="n">physicalQuantityModule</span><span class="o">.</span><span class="n">U</span><span class="o">.</span><span class="n">parseNodeUsingClass</span><span class="p">(</span><span class="n">WattElement</span><span class="o">.</span><span class="n">find</span><span class="p">(</span> <span class="s1">&#39;U&#39;</span> <span class="p">),</span> <span class="n">xPath</span><span class="p">,</span> <span class="n">linkData</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">WS</span> <span class="o">=</span> <span class="bp">cls</span><span class="p">(</span> <span class="n">U</span><span class="p">,</span> <span class="n">_a</span><span class="p">,</span> <span class="n">_b</span> <span class="p">)</span>
        <span class="n">xPath</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">WS</span></div></div>

<div class="viewcode-block" id="MadlandNix"><a class="viewcode-back" href="../../../../fudge/fudge.productData.distributions.html#fudge.productData.distributions.energy.MadlandNix">[docs]</a><span class="k">class</span> <span class="nc">MadlandNix</span><span class="p">(</span> <span class="n">FunctionalBase</span> <span class="p">)</span> <span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Class for storing the 2d Madland/Nix energy distribution.</span>

<span class="sd">    The following table list the primary members of this class:</span>
<span class="sd">    </span>
<span class="sd">    +---------------+-------------------------------------------------------------------+</span>
<span class="sd">    | Member        | Description                                                       |</span>
<span class="sd">    +===============+===================================================================+</span>
<span class="sd">    | EFL           | Average kinetic energy per nucleon of the light fission fragment. |</span>
<span class="sd">    +---------------+-------------------------------------------------------------------+</span>
<span class="sd">    | EFH           | Average kinetic energy per nucleon of the heavy fission fragment. |</span>
<span class="sd">    +---------------+-------------------------------------------------------------------+</span>
<span class="sd">    | Ts            | The :math:`T_M(E)` function.                                      |</span>
<span class="sd">    +---------------+-------------------------------------------------------------------+</span>

<span class="sd">    :param EFL:             Average kinetic energy per nucleon of the light fission fragment.</span>
<span class="sd">    :param EFH:             Average kinetic energy per nucleon of the heavy fission fragment.</span>
<span class="sd">    :param Ts:              The :math:`T_M(E)` function.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">moniker</span> <span class="o">=</span> <span class="s1">&#39;MadlandNix&#39;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">EFL</span><span class="p">,</span> <span class="n">EFH</span><span class="p">,</span> <span class="n">Ts</span> <span class="p">)</span> <span class="p">:</span>

        <span class="n">FunctionalBase</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="n">Ts</span> <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">EFL</span> <span class="o">=</span> <span class="n">EFL</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">EFH</span> <span class="o">=</span> <span class="n">EFH</span>

<div class="viewcode-block" id="MadlandNix.copy"><a class="viewcode-back" href="../../../../fudge/fudge.productData.distributions.html#fudge.productData.distributions.energy.MadlandNix.copy">[docs]</a>    <span class="k">def</span> <span class="nf">copy</span><span class="p">(</span> <span class="bp">self</span> <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a copy of *self*.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="n">MadlandNix</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">EFL</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span> <span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">EFH</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span> <span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameter1</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span> <span class="p">)</span> <span class="p">)</span></div>

    <span class="n">__copy__</span> <span class="o">=</span> <span class="n">copy</span>

<div class="viewcode-block" id="MadlandNix.check"><a class="viewcode-back" href="../../../../fudge/fudge.productData.distributions.html#fudge.productData.distributions.energy.MadlandNix.check">[docs]</a>    <span class="k">def</span> <span class="nf">check</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">info</span> <span class="p">)</span> <span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Does a check of *self*&#39;s data.</span>

<span class="sd">        :param info:        A dictionary with parameters used for determining if a difference is relevant.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="kn">from</span> <span class="nn">fudge</span> <span class="kn">import</span> <span class="n">warning</span>

        <span class="n">warnings</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">EFL</span><span class="o">.</span><span class="n">value</span> <span class="o">&lt;=</span> <span class="mi">0</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">EFH</span><span class="o">.</span><span class="n">value</span> <span class="o">&lt;=</span> <span class="mi">0</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameter1</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">rangeMin</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="n">warning</span><span class="o">.</span><span class="n">MadlandNixBadParameters</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">EFL</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">EFH</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameter1</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">rangeMin</span><span class="p">,</span> <span class="bp">self</span> <span class="p">)</span> <span class="p">)</span>

        <span class="k">return</span> <span class="n">warnings</span></div>

<div class="viewcode-block" id="MadlandNix.averageEp"><a class="viewcode-back" href="../../../../fudge/fudge.productData.distributions.html#fudge.productData.distributions.energy.MadlandNix.averageEp">[docs]</a>    <span class="k">def</span> <span class="nf">averageEp</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">E</span> <span class="p">)</span> <span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calculated the average energy of the outgoing photon at projectile energy *E*.</span>

<span class="sd">        :param E:       The energy of the projectile energy.</span>

<span class="sd">        :return:                Python float.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">unit</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameter1</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">axes</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">unit</span>
        <span class="k">return</span><span class="p">(</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">EFL</span><span class="o">.</span><span class="n">getValueAs</span><span class="p">(</span> <span class="n">unit</span> <span class="p">)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">EFH</span><span class="o">.</span><span class="n">getValueAs</span><span class="p">(</span> <span class="n">unit</span> <span class="p">)</span> <span class="p">)</span> <span class="o">+</span> <span class="mf">4.</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameter1</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span> <span class="n">E</span> <span class="p">)</span> <span class="o">/</span> <span class="mf">3.</span> <span class="p">)</span></div>

<div class="viewcode-block" id="MadlandNix.convertUnits"><a class="viewcode-back" href="../../../../fudge/fudge.productData.distributions.html#fudge.productData.distributions.energy.MadlandNix.convertUnits">[docs]</a>    <span class="k">def</span> <span class="nf">convertUnits</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">unitMap</span> <span class="p">)</span> <span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Converts all data in *self* per *unitMap*.</span>

<span class="sd">        :param unitMap:     A dictionary in which each key is a unit that will be replaced by its value which must be an equivalent unit.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">FunctionalBase</span><span class="o">.</span><span class="n">convertUnits</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">unitMap</span> <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">EFL</span><span class="o">.</span><span class="n">convertUnits</span><span class="p">(</span> <span class="n">unitMap</span> <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">EFH</span><span class="o">.</span><span class="n">convertUnits</span><span class="p">(</span> <span class="n">unitMap</span> <span class="p">)</span></div>

<div class="viewcode-block" id="MadlandNix.energySpectrumAtEnergy"><a class="viewcode-back" href="../../../../fudge/fudge.productData.distributions.html#fudge.productData.distributions.energy.MadlandNix.energySpectrumAtEnergy">[docs]</a>    <span class="k">def</span> <span class="nf">energySpectrumAtEnergy</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">energyIn</span> <span class="p">)</span> <span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calculates the outgoing particle&#39;s energy spectrum at projectile energy *energyIn*,</span>

<span class="sd">        :param energyIn:            Energy of the projectile.</span>

<span class="sd">        :return:                    XYs1d instance for the energy spectrum.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span> <span class="n">energyIn</span> <span class="p">)</span> <span class="p">)</span></div>

<div class="viewcode-block" id="MadlandNix.evaluate"><a class="viewcode-back" href="../../../../fudge/fudge.productData.distributions.html#fudge.productData.distributions.energy.MadlandNix.evaluate">[docs]</a>    <span class="k">def</span> <span class="nf">evaluate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">energyIn</span><span class="p">,</span> <span class="n">extrapolation</span><span class="o">=</span><span class="n">xDataEnumsModule</span><span class="o">.</span><span class="n">Extrapolation</span><span class="o">.</span><span class="n">none</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This method returns a 1d function of *self* evaluated at projectile energy *energyIn*.</span>

<span class="sd">        :param energyIn:        The projectile energy to evaluate *self* at.</span>
<span class="sd">        :param extrapolation:   This argument is not used.</span>

<span class="sd">        :return:                Instance of :py:class:`XYs1d`.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="kn">from</span> <span class="nn">numericalFunctions</span> <span class="kn">import</span> <span class="n">specialFunctions</span>

        <span class="k">def</span> <span class="nf">MadlandNixFunc</span><span class="p">(</span> <span class="n">Ep</span><span class="p">,</span> <span class="n">parameters</span> <span class="p">)</span> <span class="p">:</span>

            <span class="k">def</span> <span class="nf">g</span><span class="p">(</span> <span class="n">Ep</span><span class="p">,</span> <span class="n">E_F</span><span class="p">,</span> <span class="n">T_M</span> <span class="p">)</span> <span class="p">:</span>

                <span class="n">u1</span> <span class="o">=</span> <span class="p">(</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span> <span class="n">Ep</span> <span class="p">)</span> <span class="o">-</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span> <span class="n">E_F</span> <span class="p">)</span> <span class="p">)</span>
                <span class="n">u1</span> <span class="o">*=</span> <span class="n">u1</span> <span class="o">/</span> <span class="n">T_M</span>
                <span class="n">u2</span> <span class="o">=</span> <span class="p">(</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span> <span class="n">Ep</span> <span class="p">)</span> <span class="o">+</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span> <span class="n">E_F</span> <span class="p">)</span> <span class="p">)</span>
                <span class="n">u2</span> <span class="o">*=</span> <span class="n">u2</span> <span class="o">/</span> <span class="n">T_M</span>
                <span class="n">E1</span> <span class="o">=</span> <span class="mi">0</span>                      <span class="c1"># u1^3/2 * E1 is zero for u1 = 0. but E1 is infinity, whence, the next test.</span>
                <span class="k">if</span><span class="p">(</span> <span class="n">u1</span> <span class="o">!=</span> <span class="mi">0</span> <span class="p">)</span> <span class="p">:</span> <span class="n">E1</span> <span class="o">=</span> <span class="n">specialFunctions</span><span class="o">.</span><span class="n">exponentialIntegral</span><span class="p">(</span> <span class="mi">1</span><span class="p">,</span> <span class="n">u1</span> <span class="p">)</span>
                <span class="n">E2</span> <span class="o">=</span> <span class="n">specialFunctions</span><span class="o">.</span><span class="n">exponentialIntegral</span><span class="p">(</span> <span class="mi">1</span><span class="p">,</span> <span class="n">u2</span> <span class="p">)</span>
                <span class="n">complementary</span> <span class="o">=</span> <span class="p">(</span> <span class="n">u1</span> <span class="o">&gt;</span> <span class="mf">2.</span> <span class="p">)</span>
                <span class="n">gamma1</span> <span class="o">=</span> <span class="n">specialFunctions</span><span class="o">.</span><span class="n">incompleteGamma</span><span class="p">(</span> <span class="mf">1.5</span><span class="p">,</span> <span class="n">u1</span><span class="p">,</span> <span class="n">complementary</span> <span class="p">)</span>
                <span class="n">gamma2</span> <span class="o">=</span> <span class="n">specialFunctions</span><span class="o">.</span><span class="n">incompleteGamma</span><span class="p">(</span> <span class="mf">1.5</span><span class="p">,</span> <span class="n">u2</span><span class="p">,</span> <span class="n">complementary</span> <span class="p">)</span>
                <span class="n">signG</span> <span class="o">=</span> <span class="mi">1</span>
                <span class="k">if</span><span class="p">(</span> <span class="n">complementary</span> <span class="p">)</span> <span class="p">:</span> <span class="n">signG</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
                <span class="k">return</span><span class="p">(</span> <span class="p">(</span> <span class="n">u2</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span> <span class="n">u2</span> <span class="p">)</span> <span class="o">*</span> <span class="n">E2</span> <span class="o">-</span> <span class="n">u1</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span> <span class="n">u1</span> <span class="p">)</span> <span class="o">*</span> <span class="n">E1</span> <span class="o">+</span> <span class="n">signG</span> <span class="o">*</span> <span class="p">(</span> <span class="n">gamma2</span> <span class="o">-</span> <span class="n">gamma1</span> <span class="p">)</span> <span class="p">)</span> <span class="o">/</span> <span class="p">(</span> <span class="mi">3</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span> <span class="n">E_F</span> <span class="o">*</span> <span class="n">T_M</span> <span class="p">)</span> <span class="p">)</span> <span class="p">)</span>

            <span class="n">EFL</span><span class="p">,</span> <span class="n">EFH</span><span class="p">,</span> <span class="n">T_M</span> <span class="o">=</span> <span class="n">parameters</span>
            <span class="k">return</span><span class="p">(</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="p">(</span> <span class="n">g</span><span class="p">(</span> <span class="n">Ep</span><span class="p">,</span> <span class="n">EFL</span><span class="p">,</span> <span class="n">T_M</span> <span class="p">)</span> <span class="o">+</span> <span class="n">g</span><span class="p">(</span> <span class="n">Ep</span><span class="p">,</span> <span class="n">EFH</span><span class="p">,</span> <span class="n">T_M</span> <span class="p">)</span> <span class="p">)</span> <span class="p">)</span>

        <span class="n">energyUnit</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameter1</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">domainUnit</span>

        <span class="n">energyOut</span> <span class="o">=</span> <span class="n">PQUModule</span><span class="o">.</span><span class="n">PQU</span><span class="p">(</span> <span class="mf">1e-8</span><span class="p">,</span> <span class="s1">&#39;MeV&#39;</span> <span class="p">)</span><span class="o">.</span><span class="n">getValueAs</span><span class="p">(</span> <span class="n">energyUnit</span> <span class="p">)</span>
        <span class="n">energyOutMax</span> <span class="o">=</span> <span class="n">PQUModule</span><span class="o">.</span><span class="n">PQU</span><span class="p">(</span> <span class="mf">40.0</span><span class="p">,</span> <span class="s1">&#39;MeV&#39;</span> <span class="p">)</span><span class="o">.</span><span class="n">getValueAs</span><span class="p">(</span> <span class="n">energyUnit</span> <span class="p">)</span>
        <span class="n">energyOuts</span> <span class="o">=</span> <span class="p">[</span> <span class="mf">0.0</span> <span class="p">]</span>
        <span class="k">while</span><span class="p">(</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">energyOut</span> <span class="o">&lt;</span> <span class="n">energyOutMax</span> <span class="p">)</span> <span class="p">:</span>
            <span class="n">energyOuts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="n">energyOut</span> <span class="p">)</span>
            <span class="n">energyOut</span> <span class="o">*=</span> <span class="mf">10.0</span>
        <span class="n">energyOuts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="n">energyOutMax</span> <span class="p">)</span>

        <span class="n">EFL</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">EFL</span><span class="o">.</span><span class="n">getValueAs</span><span class="p">(</span> <span class="n">energyUnit</span> <span class="p">)</span>
        <span class="n">EFH</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">EFH</span><span class="o">.</span><span class="n">getValueAs</span><span class="p">(</span> <span class="n">energyUnit</span> <span class="p">)</span>
        <span class="n">T_M</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameter1</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span> <span class="n">energyIn</span> <span class="p">)</span>
        <span class="n">parameters</span> <span class="o">=</span> <span class="p">[</span> <span class="n">EFL</span><span class="p">,</span> <span class="n">EFH</span><span class="p">,</span> <span class="n">T_M</span> <span class="p">]</span>
        <span class="n">xys1d</span> <span class="o">=</span> <span class="n">XYs1d</span><span class="o">.</span><span class="n">createFromFunction</span><span class="p">(</span> <span class="n">defaultAxes</span><span class="p">(</span> <span class="n">energyUnit</span> <span class="o">=</span> <span class="n">energyUnit</span> <span class="p">),</span> <span class="n">energyOuts</span><span class="p">,</span> <span class="n">MadlandNixFunc</span><span class="p">,</span> <span class="n">parameters</span><span class="p">,</span> <span class="mf">1e-3</span><span class="p">,</span> <span class="mi">10</span> <span class="p">)</span>

        <span class="n">xys1d</span><span class="o">.</span><span class="n">outerDomainValue</span> <span class="o">=</span> <span class="n">energyIn</span>
        <span class="n">xys1d</span><span class="o">.</span><span class="n">normalize</span><span class="p">(</span> <span class="n">insitu</span> <span class="o">=</span> <span class="kc">True</span> <span class="p">)</span>

        <span class="k">return</span><span class="p">(</span> <span class="n">xys1d</span> <span class="p">)</span></div>

<div class="viewcode-block" id="MadlandNix.getEnergyArray"><a class="viewcode-back" href="../../../../fudge/fudge.productData.distributions.html#fudge.productData.distributions.energy.MadlandNix.getEnergyArray">[docs]</a>    <span class="k">def</span> <span class="nf">getEnergyArray</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">EMin</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">EMax</span> <span class="o">=</span> <span class="kc">None</span> <span class="p">)</span> <span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This method returns the list of projectile energies that *self* is specific at.</span>

<span class="sd">        :parem EMin:        If *self* does not have an projectile energy values, the default minimum energy to return.</span>
<span class="sd">        :parem EMax:        If *self* does not have an projectile energy values, the default maximum energy to return.</span>

<span class="sd">        :return:            Python list of float.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span><span class="p">(</span> <span class="p">[</span> <span class="n">x</span> <span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameter1</span><span class="o">.</span><span class="n">data</span> <span class="p">]</span> <span class="p">)</span></div>

<div class="viewcode-block" id="MadlandNix.toPointwise_withLinearXYs"><a class="viewcode-back" href="../../../../fudge/fudge.productData.distributions.html#fudge.productData.distributions.energy.MadlandNix.toPointwise_withLinearXYs">[docs]</a>    <span class="k">def</span> <span class="nf">toPointwise_withLinearXYs</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span> <span class="p">)</span> <span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a pointwise represent of *self*.</span>

<span class="sd">        :param kwargs:              A dictionary that contains data to control the way this method acts.</span>

<span class="sd">        :return:                    An :py:class:`XYs2d` instance.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">pwl</span> <span class="o">=</span> <span class="n">XYs2d</span><span class="p">(</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">defaultAxes</span><span class="p">(</span> <span class="n">energyUnit</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameter1</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">unit</span> <span class="p">)</span> <span class="p">)</span>
        <span class="k">for</span> <span class="n">E</span><span class="p">,</span> <span class="n">T_M</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameter1</span><span class="o">.</span><span class="n">data</span> <span class="p">:</span>        <span class="c1"># This logic ignores the interpolation of parameter1 as the only two subforms in ENDF/B-VII shows </span>
            <span class="n">pwl</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span> <span class="n">E</span> <span class="p">)</span> <span class="p">)</span>        <span class="c1"># that linear-linear is better than the &#39;log-log&#39; given in the ENDF/B-VII/data.</span>

        <span class="k">return</span><span class="p">(</span> <span class="n">pwl</span> <span class="p">)</span></div>

<div class="viewcode-block" id="MadlandNix.to_xs_pdf_cdf1d"><a class="viewcode-back" href="../../../../fudge/fudge.productData.distributions.html#fudge.productData.distributions.energy.MadlandNix.to_xs_pdf_cdf1d">[docs]</a>    <span class="k">def</span> <span class="nf">to_xs_pdf_cdf1d</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">style</span><span class="p">,</span> <span class="n">tempInfo</span><span class="p">,</span> <span class="n">indent</span> <span class="p">)</span> <span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This method returns a copy of *self* as a :py:class:`XYs2d` representation with the</span>
<span class="sd">        P(E&#39;) data as :py:class:`Xs_pdf_cdf1d` instances.</span>

<span class="sd">        :param style:           The style for the returned data.</span>
<span class="sd">        :param tempInfo:        Dictionary of data needed to calculate the data.</span>
<span class="sd">        :param indent:          The indentation for any verbosity.</span>
<span class="sd">                    </span>
<span class="sd">        :return:                :py:class:`XYs2d`</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">linear</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">toPointwise_withLinearXYs</span><span class="p">(</span> <span class="p">)</span>
        <span class="k">return</span><span class="p">(</span> <span class="n">linear</span><span class="o">.</span><span class="n">to_xs_pdf_cdf1d</span><span class="p">(</span> <span class="n">style</span><span class="p">,</span> <span class="n">tempInfo</span><span class="p">,</span> <span class="n">indent</span> <span class="p">)</span> <span class="p">)</span></div>

<div class="viewcode-block" id="MadlandNix.parseNodeUsingClass"><a class="viewcode-back" href="../../../../fudge/fudge.productData.distributions.html#fudge.productData.distributions.energy.MadlandNix.parseNodeUsingClass">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">parseNodeUsingClass</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">MNelement</span><span class="p">,</span> <span class="n">xPath</span><span class="p">,</span> <span class="n">linkData</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Parse *MNelement* into an instance of *cls*.</span>

<span class="sd">        :param cls:         Form class to return.</span>
<span class="sd">        :param MNelement:   Node to parse.</span>
<span class="sd">        :param xPath:       List containing xPath to current node, useful mostly for debugging.</span>
<span class="sd">        :param linkData:    dict that collects unresolved links.</span>
<span class="sd">        :param kwargs:      A dictionary of extra arguments that controls how *self* is converted to a list of XML strings.</span>

<span class="sd">        :return: an instance of *cls* representing *MNelement*.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">xPath</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="n">MNelement</span><span class="o">.</span><span class="n">tag</span> <span class="p">)</span>
        <span class="n">tm</span> <span class="o">=</span> <span class="n">T_M</span><span class="o">.</span><span class="n">parseNodeUsingClass</span><span class="p">(</span><span class="n">MNelement</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">T_M</span><span class="o">.</span><span class="n">moniker</span><span class="p">),</span> <span class="n">xPath</span><span class="p">,</span> <span class="n">linkData</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">EFL</span> <span class="o">=</span> <span class="n">physicalQuantityModule</span><span class="o">.</span><span class="n">EFL</span><span class="o">.</span><span class="n">parseNodeUsingClass</span><span class="p">(</span><span class="n">MNelement</span><span class="o">.</span><span class="n">find</span><span class="p">(</span> <span class="s2">&quot;EFL&quot;</span> <span class="p">),</span> <span class="n">xPath</span><span class="p">,</span> <span class="n">linkData</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">EFH</span> <span class="o">=</span> <span class="n">physicalQuantityModule</span><span class="o">.</span><span class="n">EFH</span><span class="o">.</span><span class="n">parseNodeUsingClass</span><span class="p">(</span><span class="n">MNelement</span><span class="o">.</span><span class="n">find</span><span class="p">(</span> <span class="s2">&quot;EFH&quot;</span> <span class="p">),</span> <span class="n">xPath</span><span class="p">,</span> <span class="n">linkData</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">MN</span> <span class="o">=</span> <span class="bp">cls</span><span class="p">(</span> <span class="n">EFL</span><span class="p">,</span> <span class="n">EFH</span><span class="p">,</span> <span class="n">tm</span> <span class="p">)</span>
        <span class="n">xPath</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">MN</span></div></div>

<div class="viewcode-block" id="NBodyPhaseSpace"><a class="viewcode-back" href="../../../../fudge/fudge.productData.distributions.html#fudge.productData.distributions.energy.NBodyPhaseSpace">[docs]</a><span class="k">class</span> <span class="nc">NBodyPhaseSpace</span><span class="p">(</span> <span class="n">Subform</span> <span class="p">)</span> <span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Class for storing the 2d N-body phase space energy distribution in the center-of-mass frame.</span>

<span class="sd">    The following table list the primary members of this class:</span>
<span class="sd">    </span>
<span class="sd">    +-------------------+-------------------------------------------------------------------+</span>
<span class="sd">    | Member            | Description                                                       |</span>
<span class="sd">    +===================+===================================================================+</span>
<span class="sd">    | numberOfProducts  | Number of outgoing particles.                                     |</span>
<span class="sd">    +-------------------+-------------------------------------------------------------------+</span>
<span class="sd">    | mass              | Mass of the *numberOfProducts* outgoing particle.                 |</span>
<span class="sd">    +-------------------+-------------------------------------------------------------------+</span>

<span class="sd">    :param numberOfProducts:    Number of outgoing particles.</span>
<span class="sd">    :param mass:                Mass of the *numberOfProducts* outgoing particle.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">moniker</span> <span class="o">=</span> <span class="s1">&#39;NBodyPhaseSpace&#39;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">numberOfProducts</span><span class="p">,</span> <span class="n">mass</span> <span class="p">)</span> <span class="p">:</span>

        <span class="n">Subform</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span> <span class="bp">self</span> <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">numberOfProducts</span> <span class="o">=</span> <span class="n">numberOfProducts</span>
        <span class="k">if</span><span class="p">(</span> <span class="ow">not</span><span class="p">(</span> <span class="nb">isinstance</span><span class="p">(</span> <span class="n">mass</span><span class="p">,</span> <span class="n">physicalQuantityModule</span><span class="o">.</span><span class="n">Mass</span> <span class="p">)</span> <span class="p">)</span> <span class="p">)</span> <span class="p">:</span>
            <span class="ne">TypeError</span><span class="p">(</span> <span class="s1">&#39;mass instance must be a physicalQuantityModule.Mass&#39;</span> <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mass</span> <span class="o">=</span> <span class="n">mass</span> 

<div class="viewcode-block" id="NBodyPhaseSpace.convertUnits"><a class="viewcode-back" href="../../../../fudge/fudge.productData.distributions.html#fudge.productData.distributions.energy.NBodyPhaseSpace.convertUnits">[docs]</a>    <span class="k">def</span> <span class="nf">convertUnits</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">unitMap</span> <span class="p">)</span> <span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Converts all data in *self* per *unitMap*.</span>

<span class="sd">        :param unitMap:     A dictionary in which each key is a unit that will be replaced by its value which must be an equivalent unit.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">pass</span></div>

<div class="viewcode-block" id="NBodyPhaseSpace.copy"><a class="viewcode-back" href="../../../../fudge/fudge.productData.distributions.html#fudge.productData.distributions.energy.NBodyPhaseSpace.copy">[docs]</a>    <span class="k">def</span> <span class="nf">copy</span><span class="p">(</span> <span class="bp">self</span> <span class="p">)</span> <span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a copy of *self*.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="n">NBodyPhaseSpace</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">numberOfProducts</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">mass</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span> <span class="p">)</span> <span class="p">)</span></div>

    <span class="n">__copy__</span> <span class="o">=</span> <span class="n">copy</span>

<div class="viewcode-block" id="NBodyPhaseSpace.check"><a class="viewcode-back" href="../../../../fudge/fudge.productData.distributions.html#fudge.productData.distributions.energy.NBodyPhaseSpace.check">[docs]</a>    <span class="k">def</span> <span class="nf">check</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">info</span> <span class="p">)</span> <span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Does a check of *self*&#39;s data.</span>

<span class="sd">        :param info:        A dictionary with parameters used for determining if a difference is relevant.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1">#if ( abs( self.mass - info[&#39;reactionSuite&#39;].products[&#39;n&#39;].getMass(&#39;amu&#39;) * self.numberOfProducts ) &gt;</span>
        <span class="c1">#        self.mass * 0.1 ) :    # return warning?</span>

        <span class="k">return</span> <span class="p">[]</span></div>

<div class="viewcode-block" id="NBodyPhaseSpace.averageEp"><a class="viewcode-back" href="../../../../fudge/fudge.productData.distributions.html#fudge.productData.distributions.energy.NBodyPhaseSpace.averageEp">[docs]</a>    <span class="k">def</span> <span class="nf">averageEp</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">E</span><span class="p">,</span> <span class="n">massUnit</span><span class="p">,</span> <span class="n">projectileMass</span><span class="p">,</span> <span class="n">targetMass</span><span class="p">,</span> <span class="n">productMass</span><span class="p">,</span> <span class="n">Q</span> <span class="p">)</span> <span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calculate the average energy of the product in the center-of-mass frame for projectile energy E. This method only works for</span>
<span class="sd">        a one-step reaction.</span>

<span class="sd">        :param E:                   The energy of the projectile.</span>
<span class="sd">        :param massUnit:            The unit for *projectileMass*, *targetMass* and *productMass*.</span>
<span class="sd">        :param projectileMass:      The mass of the projectile in unit of *massUnit*.</span>
<span class="sd">        :param targetMass:          The mass of the target in unit of *massUnit*.</span>
<span class="sd">        :param productMass:         The mass of the product in unit of *massUnit*.</span>
<span class="sd">        :param Q:                   The Q-value for the reaction.</span>

<span class="sd">        :return:                Python float.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">M</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mass</span><span class="o">.</span><span class="n">getValueAs</span><span class="p">(</span> <span class="n">massUnit</span> <span class="p">)</span>
        <span class="n">Ea</span> <span class="o">=</span> <span class="n">targetMass</span> <span class="o">/</span> <span class="p">(</span> <span class="n">targetMass</span> <span class="o">+</span> <span class="n">projectileMass</span> <span class="p">)</span> <span class="o">*</span> <span class="n">E</span> <span class="o">+</span> <span class="n">Q</span>
        <span class="k">return</span><span class="p">(</span> <span class="n">Ea</span> <span class="o">*</span> <span class="p">(</span> <span class="n">M</span> <span class="o">-</span> <span class="n">productMass</span> <span class="p">)</span> <span class="o">/</span> <span class="p">(</span> <span class="n">M</span> <span class="o">*</span> <span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">numberOfProducts</span> <span class="o">-</span> <span class="mi">1</span> <span class="p">)</span> <span class="p">)</span> <span class="p">)</span></div>

<div class="viewcode-block" id="NBodyPhaseSpace.evaluate"><a class="viewcode-back" href="../../../../fudge/fudge.productData.distributions.html#fudge.productData.distributions.energy.NBodyPhaseSpace.evaluate">[docs]</a>    <span class="k">def</span> <span class="nf">evaluate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">energy_in</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This method returns the P(E) at projectile energy *energy_in*.</span>
<span class="sd">        The accuracy of the returned P(E) can be set by the value of the &#39;accuracy&#39; key in *kwargs*.</span>

<span class="sd">        :param energy_in:       The energy of the projectile.</span>
<span class="sd">        :param kwargs:          A dictionary that contains data to control the way this method acts.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="kn">from</span> <span class="nn">fudge</span> <span class="kn">import</span> <span class="n">product</span> <span class="k">as</span> <span class="n">productModule</span>
        <span class="kn">from</span> <span class="nn">fudge</span> <span class="kn">import</span> <span class="n">reactionSuite</span> <span class="k">as</span> <span class="n">reactionSuiteModule</span>
        <span class="kn">from</span> <span class="nn">fudge</span> <span class="kn">import</span> <span class="n">outputChannel</span> <span class="k">as</span> <span class="n">outputChannelModule</span>
        <span class="kn">from</span> <span class="nn">fudge.reactions</span> <span class="kn">import</span> <span class="n">reaction</span> <span class="k">as</span> <span class="n">reactionModule</span>
        <span class="kn">from</span> <span class="nn">fudge.core.math</span> <span class="kn">import</span> <span class="n">fudgemath</span>

        <span class="k">class</span> <span class="nc">Tester</span><span class="p">:</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            This class is used by :py:func:`fudgemath.thickenXYList` to add points until the desired accuracy is reached.</span>
<span class="sd">            &quot;&quot;&quot;</span>

            <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">relativeTolerance</span><span class="p">,</span> <span class="n">absoluteTolerance</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">EMax_i</span><span class="p">):</span>
<span class="w">                </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">                :param relativeTolerance:   The relative desired accuracy.</span>
<span class="sd">                :param absoluteTolerance:   The absolute desired accuracy.</span>
<span class="sd">                :param n:</span>
<span class="sd">                :param EMax_i:              The maximum energy of the outgoing product.</span>
<span class="sd">                &quot;&quot;&quot;</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">relativeTolerance</span> <span class="o">=</span> <span class="n">relativeTolerance</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">absoluteTolerance</span> <span class="o">=</span> <span class="n">absoluteTolerance</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">n</span> <span class="o">=</span> <span class="n">n</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">EMax_i</span> <span class="o">=</span> <span class="n">EMax_i</span>

            <span class="k">def</span> <span class="nf">evaluateAtX</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">energy_out</span><span class="p">):</span>

                <span class="k">return</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">energy_out</span><span class="p">)</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">pow</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">EMax_i</span> <span class="o">-</span> <span class="n">energy_out</span><span class="p">),</span> <span class="mf">1.5</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">n</span> <span class="o">-</span> <span class="mf">4.0</span><span class="p">)</span>

        <span class="n">accuracy</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;accuracy&#39;</span><span class="p">,</span> <span class="mf">1e-3</span><span class="p">)</span>

        <span class="n">mass</span><span class="p">,</span> <span class="n">massUnit</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mass</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">mass</span><span class="o">.</span><span class="n">unit</span>
        <span class="n">product</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">findClassInAncestry</span><span class="p">(</span><span class="n">productModule</span><span class="o">.</span><span class="n">Product</span><span class="p">)</span>
        <span class="n">productMass</span> <span class="o">=</span> <span class="n">product</span><span class="o">.</span><span class="n">getMass</span><span class="p">(</span><span class="n">massUnit</span><span class="p">)</span>

        <span class="n">reactionSuite</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">findClassInAncestry</span><span class="p">(</span><span class="n">reactionSuiteModule</span><span class="o">.</span><span class="n">ReactionSuite</span><span class="p">)</span>
        <span class="n">projectile</span> <span class="o">=</span> <span class="n">reactionSuite</span><span class="o">.</span><span class="n">PoPs</span><span class="o">.</span><span class="n">final</span><span class="p">(</span><span class="n">reactionSuite</span><span class="o">.</span><span class="n">projectile</span><span class="p">)</span>
        <span class="n">projectileMass</span> <span class="o">=</span> <span class="n">projectile</span><span class="o">.</span><span class="n">getMass</span><span class="p">(</span><span class="n">massUnit</span><span class="p">)</span>

        <span class="n">targetID</span> <span class="o">=</span> <span class="n">reactionSuite</span><span class="o">.</span><span class="n">target</span>
        <span class="n">target</span> <span class="o">=</span> <span class="n">reactionSuite</span><span class="o">.</span><span class="n">PoPs</span><span class="o">.</span><span class="n">final</span><span class="p">(</span><span class="n">reactionSuite</span><span class="o">.</span><span class="n">target</span><span class="p">)</span>
        <span class="n">targetMass</span> <span class="o">=</span> <span class="n">target</span><span class="o">.</span><span class="n">getMass</span><span class="p">(</span><span class="n">massUnit</span><span class="p">)</span>

        <span class="n">outputChannel</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">findClassInAncestry</span><span class="p">(</span><span class="n">outputChannelModule</span><span class="o">.</span><span class="n">OutputChannel</span><span class="p">)</span>
        <span class="n">Q</span> <span class="o">=</span> <span class="n">outputChannel</span><span class="o">.</span><span class="n">Q</span><span class="o">.</span><span class="n">getConstant</span><span class="p">()</span>

        <span class="n">Ea</span> <span class="o">=</span> <span class="n">targetMass</span> <span class="o">/</span> <span class="p">(</span><span class="n">targetMass</span> <span class="o">+</span> <span class="n">projectileMass</span><span class="p">)</span> <span class="o">*</span> <span class="n">energy_in</span> <span class="o">+</span> <span class="n">Q</span>
        <span class="n">EMax_i</span> <span class="o">=</span> <span class="n">Ea</span> <span class="o">*</span> <span class="p">(</span><span class="n">mass</span> <span class="o">-</span> <span class="n">productMass</span><span class="p">)</span> <span class="o">/</span> <span class="n">mass</span>
        <span class="k">if</span> <span class="n">EMax_i</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">EMax_i</span> <span class="o">=</span> <span class="mf">1e-5</span>                                    <span class="c1"># This is a kludge</span>

        <span class="n">tester</span> <span class="o">=</span> <span class="n">Tester</span><span class="p">(</span><span class="n">accuracy</span><span class="p">,</span> <span class="mf">1e-10</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">numberOfProducts</span><span class="p">,</span> <span class="n">EMax_i</span><span class="p">)</span>
        <span class="n">tester</span><span class="o">.</span><span class="n">absoluteTolerance</span> <span class="o">=</span> <span class="mf">1e-10</span> <span class="o">*</span> <span class="n">tester</span><span class="o">.</span><span class="n">evaluateAtX</span><span class="p">(</span><span class="mf">0.5</span> <span class="o">*</span> <span class="n">EMax_i</span><span class="p">)</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">fudgemath</span><span class="o">.</span><span class="n">thickenXYList</span><span class="p">([[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span> <span class="p">[</span><span class="n">EMax_i</span><span class="p">,</span> <span class="mf">0.</span><span class="p">]],</span> <span class="n">tester</span><span class="p">,</span> <span class="n">biSectionMax</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">XYs1d</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">outerDomainValue</span><span class="o">=</span><span class="n">energy_in</span><span class="p">)</span>
        <span class="n">data</span><span class="o">.</span><span class="n">normalize</span><span class="p">(</span><span class="n">insitu</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">data</span></div>

<div class="viewcode-block" id="NBodyPhaseSpace.fixDomains"><a class="viewcode-back" href="../../../../fudge/fudge.productData.distributions.html#fudge.productData.distributions.energy.NBodyPhaseSpace.fixDomains">[docs]</a>    <span class="k">def</span> <span class="nf">fixDomains</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span> <span class="n">energyMin</span><span class="p">,</span> <span class="n">energyMax</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;This method does nothing.&quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="mi">0</span></div>

<div class="viewcode-block" id="NBodyPhaseSpace.toPointwise_withLinearXYs"><a class="viewcode-back" href="../../../../fudge/fudge.productData.distributions.html#fudge.productData.distributions.energy.NBodyPhaseSpace.toPointwise_withLinearXYs">[docs]</a>    <span class="k">def</span> <span class="nf">toPointwise_withLinearXYs</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span> <span class="p">)</span> <span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a pointwise represent of *self*.</span>

<span class="sd">        :param kwargs:              A dictionary that contains data to control the way this method acts.</span>

<span class="sd">        :return:                    An :py:class:`XYs2d` instance.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="kn">from</span> <span class="nn">fudge</span> <span class="kn">import</span> <span class="n">product</span> <span class="k">as</span> <span class="n">productModule</span>
        <span class="kn">from</span> <span class="nn">fudge</span> <span class="kn">import</span> <span class="n">reactionSuite</span> <span class="k">as</span> <span class="n">reactionSuiteModule</span>
        <span class="kn">from</span> <span class="nn">...reactions</span> <span class="kn">import</span> <span class="n">reaction</span> <span class="k">as</span> <span class="n">reactionModule</span>
        <span class="kn">from</span> <span class="nn">...</span> <span class="kn">import</span> <span class="n">outputChannel</span> <span class="k">as</span> <span class="n">outputChannelModule</span>
        <span class="kn">from</span> <span class="nn">fudge.core.math</span> <span class="kn">import</span> <span class="n">fudgemath</span>

        <span class="k">class</span> <span class="nc">Tester</span> <span class="p">:</span>

            <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">relativeTolerance</span><span class="p">,</span> <span class="n">absoluteTolerance</span><span class="p">,</span> <span class="n">n</span> <span class="p">)</span> <span class="p">:</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">relativeTolerance</span> <span class="o">=</span> <span class="n">relativeTolerance</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">absoluteTolerance</span> <span class="o">=</span> <span class="n">absoluteTolerance</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">n</span> <span class="o">=</span> <span class="n">n</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">setEMax_i</span><span class="p">(</span> <span class="mi">1</span> <span class="p">)</span>

            <span class="k">def</span> <span class="nf">evaluateAtX</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>

                <span class="k">return</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">pow</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">EMax_i</span> <span class="o">-</span> <span class="n">x</span><span class="p">),</span> <span class="mf">1.5</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">n</span> <span class="o">-</span> <span class="mf">4.0</span><span class="p">)</span>

            <span class="k">def</span> <span class="nf">setEMax_i</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">EMax_i</span> <span class="p">)</span> <span class="p">:</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">EMax_i</span> <span class="o">=</span> <span class="n">EMax_i</span>

        <span class="n">p</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">findClassInAncestry</span><span class="p">(</span><span class="n">productModule</span><span class="o">.</span><span class="n">Product</span><span class="p">)</span>
        <span class="n">mass</span><span class="p">,</span> <span class="n">massUnit</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mass</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">mass</span><span class="o">.</span><span class="n">unit</span>
        <span class="n">productMass</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">getMass</span><span class="p">(</span><span class="n">massUnit</span><span class="p">)</span>

        <span class="n">r</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">findClassInAncestry</span><span class="p">(</span><span class="n">reactionModule</span><span class="o">.</span><span class="n">Reaction</span><span class="p">)</span>
        <span class="n">EMin</span> <span class="o">=</span> <span class="n">r</span><span class="o">.</span><span class="n">domainMin</span>
        <span class="n">EMax</span> <span class="o">=</span> <span class="n">r</span><span class="o">.</span><span class="n">domainMax</span>
        <span class="n">energyUnit</span> <span class="o">=</span> <span class="n">r</span><span class="o">.</span><span class="n">domainUnit</span>

        <span class="n">reactionSuite</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">findClassInAncestry</span><span class="p">(</span><span class="n">reactionSuiteModule</span><span class="o">.</span><span class="n">ReactionSuite</span><span class="p">)</span>
        <span class="n">projectile</span> <span class="o">=</span> <span class="n">reactionSuite</span><span class="o">.</span><span class="n">PoPs</span><span class="p">[</span><span class="n">reactionSuite</span><span class="o">.</span><span class="n">projectile</span><span class="p">]</span>
        <span class="n">projectileMass</span> <span class="o">=</span> <span class="n">projectile</span><span class="o">.</span><span class="n">getMass</span><span class="p">(</span><span class="n">massUnit</span><span class="p">)</span>
        <span class="n">targetID</span> <span class="o">=</span> <span class="n">reactionSuite</span><span class="o">.</span><span class="n">target</span>
        <span class="k">if</span> <span class="n">targetID</span> <span class="ow">in</span> <span class="n">reactionSuite</span><span class="o">.</span><span class="n">PoPs</span><span class="o">.</span><span class="n">aliases</span><span class="p">:</span> <span class="n">targetID</span> <span class="o">=</span> <span class="n">reactionSuite</span><span class="o">.</span><span class="n">PoPs</span><span class="p">[</span><span class="n">targetID</span><span class="p">]</span><span class="o">.</span><span class="n">pid</span>
        <span class="n">target</span> <span class="o">=</span> <span class="n">reactionSuite</span><span class="o">.</span><span class="n">PoPs</span><span class="p">[</span><span class="n">targetID</span><span class="p">]</span>
        <span class="n">targetMass</span> <span class="o">=</span> <span class="n">target</span><span class="o">.</span><span class="n">getMass</span><span class="p">(</span><span class="n">massUnit</span><span class="p">)</span>

        <span class="n">c</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">findClassInAncestry</span><span class="p">(</span><span class="n">outputChannelModule</span><span class="o">.</span><span class="n">OutputChannel</span><span class="p">)</span>
        <span class="n">Q</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">Q</span><span class="o">.</span><span class="n">getConstant</span><span class="p">(</span> <span class="p">)</span>

        <span class="n">axes</span> <span class="o">=</span> <span class="n">defaultAxes</span><span class="p">(</span> <span class="n">energyUnit</span> <span class="p">)</span>
        <span class="n">pwl</span> <span class="o">=</span> <span class="n">XYs2d</span><span class="p">(</span> <span class="n">axes</span><span class="o">=</span><span class="n">axes</span> <span class="p">)</span>

        <span class="n">accuracy</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span> <span class="s1">&#39;accuracy&#39;</span><span class="p">,</span> <span class="n">XYs1dModule</span><span class="o">.</span><span class="n">defaultAccuracy</span> <span class="p">)</span>

        <span class="n">t</span> <span class="o">=</span> <span class="n">Tester</span><span class="p">(</span> <span class="n">accuracy</span><span class="p">,</span> <span class="mf">1e-10</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">numberOfProducts</span> <span class="p">)</span>
        <span class="n">n</span> <span class="o">=</span> <span class="mi">21</span>
        <span class="n">f</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span> <span class="n">EMax</span> <span class="o">/</span> <span class="n">EMin</span><span class="p">,</span> <span class="mf">1.</span> <span class="o">/</span> <span class="n">n</span> <span class="p">)</span>
        <span class="n">E_ins</span> <span class="o">=</span> <span class="p">[</span> <span class="n">EMin</span> <span class="o">*</span> <span class="n">f</span><span class="o">**</span><span class="n">idx</span> <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span> <span class="n">n</span> <span class="p">)</span> <span class="p">]</span>
        <span class="n">E_ins</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">EMax</span>        <span class="c1"># Fix possible round off issue.</span>
        <span class="k">for</span> <span class="n">E_in</span> <span class="ow">in</span> <span class="n">E_ins</span><span class="p">:</span>
            <span class="n">Ea</span> <span class="o">=</span> <span class="n">targetMass</span> <span class="o">/</span> <span class="p">(</span> <span class="n">targetMass</span> <span class="o">+</span> <span class="n">projectileMass</span> <span class="p">)</span> <span class="o">*</span> <span class="n">E_in</span> <span class="o">+</span> <span class="n">Q</span>
            <span class="n">EMax_i</span> <span class="o">=</span> <span class="n">Ea</span> <span class="o">*</span> <span class="p">(</span> <span class="n">mass</span> <span class="o">-</span> <span class="n">productMass</span> <span class="p">)</span> <span class="o">/</span> <span class="n">mass</span>
            <span class="k">if</span><span class="p">(</span> <span class="n">EMax_i</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="p">)</span> <span class="p">:</span> <span class="n">EMax_i</span> <span class="o">=</span> <span class="mf">1e-5</span>                <span class="c1"># This is a kludge</span>
            <span class="n">t</span><span class="o">.</span><span class="n">setEMax_i</span><span class="p">(</span> <span class="n">EMax_i</span> <span class="p">)</span>
            <span class="n">t</span><span class="o">.</span><span class="n">absoluteTolerance</span> <span class="o">=</span> <span class="mf">1e-10</span> <span class="o">*</span> <span class="n">t</span><span class="o">.</span><span class="n">evaluateAtX</span><span class="p">(</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">EMax_i</span> <span class="p">)</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">fudgemath</span><span class="o">.</span><span class="n">thickenXYList</span><span class="p">(</span> <span class="p">[</span> <span class="p">[</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span> <span class="p">],</span> <span class="p">[</span> <span class="n">EMax_i</span><span class="p">,</span> <span class="mf">0.</span> <span class="p">]</span> <span class="p">],</span> <span class="n">t</span><span class="p">,</span> <span class="n">biSectionMax</span> <span class="o">=</span> <span class="mi">10</span> <span class="p">)</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">XYs1d</span><span class="p">(</span> <span class="n">data</span><span class="p">,</span> <span class="n">outerDomainValue</span> <span class="o">=</span> <span class="n">E_in</span> <span class="p">)</span>
            <span class="n">data</span><span class="o">.</span><span class="n">normalize</span><span class="p">(</span> <span class="n">insitu</span> <span class="o">=</span> <span class="kc">True</span> <span class="p">)</span>
            <span class="n">pwl</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="n">data</span> <span class="p">)</span>
        <span class="k">return</span> <span class="n">pwl</span></div>

<div class="viewcode-block" id="NBodyPhaseSpace.toXML_strList"><a class="viewcode-back" href="../../../../fudge/fudge.productData.distributions.html#fudge.productData.distributions.energy.NBodyPhaseSpace.toXML_strList">[docs]</a>    <span class="k">def</span> <span class="nf">toXML_strList</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">indent</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span> <span class="p">)</span> <span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a list of str instances representing the XML lines of *self*.</span>

<span class="sd">        :param indent:          The minimum amount of indentation.</span>
<span class="sd">        :param kwargs:          A dictionary of extra arguments that controls how *self* is converted to a list of XML strings.</span>

<span class="sd">        :return:                List of str instances representing the XML lines of self.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">indent2</span> <span class="o">=</span> <span class="n">indent</span> <span class="o">+</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span> <span class="s1">&#39;incrementalIndent&#39;</span><span class="p">,</span> <span class="s1">&#39;  &#39;</span> <span class="p">)</span>

        <span class="n">xmlString</span> <span class="o">=</span> <span class="p">[</span> <span class="bp">self</span><span class="o">.</span><span class="n">XMLStartTagString</span><span class="p">(</span> <span class="n">indent</span> <span class="o">=</span> <span class="n">indent</span><span class="p">,</span> 
                <span class="n">extraAttributesAsStrings</span> <span class="o">=</span> <span class="s1">&#39; numberOfProducts=&quot;</span><span class="si">%s</span><span class="s1">&quot;&#39;</span> <span class="o">%</span> <span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">numberOfProducts</span> <span class="p">),</span> <span class="n">emptyTag</span> <span class="o">=</span> <span class="kc">False</span> <span class="p">)</span> <span class="p">]</span>
        <span class="n">xmlString</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mass</span><span class="o">.</span><span class="n">toXML_strList</span><span class="p">(</span> <span class="n">indent2</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span> <span class="p">)</span>
        <span class="n">xmlString</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+=</span> <span class="s2">&quot;&lt;/</span><span class="si">%s</span><span class="s2">&gt;&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">moniker</span>
        <span class="k">return</span><span class="p">(</span> <span class="n">xmlString</span> <span class="p">)</span></div>

<div class="viewcode-block" id="NBodyPhaseSpace.parseNodeUsingClass"><a class="viewcode-back" href="../../../../fudge/fudge.productData.distributions.html#fudge.productData.distributions.energy.NBodyPhaseSpace.parseNodeUsingClass">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">parseNodeUsingClass</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">element</span><span class="p">,</span> <span class="n">xPath</span><span class="p">,</span> <span class="n">linkData</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Parse *element* into an instance of *cls*.</span>

<span class="sd">        :param cls:         Form class to return.</span>
<span class="sd">        :param element:     Node to parse.</span>
<span class="sd">        :param xPath:       List containing xPath to current node, useful mostly for debugging.</span>
<span class="sd">        :param linkData:    dict that collects unresolved links.</span>
<span class="sd">        :param kwargs:      A dictionary of extra arguments that controls how *self* is converted to a list of XML strings.</span>

<span class="sd">        :return: an instance of *cls* representing *element*.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">mass</span> <span class="o">=</span> <span class="n">physicalQuantityModule</span><span class="o">.</span><span class="n">Mass</span><span class="o">.</span><span class="n">parseNodeUsingClass</span><span class="p">(</span><span class="n">element</span><span class="o">.</span><span class="n">find</span><span class="p">(</span> <span class="s1">&#39;mass&#39;</span> <span class="p">),</span> <span class="n">xPath</span><span class="p">,</span> <span class="n">linkData</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span> <span class="nb">int</span><span class="p">(</span> <span class="n">element</span><span class="o">.</span><span class="n">get</span><span class="p">(</span> <span class="s2">&quot;numberOfProducts&quot;</span> <span class="p">)</span> <span class="p">),</span> <span class="n">mass</span> <span class="p">)</span></div></div>

<div class="viewcode-block" id="Weighted1d"><a class="viewcode-back" href="../../../../fudge/fudge.productData.distributions.html#fudge.productData.distributions.energy.Weighted1d">[docs]</a><span class="k">class</span> <span class="nc">Weighted1d</span> <span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This class represents an :py:class:`Weighted` instance evaluated at the specified projectile energy.</span>

<span class="sd">    The following table list the primary members of this class:</span>
<span class="sd">    </span>
<span class="sd">    +---------------+-------------------------------------------------------------------+</span>
<span class="sd">    | Member        | Description                                                       |</span>
<span class="sd">    +===============+===================================================================+</span>
<span class="sd">    | weight        | A Python float the multiplies the functional.                     |</span>
<span class="sd">    +---------------+-------------------------------------------------------------------+</span>
<span class="sd">    | functional    | A 1d energy distribution of :math:`P(E&#39;)`.                        |</span>
<span class="sd">    +---------------+-------------------------------------------------------------------+</span>

<span class="sd">    :param weight:              The weight to apply to the functional to get the final :math:`f(E&#39;)` which my not be nornalized,</span>
<span class="sd">    :param functional:          A 1d energy distribution of :math:`P(E&#39;)`.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">weight</span><span class="p">,</span> <span class="n">functional</span> <span class="p">)</span> <span class="p">:</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">weight</span> <span class="o">=</span> <span class="n">weight</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">functional</span> <span class="o">=</span> <span class="n">functional</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">domainMin</span><span class="p">(</span> <span class="bp">self</span> <span class="p">)</span> <span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the minimum output particle energy for *self*.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">functional</span><span class="o">.</span><span class="n">domainMin</span> <span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">domainMax</span><span class="p">(</span> <span class="bp">self</span> <span class="p">)</span> <span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the maximum output particle energy for *self*.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">functional</span><span class="o">.</span><span class="n">domainMax</span> <span class="p">)</span>

<div class="viewcode-block" id="Weighted1d.evaluate"><a class="viewcode-back" href="../../../../fudge/fudge.productData.distributions.html#fudge.productData.distributions.energy.Weighted1d.evaluate">[docs]</a>    <span class="k">def</span> <span class="nf">evaluate</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">energy</span> <span class="p">)</span> <span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the value of *self* evaluated at outgoing particle energy *energy*.</span>

<span class="sd">        :param energy:      The energy of the outgoing particle.</span>

<span class="sd">        :return:            Python float.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">weight</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">functional</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span> <span class="n">energy</span> <span class="p">)</span> <span class="p">)</span></div>

<div class="viewcode-block" id="Weighted1d.integrate"><a class="viewcode-back" href="../../../../fudge/fudge.productData.distributions.html#fudge.productData.distributions.energy.Weighted1d.integrate">[docs]</a>    <span class="k">def</span> <span class="nf">integrate</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">energyMin</span><span class="p">,</span> <span class="n">energyMax</span> <span class="p">)</span> <span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This meethod integrates the distribution at projectile energy over the specified outgoing energy, mu and phi ranges.</span>
<span class="sd">        See function :py:func:`miscellaneousModule.domainLimits` for how to specify *energyOut*, *muOut* and *phiOut*.</span>
<span class="sd">        </span>
<span class="sd">        :param energyMin:           The minimum value for the outgoing energy range.</span>
<span class="sd">        :param energyMax:           The maximum value for the outgoing energy range.</span>

<span class="sd">        :return:                    A float representing the value of the integration.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">weight</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">functional</span><span class="o">.</span><span class="n">integrate</span><span class="p">(</span> <span class="n">energyMin</span><span class="p">,</span> <span class="n">energyMax</span> <span class="p">)</span> <span class="p">)</span></div></div>

<div class="viewcode-block" id="WeightedFunctionals1d"><a class="viewcode-back" href="../../../../fudge/fudge.productData.distributions.html#fudge.productData.distributions.energy.WeightedFunctionals1d">[docs]</a><span class="k">class</span> <span class="nc">WeightedFunctionals1d</span> <span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This class represents an :py:class:`WeightedFunctionals` instance evaluated at the specified projectile energy.</span>

<span class="sd">    The following table list the primary members of this class:</span>
<span class="sd">    </span>
<span class="sd">    +---------------+-------------------------------------------------------------------+</span>
<span class="sd">    | Member        | Description                                                       |</span>
<span class="sd">    +===============+===================================================================+</span>
<span class="sd">    | weighted1d    | The list of :py:class:`Weighted1d` instances that make the        |</span>
<span class="sd">    |               | complete, normalized :math:`P(E&#39;)`.                               |</span>
<span class="sd">    +---------------+-------------------------------------------------------------------+</span>

<span class="sd">    :param weighted1d:      The list of :py:class:`Weighted1d` instances that make the complete, normalized :math:`P(E&#39;)`.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span> <span class="bp">self</span> <span class="p">)</span> <span class="p">:</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">weighted1d</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">domainMin</span><span class="p">(</span> <span class="bp">self</span> <span class="p">)</span> <span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the minimum outgoing particle energy for *self*.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span><span class="p">(</span> <span class="nb">min</span><span class="p">(</span> <span class="n">weighted1d1</span><span class="o">.</span><span class="n">domainMin</span> <span class="k">for</span> <span class="n">weighted1d1</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">weighted1d</span> <span class="p">)</span> <span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">domainMax</span><span class="p">(</span> <span class="bp">self</span> <span class="p">)</span> <span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the maximum outgoing particle energy for *self*.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span><span class="p">(</span> <span class="nb">max</span><span class="p">(</span> <span class="n">weighted1d1</span><span class="o">.</span><span class="n">domainMax</span> <span class="k">for</span> <span class="n">weighted1d1</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">weighted1d</span> <span class="p">)</span> <span class="p">)</span>

<div class="viewcode-block" id="WeightedFunctionals1d.append"><a class="viewcode-back" href="../../../../fudge/fudge.productData.distributions.html#fudge.productData.distributions.energy.WeightedFunctionals1d.append">[docs]</a>    <span class="k">def</span> <span class="nf">append</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">_weighted1d</span> <span class="p">)</span> <span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Appends a :py:class:`Weighted1d` instance to *self*.</span>

<span class="sd">        :param _weighted1d: A :py:class:`Weighted1d` instance.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">weighted1d</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="n">_weighted1d</span> <span class="p">)</span></div>

<div class="viewcode-block" id="WeightedFunctionals1d.evaluate"><a class="viewcode-back" href="../../../../fudge/fudge.productData.distributions.html#fudge.productData.distributions.energy.WeightedFunctionals1d.evaluate">[docs]</a>    <span class="k">def</span> <span class="nf">evaluate</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">energy</span> <span class="p">)</span> <span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the value of *self* evaluated at outgoing particle energy *energy*.</span>

<span class="sd">        :param energy:      The energy of the outgoing particle.</span>

<span class="sd">        :return:            Python float.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">value</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="k">for</span> <span class="n">weighted1d</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">weighted1d</span> <span class="p">:</span> <span class="n">value</span> <span class="o">+=</span> <span class="n">weighted1d</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span> <span class="n">energy</span> <span class="p">)</span>
        <span class="k">return</span><span class="p">(</span> <span class="n">value</span> <span class="p">)</span></div>

<div class="viewcode-block" id="WeightedFunctionals1d.integrate"><a class="viewcode-back" href="../../../../fudge/fudge.productData.distributions.html#fudge.productData.distributions.energy.WeightedFunctionals1d.integrate">[docs]</a>    <span class="k">def</span> <span class="nf">integrate</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">energyMin</span><span class="p">,</span> <span class="n">energyMax</span> <span class="p">)</span> <span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This meethod integrates the distribution at projectile energy over the specified outgoing energy, mu and phi ranges.</span>
<span class="sd">        See function :py:func:`miscellaneousModule.domainLimits` for how to specify *energyOut*, *muOut* and *phiOut*.</span>
<span class="sd">        </span>
<span class="sd">        :param energyMin:           The minimum value for the outgoing energy range.</span>
<span class="sd">        :param energyMax:           The maximum value for the outgoing energy range.</span>

<span class="sd">        :return:                    A float representing the value of the integration.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">value</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="k">for</span> <span class="n">weighted1d</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">weighted1d</span> <span class="p">:</span> <span class="n">value</span> <span class="o">+=</span> <span class="n">weighted1d</span><span class="o">.</span><span class="n">integrate</span><span class="p">(</span> <span class="n">energyMin</span><span class="p">,</span> <span class="n">energyMax</span> <span class="p">)</span>
        <span class="k">return</span><span class="p">(</span> <span class="n">value</span> <span class="p">)</span></div></div>

<div class="viewcode-block" id="Weighted"><a class="viewcode-back" href="../../../../fudge/fudge.productData.distributions.html#fudge.productData.distributions.energy.Weighted">[docs]</a><span class="k">class</span> <span class="nc">Weighted</span><span class="p">(</span><span class="n">ancestryModule</span><span class="o">.</span><span class="n">AncestryIO</span><span class="p">):</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This class represents 2d energy distribution math:`P(E&#39;|E)` with a projectile energy dependent</span>
<span class="sd">    weight function :math:`w(E)`. That is, the 2d energy distribution is :math:`w(E) \, P(E&#39;|E)`.</span>

<span class="sd">    The following table list the primary members of this class:</span>
<span class="sd">    </span>
<span class="sd">    +---------------+-------------------------------------------------------------------+</span>
<span class="sd">    | Member        | Description                                                       |</span>
<span class="sd">    +===============+===================================================================+</span>
<span class="sd">    | weight        | The projectile energy dependent function :math:`w(E)`.            |</span>
<span class="sd">    +---------------+-------------------------------------------------------------------+</span>
<span class="sd">    | functional    | The 2d energy distribution :math:`P(E&#39;|E)`.                       |</span>
<span class="sd">    +---------------+-------------------------------------------------------------------+</span>

<span class="sd">    :param weight:              The weight function.</span>
<span class="sd">    :param functional:          The 2d energy distribution :math:`P(E&#39;)`.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">moniker</span> <span class="o">=</span> <span class="s1">&#39;weighted&#39;</span>
    <span class="n">ancestryMembers</span> <span class="o">=</span> <span class="p">(</span> <span class="s1">&#39;weight&#39;</span><span class="p">,</span> <span class="s1">&#39;functional&#39;</span> <span class="p">)</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">weight</span><span class="p">,</span> <span class="n">functional</span> <span class="p">)</span> <span class="p">:</span>

        <span class="n">ancestryModule</span><span class="o">.</span><span class="n">AncestryIO</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span> <span class="bp">self</span> <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">weight</span> <span class="o">=</span> <span class="n">weight</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">weight</span><span class="o">.</span><span class="n">setAncestor</span><span class="p">(</span> <span class="bp">self</span> <span class="p">)</span>
<span class="c1"># BRB6 weight should be its own class so that label need not be set here.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">weight</span><span class="o">.</span><span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;weight&#39;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">functional</span> <span class="o">=</span> <span class="n">functional</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">functional</span><span class="o">.</span><span class="n">setAncestor</span><span class="p">(</span> <span class="bp">self</span> <span class="p">)</span>

<div class="viewcode-block" id="Weighted.convertUnits"><a class="viewcode-back" href="../../../../fudge/fudge.productData.distributions.html#fudge.productData.distributions.energy.Weighted.convertUnits">[docs]</a>    <span class="k">def</span> <span class="nf">convertUnits</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">unitMap</span> <span class="p">)</span> <span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Converts all data in *self* per *unitMap*.</span>

<span class="sd">        :param unitMap:     A dictionary in which each key is a unit that will be replaced by its value which must be an equivalent unit.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">weight</span><span class="o">.</span><span class="n">convertUnits</span><span class="p">(</span> <span class="n">unitMap</span> <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">functional</span><span class="o">.</span><span class="n">convertUnits</span><span class="p">(</span> <span class="n">unitMap</span> <span class="p">)</span></div>

<div class="viewcode-block" id="Weighted.copy"><a class="viewcode-back" href="../../../../fudge/fudge.productData.distributions.html#fudge.productData.distributions.energy.Weighted.copy">[docs]</a>    <span class="k">def</span> <span class="nf">copy</span><span class="p">(</span> <span class="bp">self</span> <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a copy of *self*.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="n">Weighted</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">weight</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span> <span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">functional</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span> <span class="p">)</span> <span class="p">)</span></div>

    <span class="n">__copy__</span> <span class="o">=</span> <span class="n">copy</span>

<div class="viewcode-block" id="Weighted.checkProductFrame"><a class="viewcode-back" href="../../../../fudge/fudge.productData.distributions.html#fudge.productData.distributions.energy.Weighted.checkProductFrame">[docs]</a>    <span class="k">def</span> <span class="nf">checkProductFrame</span><span class="p">(</span> <span class="bp">self</span> <span class="p">)</span> <span class="p">:</span>
        <span class="s2">&quot;Calls checkProductFrame on self&#39;s functional.&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">functional</span><span class="o">.</span><span class="n">checkProductFrame</span><span class="p">(</span> <span class="p">)</span></div>

<div class="viewcode-block" id="Weighted.averageEp"><a class="viewcode-back" href="../../../../fudge/fudge.productData.distributions.html#fudge.productData.distributions.energy.Weighted.averageEp">[docs]</a>    <span class="k">def</span> <span class="nf">averageEp</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">E</span> <span class="p">)</span> <span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calculated the average energy of the outgoing photon at projectile energy *E*.</span>

<span class="sd">        :param E:           The energy of the projectile energy.</span>

<span class="sd">        :return:            Python float.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">weight</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span> <span class="n">E</span> <span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">functional</span><span class="o">.</span><span class="n">averageEp</span><span class="p">(</span> <span class="n">E</span> <span class="p">)</span> <span class="p">)</span></div>

<div class="viewcode-block" id="Weighted.evaluate"><a class="viewcode-back" href="../../../../fudge/fudge.productData.distributions.html#fudge.productData.distributions.energy.Weighted.evaluate">[docs]</a>    <span class="k">def</span> <span class="nf">evaluate</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">energy</span> <span class="p">)</span> <span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the value of *self* evaluated at projectile energy *energy*.</span>

<span class="sd">        :param energy:      The energy of the projectile.</span>

<span class="sd">        :return:            A :py:class:`Weighted1d` instance..</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span><span class="p">(</span> <span class="n">Weighted1d</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">weight</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span> <span class="n">energy</span> <span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">functional</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span> <span class="n">energy</span> <span class="p">)</span> <span class="p">)</span> <span class="p">)</span></div>

<div class="viewcode-block" id="Weighted.fixDomains"><a class="viewcode-back" href="../../../../fudge/fudge.productData.distributions.html#fudge.productData.distributions.energy.Weighted.fixDomains">[docs]</a>    <span class="k">def</span> <span class="nf">fixDomains</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">energyMin</span><span class="p">,</span> <span class="n">energyMax</span><span class="p">,</span> <span class="n">domainToFix</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calls the **fixDomains** for the **weight** and **functional** members.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">numberOfFixes</span>  <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">weight</span><span class="o">.</span><span class="n">fixDomains</span><span class="p">(</span><span class="n">energyMin</span><span class="p">,</span> <span class="n">energyMax</span><span class="p">,</span> <span class="n">domainToFix</span><span class="p">)</span>
        <span class="n">numberOfFixes</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">functional</span><span class="o">.</span><span class="n">fixDomains</span><span class="p">(</span><span class="n">energyMin</span><span class="p">,</span> <span class="n">energyMax</span><span class="p">,</span> <span class="n">domainToFix</span><span class="p">)</span>

        <span class="k">return</span>  <span class="n">numberOfFixes</span></div>

<div class="viewcode-block" id="Weighted.getEnergyArray"><a class="viewcode-back" href="../../../../fudge/fudge.productData.distributions.html#fudge.productData.distributions.energy.Weighted.getEnergyArray">[docs]</a>    <span class="k">def</span> <span class="nf">getEnergyArray</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">EMin</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">EMax</span> <span class="o">=</span> <span class="kc">None</span> <span class="p">)</span> <span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This method returns the list of projectile energies that *self* is specific at.</span>

<span class="sd">        :parem EMin:        If *self* does not have an projectile energy values, the default minimum energy to return.</span>
<span class="sd">        :parem EMax:        If *self* does not have an projectile energy values, the default maximum energy to return.</span>

<span class="sd">        :return:            Python list of float.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">energyArray</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">functional</span><span class="o">.</span><span class="n">getEnergyArray</span><span class="p">(</span> <span class="n">EMin</span><span class="p">,</span> <span class="n">EMax</span> <span class="p">)</span>
        <span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">weight</span> <span class="p">:</span>
            <span class="k">if</span><span class="p">(</span> <span class="n">x</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">energyArray</span> <span class="p">)</span> <span class="p">:</span> <span class="n">energyArray</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="n">x</span> <span class="p">)</span>
        <span class="n">energyArray</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span> <span class="p">)</span>
        <span class="k">return</span><span class="p">(</span> <span class="n">energyArray</span> <span class="p">)</span></div>

<div class="viewcode-block" id="Weighted.toXML_strList"><a class="viewcode-back" href="../../../../fudge/fudge.productData.distributions.html#fudge.productData.distributions.energy.Weighted.toXML_strList">[docs]</a>    <span class="k">def</span> <span class="nf">toXML_strList</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">indent</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span> <span class="p">)</span> <span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a list of str instances representing the XML lines of *self*.</span>

<span class="sd">        :param indent:          The minimum amount of indentation.</span>
<span class="sd">        :param kwargs:          A dictionary of extra arguments that controls how *self* is converted to a list of XML strings.</span>

<span class="sd">        :return:                List of str instances representing the XML lines of self.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">indent2</span> <span class="o">=</span> <span class="n">indent</span> <span class="o">+</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span> <span class="s1">&#39;incrementalIndent&#39;</span><span class="p">,</span> <span class="s1">&#39;  &#39;</span> <span class="p">)</span>

        <span class="n">xmlString</span> <span class="o">=</span> <span class="p">[</span> <span class="s1">&#39;</span><span class="si">%s</span><span class="s1">&lt;</span><span class="si">%s</span><span class="s1">&gt;&#39;</span> <span class="o">%</span><span class="p">(</span>  <span class="n">indent</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">moniker</span> <span class="p">)</span> <span class="p">]</span>
        <span class="n">xmlString</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">weight</span><span class="o">.</span><span class="n">toXML_strList</span><span class="p">(</span> <span class="n">indent2</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span> <span class="p">)</span>
        <span class="n">xmlString</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">functional</span><span class="o">.</span><span class="n">toXML_strList</span><span class="p">(</span> <span class="n">indent2</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span> <span class="p">)</span>
        <span class="n">xmlString</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+=</span> <span class="s1">&#39;&lt;/</span><span class="si">%s</span><span class="s1">&gt;&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">moniker</span>
        <span class="k">return</span><span class="p">(</span> <span class="n">xmlString</span> <span class="p">)</span></div>

<div class="viewcode-block" id="Weighted.parseNodeUsingClass"><a class="viewcode-back" href="../../../../fudge/fudge.productData.distributions.html#fudge.productData.distributions.energy.Weighted.parseNodeUsingClass">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">parseNodeUsingClass</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">node</span><span class="p">,</span> <span class="n">xPath</span><span class="p">,</span> <span class="n">linkData</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Parse *node* into an instance of *cls*.</span>

<span class="sd">        :param cls:         Form class to return.</span>
<span class="sd">        :param node:        Node to parse.</span>
<span class="sd">        :param xPath:       List containing xPath to current node, useful mostly for debugging.</span>
<span class="sd">        :param linkData:    dict that collects unresolved links.</span>
<span class="sd">        :param kwargs:      A dictionary of extra arguments that controls how *self* is converted to a list of XML strings.</span>

<span class="sd">        :return: an instance of *cls* representing *node*.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">xPath</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">tag</span><span class="p">)</span>

        <span class="n">weights</span><span class="p">,</span> <span class="n">functional</span> <span class="o">=</span> <span class="n">node</span>
        <span class="n">_weight</span> <span class="o">=</span> <span class="n">XYs1dModule</span><span class="o">.</span><span class="n">XYs1d</span><span class="o">.</span><span class="n">parseNodeUsingClass</span><span class="p">(</span><span class="n">weights</span><span class="p">,</span> <span class="n">xPath</span><span class="p">,</span> <span class="n">linkData</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">subformClass</span> <span class="o">=</span> <span class="p">{</span>
                <span class="n">XYs2d</span><span class="o">.</span><span class="n">moniker</span>                   <span class="p">:</span> <span class="n">XYs2d</span><span class="p">,</span>
                <span class="n">GeneralEvaporation</span><span class="o">.</span><span class="n">moniker</span>      <span class="p">:</span> <span class="n">GeneralEvaporation</span><span class="p">,</span>
                <span class="n">Watt</span><span class="o">.</span><span class="n">moniker</span>                    <span class="p">:</span> <span class="n">Watt</span><span class="p">,</span>
                <span class="n">MadlandNix</span><span class="o">.</span><span class="n">moniker</span>              <span class="p">:</span> <span class="n">MadlandNix</span><span class="p">,</span>
                <span class="n">SimpleMaxwellianFission</span><span class="o">.</span><span class="n">moniker</span> <span class="p">:</span> <span class="n">SimpleMaxwellianFission</span><span class="p">,</span>
                <span class="n">Evaporation</span><span class="o">.</span><span class="n">moniker</span>             <span class="p">:</span> <span class="n">Evaporation</span><span class="p">,</span>
            <span class="p">}</span><span class="o">.</span><span class="n">get</span><span class="p">(</span> <span class="n">functional</span><span class="o">.</span><span class="n">tag</span> <span class="p">)</span>
        <span class="n">functional</span> <span class="o">=</span> <span class="n">subformClass</span><span class="o">.</span><span class="n">parseNodeUsingClass</span><span class="p">(</span><span class="n">functional</span><span class="p">,</span> <span class="n">xPath</span><span class="p">,</span> <span class="n">linkData</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">instance</span> <span class="o">=</span> <span class="n">Weighted</span><span class="p">(</span><span class="n">_weight</span><span class="p">,</span> <span class="n">functional</span><span class="p">)</span>

        <span class="n">xPath</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span> <span class="p">)</span>

        <span class="k">return</span> <span class="n">instance</span></div></div>

<div class="viewcode-block" id="WeightedFunctionals"><a class="viewcode-back" href="../../../../fudge/fudge.productData.distributions.html#fudge.productData.distributions.energy.WeightedFunctionals">[docs]</a><span class="k">class</span> <span class="nc">WeightedFunctionals</span><span class="p">(</span> <span class="n">Subform</span> <span class="p">)</span> <span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This class represents the :math:`P(E&#39;|E)` distribution as a list of :py:class:`Weighted` instances.</span>

<span class="sd">    The following table list the primary members of this class:</span>
<span class="sd">    </span>
<span class="sd">    +---------------+-------------------------------------------------------------------+</span>
<span class="sd">    | Member        | Description                                                       |</span>
<span class="sd">    +===============+===================================================================+</span>
<span class="sd">    | weights       | The list of :py:class:`Weighted` instances that make the          |</span>
<span class="sd">    |               | complete, normalized distribution :math:`P(E&#39;|E)`.                |</span>
<span class="sd">    +---------------+-------------------------------------------------------------------+</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">moniker</span> <span class="o">=</span> <span class="s1">&#39;weightedFunctionals&#39;</span>
    <span class="n">ancestryMembers</span> <span class="o">=</span> <span class="p">(</span> <span class="s1">&#39;weights&#39;</span><span class="p">,</span> <span class="p">)</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span> <span class="bp">self</span> <span class="p">)</span> <span class="p">:</span>

        <span class="n">Subform</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span> <span class="bp">self</span> <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">weights</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">def</span> <span class="fm">__len__</span><span class="p">(</span> <span class="bp">self</span> <span class="p">)</span> <span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns the number of :py:class:`Weighted` instances in *self*.&quot;&quot;&quot;</span>

        <span class="k">return</span><span class="p">(</span> <span class="nb">len</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">weights</span> <span class="p">)</span> <span class="p">)</span>

    <span class="k">def</span> <span class="fm">__getitem__</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">i</span> <span class="p">)</span> <span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the (i-1)^th :py:class:`Weighted` instance in *self*.</span>

<span class="sd">        :param i:       The index of the :py:class:`Weighted` instance to return.</span>

<span class="sd">        :return:        A :py:class:`Weighted` instance.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">weights</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="p">)</span>

<div class="viewcode-block" id="WeightedFunctionals.convertUnits"><a class="viewcode-back" href="../../../../fudge/fudge.productData.distributions.html#fudge.productData.distributions.energy.WeightedFunctionals.convertUnits">[docs]</a>    <span class="k">def</span> <span class="nf">convertUnits</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">unitMap</span> <span class="p">)</span> <span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Converts all data in *self* per *unitMap*.</span>

<span class="sd">        :param unitMap:     A dictionary in which each key is a unit that will be replaced by its value which must be an equivalent unit.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">for</span> <span class="n">weight</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">weights</span> <span class="p">:</span> <span class="n">weight</span><span class="o">.</span><span class="n">convertUnits</span><span class="p">(</span> <span class="n">unitMap</span> <span class="p">)</span></div>

<div class="viewcode-block" id="WeightedFunctionals.copy"><a class="viewcode-back" href="../../../../fudge/fudge.productData.distributions.html#fudge.productData.distributions.energy.WeightedFunctionals.copy">[docs]</a>    <span class="k">def</span> <span class="nf">copy</span><span class="p">(</span> <span class="bp">self</span> <span class="p">)</span> <span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a copy of *self*.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">newWF</span> <span class="o">=</span> <span class="n">WeightedFunctionals</span><span class="p">(</span> <span class="p">)</span>
        <span class="k">for</span> <span class="n">weight</span> <span class="ow">in</span> <span class="bp">self</span> <span class="p">:</span> <span class="n">newWF</span><span class="o">.</span><span class="n">addWeight</span><span class="p">(</span> <span class="n">weight</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span> <span class="p">)</span> <span class="p">)</span>
        <span class="k">return</span><span class="p">(</span> <span class="n">newWF</span> <span class="p">)</span></div>

    <span class="n">__copy__</span> <span class="o">=</span> <span class="n">copy</span>

<div class="viewcode-block" id="WeightedFunctionals.addWeight"><a class="viewcode-back" href="../../../../fudge/fudge.productData.distributions.html#fudge.productData.distributions.energy.WeightedFunctionals.addWeight">[docs]</a>    <span class="k">def</span> <span class="nf">addWeight</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">weight</span> <span class="p">)</span> <span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Appends a :py:class:`Weighted` instance to *self*.</span>

<span class="sd">        :param weight:  A :py:class:`Weighted` instance.</span>
<span class="sd">        &quot;&quot;&quot;</span>

<span class="c1"># BRB. either we remove this class (WeightedFunctionals) or self.weights should be a suite like object and it should be</span>
<span class="c1"># the ancestor of weight (i.e., self.weights[-1].setAncestor( self.weights ) and not weight.setAncestor( self ).</span>
        <span class="k">if</span><span class="p">(</span> <span class="ow">not</span><span class="p">(</span> <span class="nb">isinstance</span><span class="p">(</span> <span class="n">weight</span><span class="p">,</span> <span class="n">Weighted</span> <span class="p">)</span> <span class="p">)</span> <span class="p">)</span> <span class="p">:</span> <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span> <span class="s1">&#39;Invalid weight of type </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">brb</span><span class="o">.</span><span class="n">getType</span><span class="p">(</span> <span class="n">weight</span> <span class="p">)</span> <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">weights</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="n">weight</span> <span class="p">)</span>
        <span class="n">weight</span><span class="o">.</span><span class="n">setAncestor</span><span class="p">(</span> <span class="bp">self</span> <span class="p">)</span></div>

<div class="viewcode-block" id="WeightedFunctionals.check"><a class="viewcode-back" href="../../../../fudge/fudge.productData.distributions.html#fudge.productData.distributions.energy.WeightedFunctionals.check">[docs]</a>    <span class="k">def</span> <span class="nf">check</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">info</span> <span class="p">)</span> <span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Does a check of *self*&#39;s data.</span>

<span class="sd">        :param info:        A dictionary with parameters used for determining if a difference is relevant.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="kn">from</span> <span class="nn">fudge</span> <span class="kn">import</span> <span class="n">warning</span>

        <span class="n">warnings</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">totalWeight</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span> <span class="p">[</span><span class="n">w</span><span class="o">.</span><span class="n">weight</span> <span class="k">for</span> <span class="n">w</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">weights</span><span class="p">]</span> <span class="p">)</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">totalWeight</span><span class="o">.</span><span class="n">rangeMin</span> <span class="o">!=</span> <span class="mf">1.0</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">totalWeight</span><span class="o">.</span><span class="n">rangeMax</span> <span class="o">!=</span> <span class="mf">1.0</span><span class="p">):</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="n">warning</span><span class="o">.</span><span class="n">WeightsDontSumToOne</span><span class="p">(</span> <span class="n">obj</span><span class="o">=</span><span class="bp">self</span> <span class="p">)</span> <span class="p">)</span>

        <span class="k">for</span> <span class="n">weight</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
            <span class="n">warnings</span> <span class="o">+=</span> <span class="n">weight</span><span class="o">.</span><span class="n">functional</span><span class="o">.</span><span class="n">check</span><span class="p">(</span> <span class="n">info</span> <span class="p">)</span>

        <span class="k">return</span> <span class="n">warnings</span></div>

<div class="viewcode-block" id="WeightedFunctionals.averageEp"><a class="viewcode-back" href="../../../../fudge/fudge.productData.distributions.html#fudge.productData.distributions.energy.WeightedFunctionals.averageEp">[docs]</a>    <span class="k">def</span> <span class="nf">averageEp</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">E</span> <span class="p">)</span> <span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calculated the average energy of the outgoing photon at projectile energy *E*.</span>

<span class="sd">        :param E:           The energy of the projectile energy.</span>

<span class="sd">        :return:            Python float.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">Ep</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">weight</span> <span class="ow">in</span> <span class="bp">self</span> <span class="p">:</span> <span class="n">Ep</span> <span class="o">+=</span> <span class="n">weight</span><span class="o">.</span><span class="n">averageEp</span><span class="p">(</span> <span class="n">E</span> <span class="p">)</span>
        <span class="k">return</span><span class="p">(</span> <span class="n">Ep</span> <span class="p">)</span></div>

<div class="viewcode-block" id="WeightedFunctionals.evaluate"><a class="viewcode-back" href="../../../../fudge/fudge.productData.distributions.html#fudge.productData.distributions.energy.WeightedFunctionals.evaluate">[docs]</a>    <span class="k">def</span> <span class="nf">evaluate</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">energy</span> <span class="p">)</span> <span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This method returns a 1d functional representation of *self* evaluated at projectile energy *energy*.</span>

<span class="sd">        :param energy:      The projectile energy to evaluate *self* at.</span>

<span class="sd">        :return:            A :py:class:`WeightedFunctionals1d` instance.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">weightedFunctionals1d1</span> <span class="o">=</span> <span class="n">WeightedFunctionals1d</span><span class="p">(</span> <span class="p">)</span>
        <span class="k">for</span> <span class="n">weight</span> <span class="ow">in</span> <span class="bp">self</span> <span class="p">:</span> <span class="n">weightedFunctionals1d1</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="n">weight</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span> <span class="n">energy</span> <span class="p">)</span> <span class="p">)</span>
        <span class="k">return</span><span class="p">(</span> <span class="n">weightedFunctionals1d1</span> <span class="p">)</span></div>

<div class="viewcode-block" id="WeightedFunctionals.energySpectrumAtEnergy"><a class="viewcode-back" href="../../../../fudge/fudge.productData.distributions.html#fudge.productData.distributions.energy.WeightedFunctionals.energySpectrumAtEnergy">[docs]</a>    <span class="k">def</span> <span class="nf">energySpectrumAtEnergy</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">energyIn</span> <span class="p">)</span> <span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calculates the outgoing particle&#39;s energy spectrum at projectile energy *energyIn*,</span>

<span class="sd">        :param energyIn:            Energy of the projectile.</span>

<span class="sd">        :return:                    XYs1d instance for the energy spectrum.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">xys1d</span> <span class="o">=</span> <span class="n">XYs1d</span><span class="p">(</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">defaultAxes</span><span class="p">(</span> <span class="n">energyUnit</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">weights</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">functional</span><span class="o">.</span><span class="n">domainUnit</span> <span class="p">)</span> <span class="p">)</span>
        <span class="k">for</span> <span class="n">weight</span> <span class="ow">in</span> <span class="bp">self</span> <span class="p">:</span>
            <span class="n">spectrum1</span> <span class="o">=</span> <span class="n">weight</span><span class="o">.</span><span class="n">weight</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span> <span class="n">energyIn</span> <span class="p">)</span> <span class="o">*</span> <span class="n">weight</span><span class="o">.</span><span class="n">functional</span><span class="o">.</span><span class="n">energySpectrumAtEnergy</span><span class="p">(</span> <span class="n">energyIn</span> <span class="p">)</span>
            <span class="n">xys1d</span> <span class="o">+=</span> <span class="n">spectrum1</span>
        <span class="k">return</span><span class="p">(</span> <span class="n">xys1d</span> <span class="p">)</span></div>

<div class="viewcode-block" id="WeightedFunctionals.fixDomains"><a class="viewcode-back" href="../../../../fudge/fudge.productData.distributions.html#fudge.productData.distributions.energy.WeightedFunctionals.fixDomains">[docs]</a>    <span class="k">def</span> <span class="nf">fixDomains</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">energyMin</span><span class="p">,</span> <span class="n">energyMax</span><span class="p">,</span> <span class="n">domainToFix</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calls the **fixDomains** for each **weight** of *self*.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">numberOfFixes</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">weight</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span> <span class="n">numberOfFixes</span> <span class="o">+=</span> <span class="n">weight</span><span class="o">.</span><span class="n">fixDomains</span><span class="p">(</span><span class="n">energyMin</span><span class="p">,</span> <span class="n">energyMax</span><span class="p">,</span> <span class="n">domainToFix</span><span class="p">)</span>

        <span class="k">return</span>  <span class="n">numberOfFixes</span></div>

<div class="viewcode-block" id="WeightedFunctionals.sqrtEp_AverageAtE"><a class="viewcode-back" href="../../../../fudge/fudge.productData.distributions.html#fudge.productData.distributions.energy.WeightedFunctionals.sqrtEp_AverageAtE">[docs]</a>    <span class="k">def</span> <span class="nf">sqrtEp_AverageAtE</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">E</span> <span class="p">)</span> <span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This method has not been implemented. It returns None so the method uncorrelated.calculateAverageProductData will still work</span>
<span class="sd">        when calculating the momentum deposition for isotropic scattering in the lab frame, but will execute a raise otherwise.</span>

<span class="sd">        :param E:       The energy of the projectile.</span>

<span class="sd">        :return:        Python None</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span><span class="p">(</span> <span class="kc">None</span> <span class="p">)</span></div>

<div class="viewcode-block" id="WeightedFunctionals.getEnergyArray"><a class="viewcode-back" href="../../../../fudge/fudge.productData.distributions.html#fudge.productData.distributions.energy.WeightedFunctionals.getEnergyArray">[docs]</a>    <span class="k">def</span> <span class="nf">getEnergyArray</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">EMin</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">EMax</span> <span class="o">=</span> <span class="kc">None</span> <span class="p">)</span> <span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This method returns the list of projectile energies that *self* is specific at.</span>

<span class="sd">        :parem EMin:        If *self* does not have an projectile energy values, the default minimum energy to return.</span>
<span class="sd">        :parem EMax:        If *self* does not have an projectile energy values, the default maximum energy to return.</span>

<span class="sd">        :return:            Python list of float.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">energyArray</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">weight</span> <span class="ow">in</span> <span class="bp">self</span> <span class="p">:</span>
            <span class="k">for</span> <span class="n">energy</span> <span class="ow">in</span> <span class="n">weight</span><span class="o">.</span><span class="n">getEnergyArray</span><span class="p">(</span> <span class="n">EMin</span><span class="p">,</span> <span class="n">EMax</span> <span class="p">)</span> <span class="p">:</span>
                <span class="k">if</span><span class="p">(</span> <span class="n">energy</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">energyArray</span> <span class="p">)</span> <span class="p">:</span> <span class="n">energyArray</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="n">energy</span> <span class="p">)</span>
        <span class="n">energyArray</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span> <span class="p">)</span>
        <span class="k">return</span><span class="p">(</span> <span class="n">energyArray</span> <span class="p">)</span></div>

<div class="viewcode-block" id="WeightedFunctionals.to_xs_pdf_cdf1d"><a class="viewcode-back" href="../../../../fudge/fudge.productData.distributions.html#fudge.productData.distributions.energy.WeightedFunctionals.to_xs_pdf_cdf1d">[docs]</a>    <span class="k">def</span> <span class="nf">to_xs_pdf_cdf1d</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">style</span><span class="p">,</span> <span class="n">tempInfo</span><span class="p">,</span> <span class="n">indent</span><span class="p">):</span>

        <span class="n">count</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">([</span><span class="mi">1</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">weighted</span><span class="o">.</span><span class="n">functional</span><span class="p">,</span> <span class="n">XYs2d</span><span class="p">)</span> <span class="k">else</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">weighted</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">weights</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">count</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>

        <span class="k">if</span> <span class="n">count</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">weights</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s1">&#39;This needs work!.&#39;</span><span class="p">)</span>

        <span class="n">weightedFunctionals</span> <span class="o">=</span> <span class="n">WeightedFunctionals</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">weighted</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">weights</span><span class="p">:</span>
            <span class="n">functional</span> <span class="o">=</span> <span class="n">weighted</span><span class="o">.</span><span class="n">functional</span><span class="o">.</span><span class="n">to_xs_pdf_cdf1d</span><span class="p">(</span><span class="n">style</span><span class="p">,</span> <span class="n">tempInfo</span><span class="p">,</span> <span class="n">indent</span><span class="p">)</span>
            <span class="n">weightedFunctionals</span><span class="o">.</span><span class="n">addWeight</span><span class="p">(</span><span class="n">Weighted</span><span class="p">(</span><span class="n">weighted</span><span class="o">.</span><span class="n">weight</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span> <span class="p">),</span> <span class="n">functional</span><span class="p">))</span>

        <span class="k">return</span> <span class="n">weightedFunctionals</span></div>

<div class="viewcode-block" id="WeightedFunctionals.toPointwise_withLinearXYs"><a class="viewcode-back" href="../../../../fudge/fudge.productData.distributions.html#fudge.productData.distributions.energy.WeightedFunctionals.toPointwise_withLinearXYs">[docs]</a>    <span class="k">def</span> <span class="nf">toPointwise_withLinearXYs</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span> <span class="p">)</span> <span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a pointwise represent of *self*.</span>

<span class="sd">        :param kwargs:              A dictionary that contains data to control the way this method acts.</span>

<span class="sd">        :return:                    An :py:class:`XYs2d` instance.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span><span class="p">(</span> <span class="nb">len</span><span class="p">(</span> <span class="bp">self</span> <span class="p">)</span> <span class="o">&gt;</span> <span class="mi">2</span> <span class="p">)</span> <span class="p">:</span> <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span> <span class="s1">&#39;more than two weights currently not supported&#39;</span> <span class="p">)</span>
        <span class="n">E_ins</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">weighted_</span> <span class="ow">in</span> <span class="bp">self</span> <span class="p">:</span>
            <span class="n">w</span> <span class="o">=</span> <span class="n">weighted_</span><span class="o">.</span><span class="n">weight</span><span class="o">.</span><span class="n">toPointwise_withLinearXYs</span><span class="p">(</span> <span class="o">**</span><span class="n">kwargs</span> <span class="p">)</span>
            <span class="n">e</span> <span class="o">=</span> <span class="n">weighted_</span><span class="o">.</span><span class="n">functional</span><span class="o">.</span><span class="n">toPointwise_withLinearXYs</span><span class="p">(</span> <span class="o">**</span><span class="n">kwargs</span> <span class="p">)</span>
            <span class="n">data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="p">[</span> <span class="n">w</span><span class="p">,</span> <span class="n">e</span> <span class="p">]</span> <span class="p">)</span>
            <span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">w</span> <span class="p">:</span>
                <span class="k">if</span><span class="p">(</span> <span class="n">x</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">E_ins</span> <span class="p">)</span> <span class="p">:</span> <span class="n">E_ins</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="n">x</span> <span class="p">)</span>
            <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">e</span> <span class="p">:</span>
                <span class="k">if</span><span class="p">(</span> <span class="n">x</span><span class="o">.</span><span class="n">outerDomainValue</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">E_ins</span> <span class="p">)</span> <span class="p">:</span> <span class="n">E_ins</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="n">x</span><span class="o">.</span><span class="n">outerDomainValue</span> <span class="p">)</span>
        <span class="n">E_ins</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span> <span class="p">)</span>
        <span class="n">pwl</span> <span class="o">=</span> <span class="n">XYs2d</span><span class="p">(</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">defaultAxes</span><span class="p">(</span> <span class="bp">self</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">weight</span><span class="o">.</span><span class="n">domainUnit</span> <span class="p">)</span> <span class="p">)</span>
        <span class="k">for</span> <span class="n">E_in</span> <span class="ow">in</span> <span class="n">E_ins</span> <span class="p">:</span>
            <span class="n">wv1</span><span class="p">,</span> <span class="n">ev1</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">wv2</span><span class="p">,</span> <span class="n">ev2</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">w1</span><span class="p">,</span> <span class="n">w2</span> <span class="o">=</span> <span class="n">wv1</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span> <span class="n">E_in</span> <span class="p">),</span> <span class="n">wv2</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span> <span class="n">E_in</span> <span class="p">)</span>
            <span class="k">if</span><span class="p">(</span> <span class="n">w1</span> <span class="o">==</span> <span class="mi">1</span> <span class="p">)</span> <span class="p">:</span>
                <span class="n">e</span> <span class="o">=</span> <span class="n">ev1</span><span class="o">.</span><span class="n">getSpectrumAtEnergy</span><span class="p">(</span> <span class="n">E_in</span> <span class="p">)</span>
            <span class="k">elif</span><span class="p">(</span> <span class="n">w2</span> <span class="o">==</span> <span class="mi">1</span> <span class="p">)</span> <span class="p">:</span>
                <span class="n">e</span> <span class="o">=</span> <span class="n">ev2</span><span class="o">.</span><span class="n">getSpectrumAtEnergy</span><span class="p">(</span> <span class="n">E_in</span> <span class="p">)</span>
            <span class="k">else</span> <span class="p">:</span>
                <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span> <span class="s1">&#39;One weight must be zero: </span><span class="si">%s</span><span class="s1">, </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span> <span class="n">w1</span><span class="p">,</span> <span class="n">w2</span> <span class="p">)</span> <span class="p">)</span>
            <span class="n">e</span><span class="o">.</span><span class="n">outerDomainValue</span> <span class="o">=</span> <span class="n">E_in</span>
            <span class="n">e</span><span class="o">.</span><span class="n">normalize</span><span class="p">(</span> <span class="n">insitu</span> <span class="o">=</span> <span class="kc">True</span> <span class="p">)</span>
            <span class="n">pwl</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="n">e</span> <span class="p">)</span>
        <span class="k">return</span><span class="p">(</span> <span class="n">pwl</span> <span class="p">)</span></div>

<div class="viewcode-block" id="WeightedFunctionals.toXML_strList"><a class="viewcode-back" href="../../../../fudge/fudge.productData.distributions.html#fudge.productData.distributions.energy.WeightedFunctionals.toXML_strList">[docs]</a>    <span class="k">def</span> <span class="nf">toXML_strList</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">indent</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span> <span class="p">)</span> <span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a list of str instances representing the XML lines of *self*.</span>

<span class="sd">        :param indent:          The minimum amount of indentation.</span>
<span class="sd">        :param kwargs:          A dictionary of extra arguments that controls how *self* is converted to a list of XML strings.</span>

<span class="sd">        :return:                List of str instances representing the XML lines of self.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">indent2</span> <span class="o">=</span> <span class="n">indent</span> <span class="o">+</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span> <span class="s1">&#39;incrementalIndent&#39;</span><span class="p">,</span> <span class="s1">&#39;  &#39;</span> <span class="p">)</span>

        <span class="n">xmlString</span> <span class="o">=</span> <span class="p">[</span> <span class="bp">self</span><span class="o">.</span><span class="n">XMLStartTagString</span><span class="p">(</span> <span class="n">indent</span> <span class="o">=</span> <span class="n">indent</span> <span class="p">)</span> <span class="p">]</span>
        <span class="k">for</span> <span class="n">_subform</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">weights</span> <span class="p">:</span> <span class="n">xmlString</span> <span class="o">+=</span> <span class="n">_subform</span><span class="o">.</span><span class="n">toXML_strList</span><span class="p">(</span> <span class="n">indent2</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span> <span class="p">)</span>
        <span class="n">xmlString</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+=</span> <span class="s1">&#39;&lt;/</span><span class="si">%s</span><span class="s1">&gt;&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">moniker</span>
        <span class="k">return</span><span class="p">(</span> <span class="n">xmlString</span> <span class="p">)</span></div>

<div class="viewcode-block" id="WeightedFunctionals.parseNodeUsingClass"><a class="viewcode-back" href="../../../../fudge/fudge.productData.distributions.html#fudge.productData.distributions.energy.WeightedFunctionals.parseNodeUsingClass">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">parseNodeUsingClass</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">node</span><span class="p">,</span> <span class="n">xPath</span><span class="p">,</span> <span class="n">linkData</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Parse *node* into an instance of *cls*.</span>

<span class="sd">        :param cls:         Form class to return.</span>
<span class="sd">        :param node:        Node to parse.</span>
<span class="sd">        :param xPath:       List containing xPath to current node, useful mostly for debugging.</span>
<span class="sd">        :param linkData:    dict that collects unresolved links.</span>
<span class="sd">        :param kwargs:      A dictionary of extra arguments that controls how *self* is converted to a list of XML strings.</span>

<span class="sd">        :return: an instance of *cls* representing *node*.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">xPath</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">tag</span><span class="p">)</span>

        <span class="n">WF</span> <span class="o">=</span> <span class="bp">cls</span><span class="p">()</span>

        <span class="k">for</span> <span class="n">child</span> <span class="ow">in</span> <span class="n">node</span><span class="p">:</span> <span class="n">WF</span><span class="o">.</span><span class="n">addWeight</span><span class="p">(</span><span class="n">Weighted</span><span class="o">.</span><span class="n">parseNodeUsingClass</span><span class="p">(</span><span class="n">child</span><span class="p">,</span> <span class="n">xPath</span><span class="p">,</span> <span class="n">linkData</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">))</span>

        <span class="n">xPath</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span> <span class="p">)</span>

        <span class="k">return</span> <span class="n">WF</span></div></div>

<div class="viewcode-block" id="EnergyFunctionalDataToPointwise"><a class="viewcode-back" href="../../../../fudge/fudge.productData.distributions.html#fudge.productData.distributions.energy.EnergyFunctionalDataToPointwise">[docs]</a><span class="k">class</span> <span class="nc">EnergyFunctionalDataToPointwise</span> <span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    For internal use. This class is used by the methods toPointwise_withLinearXYs of the 2d functional energy distribution</span>
<span class="sd">    to convert the functional into an :py:class:`XYs2d` instance.</span>

<span class="sd">    :param data:            An instance of the 2d functional energy distribution.</span>
<span class="sd">    :param evaluateAtX:     A function that evaluates the 2d functional energy distribution at a specific projectile energy.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">evaluateAtX</span> <span class="p">)</span> <span class="p">:</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">data</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">evaluateAtX</span> <span class="o">=</span> <span class="n">evaluateAtX</span>

<div class="viewcode-block" id="EnergyFunctionalDataToPointwise.toPointwise_withLinearXYs"><a class="viewcode-back" href="../../../../fudge/fudge.productData.distributions.html#fudge.productData.distributions.energy.EnergyFunctionalDataToPointwise.toPointwise_withLinearXYs">[docs]</a>    <span class="k">def</span> <span class="nf">toPointwise_withLinearXYs</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span> <span class="p">)</span> <span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a pointwise represent of *self*.</span>

<span class="sd">        :param kwargs:              A dictionary that contains data to control the way this method acts.</span>

<span class="sd">        :return:                    An :py:class:`XYs2d` instance.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="kn">from</span> <span class="nn">fudge.core.math</span> <span class="kn">import</span> <span class="n">fudgemath</span>

        <span class="k">class</span> <span class="nc">Tester</span> <span class="p">:</span>

            <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">relativeTolerance</span><span class="p">,</span> <span class="n">absoluteTolerance</span><span class="p">,</span> <span class="n">evaluateAtX</span> <span class="p">)</span> <span class="p">:</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">relativeTolerance</span> <span class="o">=</span> <span class="n">relativeTolerance</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">absoluteTolerance</span> <span class="o">=</span> <span class="n">absoluteTolerance</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">evaluateAtX_</span> <span class="o">=</span> <span class="n">evaluateAtX</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">setParameter1</span><span class="p">(</span> <span class="mf">1.</span> <span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">setParameter2</span><span class="p">(</span> <span class="mf">1.</span> <span class="p">)</span>

            <span class="k">def</span> <span class="nf">evaluateAtX</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">x</span> <span class="p">)</span> <span class="p">:</span>

                <span class="k">return</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">evaluateAtX_</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">x</span> <span class="p">)</span> <span class="p">)</span>

            <span class="k">def</span> <span class="nf">setParameter1</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">p1</span> <span class="p">)</span> <span class="p">:</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">p1</span> <span class="o">=</span> <span class="n">p1</span>

            <span class="k">def</span> <span class="nf">setParameter2</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">p2</span> <span class="p">)</span> <span class="p">:</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">p2</span> <span class="o">=</span> <span class="n">p2</span>

        <span class="n">accuracy</span> <span class="o">=</span> <span class="n">xDataBaseModule</span><span class="o">.</span><span class="n">getArguments</span><span class="p">(</span> <span class="n">kwargs</span><span class="p">,</span> <span class="p">{</span> <span class="s1">&#39;accuracy&#39;</span> <span class="p">:</span> <span class="n">XYs1dModule</span><span class="o">.</span><span class="n">defaultAccuracy</span> <span class="p">}</span> <span class="p">)[</span><span class="s1">&#39;accuracy&#39;</span><span class="p">]</span>

        <span class="n">parameter1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">parameter1</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">toPointwise_withLinearXYs</span><span class="p">(</span> <span class="o">**</span><span class="n">kwargs</span> <span class="p">)</span>
        <span class="n">axes</span> <span class="o">=</span> <span class="n">defaultAxes</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">domainUnit</span> <span class="p">)</span>
        <span class="n">pwl</span> <span class="o">=</span> <span class="n">XYs2d</span><span class="p">(</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">axes</span> <span class="p">)</span>
<span class="c1"># BRB6 hardwired</span>
        <span class="n">one_eV</span> <span class="o">=</span> <span class="n">PQUModule</span><span class="o">.</span><span class="n">PQU</span><span class="p">(</span> <span class="s1">&#39;1 eV&#39;</span> <span class="p">)</span><span class="o">.</span><span class="n">getValueAs</span><span class="p">(</span> <span class="n">axes</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">unit</span> <span class="p">)</span>

        <span class="n">t</span> <span class="o">=</span> <span class="n">Tester</span><span class="p">(</span> <span class="n">accuracy</span><span class="p">,</span> <span class="mf">1e-10</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">evaluateAtX</span> <span class="p">)</span>
        <span class="n">parameter2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">parameter2</span>
        <span class="k">if</span><span class="p">(</span> <span class="n">parameter2</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">)</span> <span class="p">:</span> <span class="n">parameter2</span> <span class="o">=</span> <span class="n">parameter2</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">toPointwise_withLinearXYs</span><span class="p">(</span> <span class="o">**</span><span class="n">kwargs</span> <span class="p">)</span>
        <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">E_in_p1</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span> <span class="n">parameter1</span> <span class="p">)</span> <span class="p">:</span>
            <span class="n">E_in</span><span class="p">,</span> <span class="n">p1</span> <span class="o">=</span> <span class="n">E_in_p1</span>
            <span class="n">EpMax</span> <span class="o">=</span> <span class="n">E_in</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">U</span><span class="o">.</span><span class="n">value</span>
            <span class="n">EpMin</span> <span class="o">=</span> <span class="mf">0.</span>              <span class="c1"># Only used with debugging.</span>
            <span class="k">if</span><span class="p">(</span> <span class="n">EpMax</span> <span class="o">==</span> <span class="mf">0.</span> <span class="p">)</span> <span class="p">:</span>
                <span class="k">if</span><span class="p">(</span> <span class="n">index</span> <span class="o">!=</span> <span class="mi">0</span> <span class="p">)</span> <span class="p">:</span> <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span> <span class="s2">&quot;i = </span><span class="si">%d</span><span class="s2">, E_in = </span><span class="si">%s</span><span class="s2">, U = </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span> <span class="n">index</span><span class="p">,</span> <span class="n">E_in</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">U</span><span class="o">.</span><span class="n">value</span> <span class="p">)</span> <span class="p">)</span>
                <span class="n">EpMax</span> <span class="o">=</span> <span class="n">E_in</span> <span class="o">*</span> <span class="mf">1e-6</span>
                <span class="k">if</span><span class="p">(</span> <span class="n">EpMax</span> <span class="o">==</span> <span class="mf">0.</span> <span class="p">)</span> <span class="p">:</span>
                    <span class="n">EpMax</span> <span class="o">=</span> <span class="n">parameter1</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="mf">1e-6</span>         <span class="c1"># This and the next line are arbitary.</span>
                <span class="k">if</span><span class="p">(</span> <span class="n">EpMax</span> <span class="o">&gt;</span> <span class="mf">1e-3</span> <span class="p">)</span> <span class="p">:</span> <span class="n">EpMax</span> <span class="o">=</span> <span class="mf">2e-5</span>
                <span class="n">data</span> <span class="o">=</span> <span class="p">[</span> <span class="p">[</span> <span class="n">EpMin</span><span class="p">,</span> <span class="mf">1.</span> <span class="p">],</span> <span class="p">[</span> <span class="n">EpMax</span><span class="p">,</span> <span class="mf">1e-10</span> <span class="p">]</span> <span class="p">]</span>
            <span class="k">else</span> <span class="p">:</span>
                <span class="n">t</span><span class="o">.</span><span class="n">setParameter1</span><span class="p">(</span> <span class="n">p1</span> <span class="p">)</span>
                <span class="k">if</span><span class="p">(</span> <span class="n">parameter2</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">)</span> <span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">setParameter2</span><span class="p">(</span> <span class="n">parameter2</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span> <span class="n">E_in</span> <span class="p">)</span> <span class="p">)</span>
                <span class="n">level</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="p">[</span> <span class="p">[</span> <span class="n">EpMin</span><span class="p">,</span> <span class="n">t</span><span class="o">.</span><span class="n">evaluateAtX</span><span class="p">(</span> <span class="n">EpMin</span> <span class="p">)</span> <span class="p">],</span> <span class="p">[</span> <span class="n">EpMax</span><span class="p">,</span> <span class="n">t</span><span class="o">.</span><span class="n">evaluateAtX</span><span class="p">(</span> <span class="n">EpMax</span> <span class="p">)</span> <span class="p">]</span> <span class="p">]</span>
                <span class="k">while</span><span class="p">(</span> <span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mf">1e-10</span> <span class="p">)</span> <span class="p">:</span>               <span class="c1"># Fill in some tail points while they are &lt; 1e-10</span>
                    <span class="n">level</span><span class="p">,</span> <span class="n">EpMax</span> <span class="o">=</span> <span class="n">level</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">EpMax</span>
                    <span class="n">data</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span> <span class="mi">1</span><span class="p">,</span> <span class="p">[</span> <span class="n">EpMax</span><span class="p">,</span> <span class="n">t</span><span class="o">.</span><span class="n">evaluateAtX</span><span class="p">(</span> <span class="n">EpMax</span> <span class="p">)</span> <span class="p">]</span> <span class="p">)</span>
                    <span class="k">if</span><span class="p">(</span> <span class="n">level</span> <span class="o">&gt;</span> <span class="mi">10</span> <span class="p">)</span> <span class="p">:</span> <span class="k">break</span>
                <span class="k">if</span><span class="p">(</span> <span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">one_eV</span> <span class="p">)</span> <span class="p">:</span>
                    <span class="k">if</span><span class="p">(</span> <span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mf">1e6</span> <span class="o">*</span> <span class="n">one_eV</span> <span class="p">)</span> <span class="p">:</span> <span class="n">data</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span> <span class="mi">1</span><span class="p">,</span>  <span class="p">[</span> <span class="mf">1e6</span> <span class="o">*</span> <span class="n">one_eV</span><span class="p">,</span> <span class="n">t</span><span class="o">.</span><span class="n">evaluateAtX</span><span class="p">(</span> <span class="mf">1e6</span> <span class="o">*</span> <span class="n">one_eV</span> <span class="p">)</span> <span class="p">]</span> <span class="p">)</span>
                    <span class="k">if</span><span class="p">(</span> <span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mf">1e3</span> <span class="o">*</span> <span class="n">one_eV</span> <span class="p">)</span> <span class="p">:</span> <span class="n">data</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span> <span class="mi">1</span><span class="p">,</span>  <span class="p">[</span> <span class="mf">1e3</span> <span class="o">*</span> <span class="n">one_eV</span><span class="p">,</span> <span class="n">t</span><span class="o">.</span><span class="n">evaluateAtX</span><span class="p">(</span> <span class="mf">1e3</span> <span class="o">*</span> <span class="n">one_eV</span> <span class="p">)</span> <span class="p">]</span> <span class="p">)</span>
                    <span class="k">if</span><span class="p">(</span> <span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">one_eV</span> <span class="p">)</span> <span class="p">:</span> <span class="n">data</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span> <span class="mi">1</span><span class="p">,</span>  <span class="p">[</span> <span class="n">one_eV</span><span class="p">,</span> <span class="n">t</span><span class="o">.</span><span class="n">evaluateAtX</span><span class="p">(</span> <span class="n">one_eV</span> <span class="p">)</span> <span class="p">]</span> <span class="p">)</span>
                <span class="n">data</span> <span class="o">=</span> <span class="n">fudgemath</span><span class="o">.</span><span class="n">thickenXYList</span><span class="p">(</span> <span class="n">data</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">biSectionMax</span> <span class="o">=</span> <span class="mi">10</span> <span class="p">)</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">XYs1d</span><span class="p">(</span> <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="p">,</span> <span class="n">outerDomainValue</span> <span class="o">=</span> <span class="n">E_in</span> <span class="p">)</span>
            <span class="n">data</span><span class="o">.</span><span class="n">normalize</span><span class="p">(</span> <span class="n">insitu</span> <span class="o">=</span> <span class="kc">True</span> <span class="p">)</span>
            <span class="n">pwl</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="n">data</span> <span class="p">)</span>
        <span class="k">return</span><span class="p">(</span> <span class="n">pwl</span> <span class="p">)</span></div></div>

<div class="viewcode-block" id="Form"><a class="viewcode-back" href="../../../../fudge/fudge.productData.distributions.html#fudge.productData.distributions.energy.Form">[docs]</a><span class="k">class</span> <span class="nc">Form</span><span class="p">(</span> <span class="n">baseModule</span><span class="o">.</span><span class="n">Form</span> <span class="p">)</span> <span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This class stores the enegy distribution part (i.e., :math:`P(E&#39;|E)`) for an uncorrelated distribution.</span>

<span class="sd">    The following table list the primary members of this class:</span>
<span class="sd">    </span>
<span class="sd">    +-------------------+-----------------------------------------------------------+</span>
<span class="sd">    | Member            | Description                                               |</span>
<span class="sd">    +===================+===========================================================+</span>
<span class="sd">    | energySubform     | 2d energy distribution.                                   |</span>
<span class="sd">    +-------------------+-----------------------------------------------------------+</span>
<span class="sd">    </span>
<span class="sd">    :param label:               The label for this form.</span>
<span class="sd">    :param productFrame:        The frame the product data are specified in.</span>
<span class="sd">    :param energySubform:       An :py:class:`Subform` representing the energy data.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">moniker</span> <span class="o">=</span> <span class="s1">&#39;energy&#39;</span>
    <span class="n">subformAttributes</span> <span class="o">=</span> <span class="p">(</span> <span class="s1">&#39;energySubform&#39;</span><span class="p">,</span> <span class="p">)</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">label</span><span class="p">,</span> <span class="n">productFrame</span><span class="p">,</span> <span class="n">energySubform</span> <span class="p">)</span> <span class="p">:</span>

        <span class="k">if</span><span class="p">(</span> <span class="ow">not</span><span class="p">(</span> <span class="nb">isinstance</span><span class="p">(</span> <span class="n">energySubform</span><span class="p">,</span> <span class="n">Subform</span> <span class="p">)</span> <span class="p">)</span> <span class="p">)</span> <span class="p">:</span> <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span> <span class="s1">&#39;instance is not an energy subform&#39;</span> <span class="p">)</span>
        <span class="n">baseModule</span><span class="o">.</span><span class="n">Form</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">label</span><span class="p">,</span> <span class="n">productFrame</span><span class="p">,</span> <span class="p">(</span> <span class="n">energySubform</span><span class="p">,</span> <span class="p">)</span> <span class="p">)</span>

<div class="viewcode-block" id="Form.parseNodeUsingClass"><a class="viewcode-back" href="../../../../fudge/fudge.productData.distributions.html#fudge.productData.distributions.energy.Form.parseNodeUsingClass">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">parseNodeUsingClass</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">energyElement</span><span class="p">,</span> <span class="n">xPath</span><span class="p">,</span> <span class="n">linkData</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Parse *energyElement* into an instance of *cls*.</span>

<span class="sd">        :param cls:             Form class to return.</span>
<span class="sd">        :param energyElement:   Node to parse.</span>
<span class="sd">        :param xPath:           List containing xPath to current node, useful mostly for debugging.</span>
<span class="sd">        :param linkData:        dict that collects unresolved links.</span>
<span class="sd">        :param kwargs:          A dictionary of extra arguments that controls how *self* is converted to a list of XML strings.</span>

<span class="sd">        :return: an instance of *cls* representing *energyElement*.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">subformClass</span> <span class="o">=</span> <span class="p">{</span>
                <span class="n">DiscreteGamma</span><span class="o">.</span><span class="n">moniker</span> <span class="p">:</span>             <span class="n">DiscreteGamma</span><span class="p">,</span>
                <span class="n">PrimaryGamma</span><span class="o">.</span><span class="n">moniker</span> <span class="p">:</span>              <span class="n">PrimaryGamma</span><span class="p">,</span>
                <span class="n">XYs2d</span><span class="o">.</span><span class="n">moniker</span> <span class="p">:</span>                     <span class="n">XYs2d</span><span class="p">,</span>
                <span class="n">Regions2d</span><span class="o">.</span><span class="n">moniker</span> <span class="p">:</span>                 <span class="n">Regions2d</span><span class="p">,</span>
                <span class="n">GeneralEvaporation</span><span class="o">.</span><span class="n">moniker</span> <span class="p">:</span>        <span class="n">GeneralEvaporation</span><span class="p">,</span>
                <span class="n">Watt</span><span class="o">.</span><span class="n">moniker</span> <span class="p">:</span>                      <span class="n">Watt</span><span class="p">,</span>
                <span class="n">MadlandNix</span><span class="o">.</span><span class="n">moniker</span> <span class="p">:</span>                <span class="n">MadlandNix</span><span class="p">,</span>
                <span class="n">SimpleMaxwellianFission</span><span class="o">.</span><span class="n">moniker</span> <span class="p">:</span>   <span class="n">SimpleMaxwellianFission</span><span class="p">,</span>
                <span class="n">Evaporation</span><span class="o">.</span><span class="n">moniker</span> <span class="p">:</span>               <span class="n">Evaporation</span><span class="p">,</span>
                <span class="n">WeightedFunctionals</span><span class="o">.</span><span class="n">moniker</span> <span class="p">:</span>       <span class="n">WeightedFunctionals</span><span class="p">,</span>
                <span class="n">NBodyPhaseSpace</span><span class="o">.</span><span class="n">moniker</span> <span class="p">:</span>           <span class="n">NBodyPhaseSpace</span><span class="p">,</span>
            <span class="p">}</span><span class="o">.</span><span class="n">get</span><span class="p">(</span> <span class="n">energyElement</span><span class="o">.</span><span class="n">tag</span> <span class="p">)</span>
        <span class="k">if</span><span class="p">(</span> <span class="n">subformClass</span> <span class="ow">is</span> <span class="kc">None</span> <span class="p">)</span> <span class="p">:</span> <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span> <span class="s2">&quot;encountered unknown energy subform: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">energyElement</span><span class="o">.</span><span class="n">tag</span> <span class="p">)</span>

        <span class="n">energyForm</span> <span class="o">=</span> <span class="n">subformClass</span><span class="o">.</span><span class="n">parseNodeUsingClass</span><span class="p">(</span><span class="n">energyElement</span><span class="p">,</span> <span class="n">xPath</span><span class="p">,</span> <span class="n">linkData</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="k">return</span><span class="p">(</span> <span class="n">energyForm</span> <span class="p">)</span></div></div>
</pre></div>

            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../../../../index.html">
              <img class="logo" src="../../../../_static/gnd.png" alt="Logo"/>
            </a></p>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../../../index.html">Fudge and GNDS 6.1.0 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../../index.html" >Module code</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">fudge.productData.distributions.energy</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2012, B.Beck, D. Brown, C. Mattoon, N. Patel, N. Summers.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 5.0.2.
    </div>
  </body>
</html>