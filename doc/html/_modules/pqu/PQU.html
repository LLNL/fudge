
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>pqu.PQU &#8212; Fudge and GNDS 6.1.0 documentation</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/classic.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/graphviz.css" />
    
    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../_static/doctools.js"></script>
    
    <link rel="shortcut icon" href="../../_static/gnd-20121206-favicon.ico"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">Fudge and GNDS 6.1.0 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../index.html" accesskey="U">Module code</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">pqu.PQU</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <h1>Source code for pqu.PQU</h1><div class="highlight"><pre>
<span></span><span class="c1"># &lt;&lt;BEGIN-copyright&gt;&gt;</span>
<span class="c1"># &lt;&lt;END-copyright&gt;&gt;</span>

<span class="c1"># Notes.</span>
<span class="c1"># Need sphinx 1.1 or higher to use &quot;:private-members:&quot; parameter in PQU.rst. This is why :py:meth:`PQU._getOtherAsPQU` do not display properly.</span>

<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">---------------------------</span>
<span class="sd">Introduction</span>
<span class="sd">---------------------------</span>

<span class="sd">This module contains classes and functions for representing and manipulating a value with units and uncertainty, </span>
<span class="sd">herein called a &quot;Physical Quantity with Uncertainty&quot; or :py:class:`PQU`. For example, if the distance between start and </span>
<span class="sd">finish lines is measured to be &#39;100.1 m&#39; with an uncertainty of &#39;0.4 m&#39;, it can be inputted to :py:class:`PQU` as the string</span>
<span class="sd">&#39;100.1(4) m&#39; or &#39;100.1 +/- 0.4 m&#39; (both are allowed input forms as well as several others - see :py:class:`PQU`). </span>

<span class="sd">From this module, most users should only need the :py:class:`PQU` class which stores a :py:class:`PQU` object and</span>
<span class="sd">supports common math operations (e.g., addition, subtraction, multiplication) including the operation on </span>
<span class="sd">the units and uncertainty. </span>
<span class="sd">For example, if a person races between the start and finish lines in a time of &#39;16.3 +/- 0.1 s&#39;, the :py:class:`PQU` class can </span>
<span class="sd">be used to determine the person&#39;s speed as:</span>

<span class="sd">&gt;&gt;&gt; from pqu import PQU</span>
<span class="sd">&gt;&gt;&gt; distance = PQU.PQU( &#39;100.1(4) m&#39; )</span>
<span class="sd">&gt;&gt;&gt; time = PQU.PQU( &#39;16.3 +/- 0.1 s&#39; )</span>
<span class="sd">&gt;&gt;&gt; speed = distance / time</span>
<span class="sd">&gt;&gt;&gt; print(speed)</span>
<span class="sd">6.14 +/- 0.04 m/s</span>
<span class="sd">&gt;&gt;&gt; print(speed.copyToUnit( &#39;mi/h&#39; ))</span>
<span class="sd">13.7 +/- 0.1 mi/h</span>

<span class="sd">As this example shows, in addition to calculating the speed and unit, the :py:class:`PQU` class also propagated the significant digits and the uncertainty. In this example</span>
<span class="sd">the uncertainty was propagated using Goodman&#39;s expression for uncorrelated values (see `Uncertainty propagation`_). The</span>
<span class="sd">propagation of significant digits explains why the printed speed has only 3 digits. The following Python code illustrates</span>
<span class="sd">significant digits for the speed calculation:</span>

<span class="sd">&gt;&gt;&gt; print(100.1 / 16.3)</span>
<span class="sd">6.14110429448</span>
<span class="sd">&gt;&gt;&gt; print(float( speed ))</span>
<span class="sd">6.14110429448</span>
<span class="sd">&gt;&gt;&gt; print(speed.info( ))</span>
<span class="sd">value = 6.14110429447852724e+00, significantDigits = 3, order = 0, isPercent = False, unit = &quot;m/s&quot;</span>
<span class="sd">uncertainty = value = 4.49629906071862956e-02, significantDigits = 1, order = -2, isPercent = False</span>

<span class="sd">As can be seen, the internal speed value is as expected. However, since the :py:class:`PQU` class (with the help</span>
<span class="sd">of the :py:class:`PQU_float` class) tracks a value&#39;s significant digits, when a :py:class:`PQU` instance is printed (via the __str__</span>
<span class="sd">method), only at most &#39;significantDigits&#39; are displayed. The allowed range for &#39;significantDigits&#39; is</span>
<span class="sd">1 to sys.float_info.dig + 1 inclusive. For addition and subtraction, the member &#39;order&#39; is also required and</span>
<span class="sd">is why the following output is the same for both print statements:</span>

<span class="sd">&gt;&gt;&gt; print(distance)</span>
<span class="sd">100.1(4) m</span>
<span class="sd">&gt;&gt;&gt; print(distance + &#39;100.1(4) mum&#39;)        # note &#39;mum&#39; is micrometer</span>
<span class="sd">100.1 +/- 0.4 m</span>

<span class="sd">How is &#39;significantDigits&#39; determined? That depends on how :py:class:`PQU` is called. If a string without</span>
<span class="sd">uncertainty is entered as the only argument then &#39;significantDigits&#39; is the number of digits in the string</span>
<span class="sd">(ignoring leading &#39;0&#39;). Some examples are:</span>

<span class="sd">&gt;&gt;&gt; print(PQU.PQU( &#39;12.345&#39; ).info( ))</span>
<span class="sd">value = 1.23450000000000006e+01, significantDigits = 5, order = 1, isPercent = False, unit = &quot;&quot;</span>
<span class="sd">uncertainty = </span>
<span class="sd">&gt;&gt;&gt; print(PQU.PQU( &#39;12.34500&#39; ).info( ))</span>
<span class="sd">value = 1.23450000000000006e+01, significantDigits = 7, order = 1, isPercent = False, unit = &quot;&quot;</span>
<span class="sd">uncertainty = </span>
<span class="sd">&gt;&gt;&gt; print(PQU.PQU( &#39;12.34500e-12&#39; ).info( ))</span>
<span class="sd">value = 1.23450000000000004e-11, significantDigits = 7, order = -11, isPercent = False, unit = &quot;&quot;</span>
<span class="sd">uncertainty = </span>
<span class="sd">&gt;&gt;&gt; print(PQU.PQU( &#39;0012.34500e-12&#39; ).info( ))</span>
<span class="sd">value = 1.23450000000000004e-11, significantDigits = 7, order = -11, isPercent = False, unit = &quot;&quot;</span>
<span class="sd">uncertainty = </span>
<span class="sd">&gt;&gt;&gt; print(PQU.PQU( &#39;00.0012&#39; ).info( ))</span>
<span class="sd">value = 1.19999999999999989e-03, significantDigits = 2, order = -3, isPercent = False, unit = &quot;&quot;</span>
<span class="sd">uncertainty = </span>

<span class="sd">If the string has an uncertainty, then it is also used in calculating &#39;significantDigits&#39;.</span>
<span class="sd">Some examples are (note - these are the same as the last examples, with uncertainties added):</span>

<span class="sd">&gt;&gt;&gt; print(PQU.PQU( &#39;12.345 +/- 1e-8&#39; ).info( ))</span>
<span class="sd">value = 1.23450000000000006e+01, significantDigits = 10, order = 1, isPercent = False, unit = &quot;&quot;</span>
<span class="sd">uncertainty = value = 1.00000000000000002e-08, significantDigits = 1, order = -8, isPercent = False</span>
<span class="sd">&gt;&gt;&gt; print(PQU.PQU( &#39;12.345 +/- 1e-8&#39; ))</span>
<span class="sd">12.34500000 +/- 1.e-8</span>
<span class="sd">&gt;&gt;&gt; print(PQU.PQU( &#39;12.34500 +/- 0.12&#39; ).info( ))</span>
<span class="sd">value = 1.23450000000000006e+01, significantDigits = 4, order = 1, isPercent = False, unit = &quot;&quot;</span>
<span class="sd">uncertainty = value = 1.19999999999999996e-01, significantDigits = 2, order = -1, isPercent = False</span>
<span class="sd">&gt;&gt;&gt; print(PQU.PQU( &#39;12.34500 +/- 0.12&#39; ))</span>
<span class="sd">12.35 +/- 0.12</span>
<span class="sd">&gt;&gt;&gt; print(PQU.PQU( &#39;12.34500e-12(32)&#39; ).info( ))</span>
<span class="sd">value = 1.23450000000000004e-11, significantDigits = 7, order = -11, isPercent = False, unit = &quot;&quot;</span>
<span class="sd">uncertainty = value = 3.20000000000000023e-16, significantDigits = 2, order = -16, isPercent = False</span>
<span class="sd">&gt;&gt;&gt; print(PQU.PQU( &#39;12.34500e-12(32)&#39; ))</span>
<span class="sd">1.234500e-11(32)</span>
<span class="sd">&gt;&gt;&gt; print(PQU.PQU( &#39;0012.34500e-12 +/- 32e-15&#39; ).info( ))</span>
<span class="sd">value = 1.23450000000000004e-11, significantDigits = 5, order = -11, isPercent = False, unit = &quot;&quot;</span>
<span class="sd">uncertainty = value = 3.20000000000000025e-14, significantDigits = 2, order = -14, isPercent = False</span>
<span class="sd">&gt;&gt;&gt; print(PQU.PQU( &#39;0012.34500e-12 +/- 32e-15&#39; ))</span>
<span class="sd">1.2345e-11 +/- 3.2e-14</span>
<span class="sd">&gt;&gt;&gt; print(PQU.PQU( &#39;00.0012 +/- 0.000002&#39; ).info( ))</span>
<span class="sd">value = 1.19999999999999989e-03, significantDigits = 4, order = -3, isPercent = False, unit = &quot;&quot;</span>
<span class="sd">uncertainty = value = 1.99999999999999991e-06, significantDigits = 1, order = -6, isPercent = False</span>
<span class="sd">&gt;&gt;&gt; print(PQU.PQU( &#39;00.0012 +/- 0.000002&#39; ))</span>
<span class="sd">1.200e-3 +/- 2.e-6</span>

<span class="sd">The :py:class:`PQU` constructor (i.e., its __init__ method) allows various input options for creating an instance (see :py:class:`PQU`).</span>

<span class="sd">A :py:class:`PQU` object has three main members which are:</span>

<span class="sd">    * *value* which is stored as a :py:class:`PQU_float` instance,</span>
<span class="sd">    * *unit* which is stored as a :py:class:`PQU_uncertainty` instance,</span>
<span class="sd">    * *uncertainty* which is stored as a :py:class:`PQU_uncertainty` instance.</span>
<span class="sd">    </span>
<span class="sd">------------------------------------------------------------------------------------------</span>
<span class="sd">Units and conversions</span>
<span class="sd">------------------------------------------------------------------------------------------</span>

<span class="sd">This module uses the SI units along with units for angle and solid angle as its base units. The base units are:</span>

<span class="sd">    +-----------+-------+---------------------------+</span>
<span class="sd">    | Unit      | symbol| Measure                   |</span>
<span class="sd">    +===========+=======+===========================+</span>
<span class="sd">    | meter     | &#39;m&#39;   | length                    |</span>
<span class="sd">    +-----------+-------+---------------------------+</span>
<span class="sd">    | kilogram  | &#39;kg&#39;  | mass                      |</span>
<span class="sd">    +-----------+-------+---------------------------+</span>
<span class="sd">    | second    | &#39;s&#39;   | time                      |</span>
<span class="sd">    +-----------+-------+---------------------------+</span>
<span class="sd">    | Ampere    | &#39;A&#39;   | electrical current        |</span>
<span class="sd">    +-----------+-------+---------------------------+</span>
<span class="sd">    | Kelvin    | &#39;K&#39;   | thermodynamic temperature |</span>
<span class="sd">    +-----------+-------+---------------------------+</span>
<span class="sd">    | mole      | &#39;mol&#39; | amount of substance       |</span>
<span class="sd">    +-----------+-------+---------------------------+</span>
<span class="sd">    | candela   | &#39;cd&#39;  | luminous intensity        |</span>
<span class="sd">    +-----------+-------+---------------------------+</span>
<span class="sd">    | radian    | &#39;rad&#39; | angle                     | </span>
<span class="sd">    +-----------+-------+---------------------------+</span>
<span class="sd">    | steradian | &#39;sr&#39;  | solid angle               |</span>
<span class="sd">    +-----------+-------+---------------------------+</span>

<span class="sd">All other units are stored with these units as a base and a conversion factor. </span>
<span class="sd">For example, the unit for foot (&#39;ft&#39;) is stored as a meter with the conversion factor of 0.3048.</span>
<span class="sd">Any :py:class:`PQU` instance can be represented as a combination of each of these units with an associated power for each unit.</span>
<span class="sd">As example, a force has the base units &#39;kg&#39; and &#39;m&#39; to power 1 as well as &#39;s&#39; to power -2 (represented as the </span>
<span class="sd">string &#39;kg * m / s**2&#39;).  Two units are said to be compatible if they have the same power for each</span>
<span class="sd">base unit. Hence, &#39;ft&#39; is compatible with &#39;m&#39; but not &#39;kg&#39; or &#39;s&#39;. Furthermore, the electron-Volt (&#39;eV&#39;) is compatible</span>
<span class="sd">with Joule (&#39;J&#39;) and Watt-second (&#39;W * s&#39;) but not Watt (&#39;W&#39;).</span>

<span class="sd">The :py:class:`PQU` package has many defined units with prefixes (see `Defined prefixes and units`_). In general, the</span>
<span class="sd">PQU methods that operate on :py:class:`PQU` objects do not attempt to simplify the units, even if the result is dimensionless.</span>
<span class="sd">Note, to get rid of dimensionless units use the method :py:meth:`PQU.simplify`</span>
<span class="sd">For example, consider the division of &#39;3.2 m&#39; by 11.2 km:</span>

<span class="sd">&gt;&gt;&gt; from pqu import PQU</span>
<span class="sd">&gt;&gt;&gt; x = PQU.PQU( &#39;3.2 m&#39; )</span>
<span class="sd">&gt;&gt;&gt; y = PQU.PQU( &#39;11.2 km&#39; )</span>
<span class="sd">&gt;&gt;&gt; slope = x / y</span>
<span class="sd">&gt;&gt;&gt; print(slope)</span>
<span class="sd">0.29 m/km</span>
<span class="sd">&gt;&gt;&gt; dl = slope.copyToUnit( &quot;&quot; )</span>
<span class="sd">&gt;&gt;&gt; print(dl)</span>
<span class="sd">2.9e-4</span>
<span class="sd">&gt;&gt;&gt; slope.simplify()</span>
<span class="sd">PQU( &quot;2.9e-4&quot; )</span>

<span class="sd">Here the method :py:meth:`PQU.copyToUnit` is used to convert the units into a dimensionless form. Here is another</span>
<span class="sd">example showing the use of the :py:meth:`PQU.copyToUnit` method:</span>

<span class="sd">&gt;&gt;&gt; mass = PQU.PQU( &quot;4.321 g&quot; )</span>
<span class="sd">&gt;&gt;&gt; speed = PQU.PQU( &quot;1.234 inch / mus&quot;  )  </span>
<span class="sd">&gt;&gt;&gt; energy = mass * speed**2</span>
<span class="sd">&gt;&gt;&gt; print(energy)</span>
<span class="sd">6.580 inch**2*g/mus**2</span>
<span class="sd">&gt;&gt;&gt; energy_joules = energy.copyToUnit( &quot;J&quot; )</span>
<span class="sd">&gt;&gt;&gt; print(energy_joules)</span>
<span class="sd">4.245e6 J</span>

<span class="sd">The method :py:meth:`PQU.inUnitsOf` is useful for returning a physical quantity in units of descending compatible units. </span>
<span class="sd">For example, :py:meth:`PQU.inUnitsOf` will convert &#39;3123452.12 s&#39; into days, hours, minutes and seconds, or just hours and seconds as:</span>

<span class="sd">&gt;&gt;&gt; t = PQU.PQU( &#39;3123452.12 s&#39; )</span>
<span class="sd">&gt;&gt;&gt; t.inUnitsOf( &#39;d&#39;, &#39;h&#39;, &#39;min&#39;, &#39;s&#39; )</span>
<span class="sd">(PQU( &quot;36.0000000 d&quot; ), PQU( &quot;3.000000 h&quot; ), PQU( &quot;37.0000 min&quot; ), PQU( &quot;32.12 s&quot; ))</span>
<span class="sd">&gt;&gt;&gt; t.inUnitsOf( &#39;h&#39;,  &#39;s&#39; )</span>
<span class="sd">(PQU( &quot;867.000000 h&quot; ), PQU( &quot;2252.12 s&quot; ))</span>

<span class="sd">Also see the methods :py:meth:`PQU.convertToUnit` and :py:meth:`PQU.getValueAs`.</span>

<span class="sd">------------------------------------------------------------------------------------------</span>
<span class="sd">Changing non-hardwired constants</span>
<span class="sd">------------------------------------------------------------------------------------------</span>

<span class="sd">PQU has a set of defined constants that are hardwired and a set that are not hardwired. The non-hardwired</span>
<span class="sd">constants reside in the module pqu_constants.py and are import by :py:class:`PQU` when it is first loaded. It is </span>
<span class="sd">possible to change a non-hardwired constant by loading the pqu_constants.py module before :py:class:`PQU` is imported, redefining</span>
<span class="sd">the constant and then importing :py:class:`PQU`. For example, as of this writing the elementary charge is defined as &#39;1.60217653e-19 * C&#39;:</span>

<span class="sd">&gt;&gt;&gt; from pqu import PQU</span>
<span class="sd">&gt;&gt;&gt; eV = PQU.PQU( 1, &#39;eV&#39; )</span>
<span class="sd">&gt;&gt;&gt; print(eV)</span>
<span class="sd">1. eV</span>
<span class="sd">&gt;&gt;&gt; print(eV.copyToUnit( &#39;J&#39; ))</span>
<span class="sd">1.60217653e-19 J</span>

<span class="sd">The following lines change the elementary charge to &#39;1.6 * C&#39;:</span>

<span class="sd">&gt;&gt;&gt; from pqu import pqu_constants</span>
<span class="sd">&gt;&gt;&gt; pqu_constants.e = &#39;1.6 * C&#39;</span>
<span class="sd">&gt;&gt;&gt; from pqu import PQU                 # This import does not work with doctest as PQU was previously imported.</span>
<span class="sd">&gt;&gt;&gt; my_eV = PQU.PQU( 1, &#39;eV&#39; )</span>
<span class="sd">&gt;&gt;&gt; print(my_eV)</span>
<span class="sd">1. eV</span>
<span class="sd">&gt;&gt;&gt; print(my_eV.copyToUnit( &#39;J&#39; ))</span>
<span class="sd">1.6 J</span>

<span class="sd">The python &#39;reload&#39; function can also be used as:</span>

<span class="sd">&gt;&gt;&gt; from pqu import PQU</span>
<span class="sd">&gt;&gt;&gt; eV = PQU.PQU( 1, &#39;eV&#39; )</span>
<span class="sd">&gt;&gt;&gt; print(eV)</span>
<span class="sd">1. eV</span>
<span class="sd">&gt;&gt;&gt; print(eV.copyToUnit( &#39;J&#39; ))</span>
<span class="sd">1.60217653e-19 J</span>
<span class="sd">&gt;&gt;&gt; from pqu import pqu_constants</span>
<span class="sd">&gt;&gt;&gt; pqu_constants.e = &#39;1.6 * C&#39;</span>
<span class="sd">&gt;&gt;&gt; reload( PQU )</span>
<span class="sd">&lt;module &#39;pqu.PQU&#39; from &#39;pqu/PQU.pyc&#39;&gt;</span>
<span class="sd">&gt;&gt;&gt; my_eV = PQU.PQU( 1, &#39;eV&#39; )</span>
<span class="sd">&gt;&gt;&gt; print(my_eV)</span>
<span class="sd">1. eV</span>
<span class="sd">&gt;&gt;&gt; print(my_eV.copyToUnit( &#39;J&#39; ))</span>
<span class="sd">1.6 J</span>
<span class="sd">&gt;&gt;&gt; pqu_constants.e = &#39;1.60217653e-19 * C&#39;      # Needs to be the same as in the module pqu_constants.py for stuff below to pass doctest.</span>
<span class="sd">&gt;&gt;&gt; reload( PQU )</span>
<span class="sd">&lt;module &#39;pqu.PQU&#39; from &#39;pqu/PQU.pyc&#39;&gt;</span>

<span class="sd">------------------------------------------------------------------------------------------</span>
<span class="sd">Uncertainty propagation</span>
<span class="sd">------------------------------------------------------------------------------------------</span>

<span class="sd">This section describes the propagation of uncertainties for the binary operators &#39;+&#39;, &#39;-&#39;, &#39;*&#39; and &#39;/&#39; as well as the power operator</span>
<span class="sd">(i.e., &#39;**&#39;). Firstly, a comment on the limits of uncertainty propagation. Uncertainties were added mainly to support the inputting</span>
<span class="sd">and outputting (i.e., converting to and from a string) of a physical quantity with an associated uncertainty. As can be seen from the documentation below,</span>
<span class="sd">the supported propagations of uncertainties are limited to simple propagation rules.</span>

<span class="sd">In the following discussion, Q1, Q2 and Q3 will be :py:class:`PQU` instances with values</span>
<span class="sd">V1, V2 and V3 respectively and uncertainties dQ1, dQ2 and dQ3 respectively. In addition, n1 will be a number (i.e., 1.23).</span>

<span class="sd">For the binary operators, all numbers are converted to a :py:class:`PQU` instance with uncertainty of 0. For example, the following</span>
<span class="sd">are all equivalent:</span>

<span class="sd">&gt;&gt;&gt; from pqu import PQU</span>
<span class="sd">&gt;&gt;&gt; Q1 = PQU.PQU( &#39;12.3 +/- .2 m&#39; )</span>
<span class="sd">&gt;&gt;&gt; print(Q1 * 0.6)</span>
<span class="sd">7.4 +/- 0.1 m</span>
<span class="sd">&gt;&gt;&gt; print(Q1 * PQU.PQU( &#39;0.6&#39; ))</span>
<span class="sd">7.4 +/- 0.1 m</span>
<span class="sd">&gt;&gt;&gt; print(PQU.PQU( &#39;0.6&#39; ) * Q1)</span>
<span class="sd">7.4 +/- 0.1 m</span>

<span class="sd">All binary operators assume that the two operands are uncorrelated except when they are the same instance. When</span>
<span class="sd">the two operands are the same instance, 100% correlation is assumed. For example,</span>

<span class="sd">&gt;&gt;&gt; print(Q1 - Q1)                      # Operands are the same instance</span>
<span class="sd">0. m</span>
<span class="sd">&gt;&gt;&gt; print(Q1 - PQU.PQU( &#39;12.3 +/- .2 m&#39; ))  # Operands are not the same instance</span>
<span class="sd">0.0 +/- 0.3 m</span>
<span class="sd">&gt;&gt;&gt; print(Q1 + Q1)                      # Operands are the same instance</span>
<span class="sd">24.6 +/- 0.4 m</span>
<span class="sd">&gt;&gt;&gt; print(Q1 + PQU.PQU( &#39;12.3 +/- .2 m&#39; ))  # Operands are not the same instance</span>
<span class="sd">24.6 +/- 0.3 m</span>
<span class="sd">&gt;&gt;&gt; print(Q1 * Q1)                      # Operands are the same instance</span>
<span class="sd">151. +/- 5. m**2</span>
<span class="sd">&gt;&gt;&gt; print(Q1 * PQU.PQU( &#39;12.3 +/- .2 m&#39; ))  # Operands are not the same instance</span>
<span class="sd">151. +/- 3. m**2</span>
<span class="sd">&gt;&gt;&gt; print(Q1 / Q1)                      # Operands are the same instance</span>
<span class="sd">1.</span>
<span class="sd">&gt;&gt;&gt; print(Q1 / PQU.PQU( &#39;12.3 +/- .2 m&#39; ))  # Operands are not the same instance</span>
<span class="sd">1.00 +/- 0.02</span>

<span class="sd">There is one exception (depending on your divide-by-zero belief) to this rule of same instance and that happens when the </span>
<span class="sd">value of the operand is 0. Divide-by-zero always executes a raise of &#39;ZeroDivisionError&#39;, even for &#39;a / a&#39;.</span>

<span class="sd">&gt;&gt;&gt; Q2 = PQU.PQU( &quot;0.00 +/- 0.02&quot; )</span>
<span class="sd">&gt;&gt;&gt; print(Q2 / &quot;2 +/- 0.5&quot;)</span>
<span class="sd">0.00 +/- 0.01</span>
<span class="sd">&gt;&gt;&gt; print(Q2 / Q2)</span>
<span class="sd">Traceback (most recent call last):</span>
<span class="sd">  File &quot;&lt;stdin&gt;&quot;, line 1, in &lt;module&gt;</span>
<span class="sd">  File &quot;PQU.py&quot;, line 1189, in __div__</span>
<span class="sd">    extraFactor = uncertaintySelf * uncertaintyOther</span>
<span class="sd">ZeroDivisionError: float division by zero</span>

<span class="sd">For the rest of this discussion, the two binary operands will be assumed to not be the same instance.</span>
<span class="sd">For addition and subtraction with :py:class:`PQU` instances Q1 and Q2 as operands the uncertainty is propagated as dQ3 = sqrt( dQ1**2 + dQ2**2 ).</span>
<span class="sd">For multiplication with :py:class:`PQU` instances Q1 and Q2 as operands the uncertainty is propagated using Goodman&#39;s expression with</span>
<span class="sd">uncorrelated values (i.e., as dQ3 = sqrt( ( V2 * dQ1 )**2 + ( V1 * dQ2) **2 + ( dQ1 * dQ2 )**2 )). For division, the expression &#39;Q1 / Q2&#39;</span>
<span class="sd">is converted to &#39;Q1 * Q3&#39; with &#39;Q3 = PQU( 1 / V2, unit = 1 / U2, uncertainty = dQ2 / ( V2 * V2 ) )&#39; where U2 is the unit of Q2.</span>

<span class="sd">For the power method, simple propagation is perform which is only valid if the uncertainty is small relative to the value. </span>
<span class="sd">This is, for &#39;Q2 = pow( Q1, n1 )&#39; the uncertainty for Q2 is &#39;dQ2 = n1 * V1**(n1-1) * dQ1&#39;.</span>
<span class="sd">Note, the &#39;sqrt&#39; method is equivalent to the &#39;pow&#39; method with power of 0.5.</span>

<span class="sd">For the trigonometry methods, no propagation of uncertainty is performed.</span>

<span class="sd">------------------------------------------------------------------------------------------</span>
<span class="sd">PQU methods by functionality</span>
<span class="sd">------------------------------------------------------------------------------------------</span>

<span class="sd">This section classifies some of the methods in the :py:class:`PQU` class by their function.</span>

<span class="sd">For :py:class:`PQU` methods that require a second operand (e.g., &#39;+&#39;, &#39;/&#39;), the second operand will be passed to the</span>
<span class="sd">staticmethod :py:meth:`PQU._getOtherAsPQU` to determine if it is a suitable object. A suitable object includes any string that</span>
<span class="sd">is a valid :py:class:`PQU`. For example: :py:meth:`PQU.toString`</span>

<span class="sd">&gt;&gt;&gt; print(PQU.PQU( &#39;12.345&#39; ) + &quot;3.23&quot;)</span>
<span class="sd">15.58</span>
<span class="sd">&gt;&gt;&gt; print(PQU.PQU( &#39;12.345 mm&#39; ) + &quot;3.23m&quot;)</span>
<span class="sd">3242. mm</span>

<span class="sd">**isCompatible**</span>

<span class="sd">    Returns **True** if *self*&#39;s unit is compatible with the units of the argument and **False** otherwise.</span>

<span class="sd">**isPercent, isDimensionless, isLength, isMass, isTime, isCurrent, isTemperature, isMoles, isLuminousIntensity,</span>
<span class="sd">isAngle, isSolidAngle, isEnergy, isSpin, isCharge**</span>

<span class="sd">    These methods return **True** if *self* is compatible with the unit implied by the method name.</span>

<span class="sd">**__float__**</span>

<span class="sd">    This method is called when the a :py:class:`PQU` is the argument to the &#39;float&#39; function (e.g., float( pqu )).</span>
<span class="sd">    This method returns a python float for the value of the :py:class:`PQU` instance. As example:</span>

<span class="sd">&gt;&gt;&gt; pqu = PQU.PQU( &#39;13.7 +/- 0.1 mi/h&#39; )</span>
<span class="sd">&gt;&gt;&gt; value = float( pqu )</span>
<span class="sd">&gt;&gt;&gt; print(type( value ), value)</span>
<span class="sd">&lt;type &#39;float&#39;&gt; 13.7</span>

<span class="sd">The :py:class:`PQU` class has methods for the following arithmetic operations. Unless stated, a new :py:class:`PQU` instance is returned.</span>

<span class="sd">**__abs__, __neg__**</span>

<span class="sd">    These are the standard unitary operators that only operate on the :py:class:`PQU`&#39;s value.</span>

<span class="sd">**__add__, __radd__, __iadd__, __sub__, __rsub__, __isub__**</span>

<span class="sd">    These are the standard binary operators for addition and subtraction. For these operators, the other</span>
<span class="sd">    operand is passed to :py:meth:`PQU._getOtherAsPQU`. The other operand must have units compatible with *self*.</span>
<span class="sd">    As expected, the __iadd__ and __isub__ methods modify *self* and return it.</span>

<span class="sd">**__mul__, __rmul__, __imul__, __div__, __rdiv__, __idiv__**</span>

<span class="sd">    These are the standard binary operators for multiplication and division. For these operators, the other</span>
<span class="sd">    operand is passed to :py:meth:`PQU._getOtherAsPQU`. Any unit for other is allowed.</span>
<span class="sd">    As expected, the __imul__ and __idiv__ methods modify *self* and</span>
<span class="sd">    return it. All these methods call the __mul__ method; except, when a division happens, and &#39;*self* is other&#39;</span>
<span class="sd">    and the denominator is not 0.</span>
<span class="sd">    That is, the expression &#39;a / a&#39; is handled as a special case when float( a ) != 0. In this case, a </span>
<span class="sd">    dimensionless :py:class:`PQU` is returned with value 1 and no uncertainty.</span>

<span class="sd">    If *self* is not other, the uncertainty is propagated using Goodman&#39;s expression for uncorrelated values.</span>
<span class="sd">    Otherwise, 100% correlated uncertainty is assumed.</span>

<span class="sd">**__pow__**</span>

<span class="sd">    This method raises - not in the python sense but in the mathematical sense (i.e., x**y) -</span>
<span class="sd">    *self* to a power. Standard uncertainty propagation is performed which is only valid when</span>
<span class="sd">    the uncertainty is small compared to the value.  A quantity can be raised to a non-integer power </span>
<span class="sd">    only if the result can be represented by integer powers of the base units.</span>

<span class="sd">**__eq__, __ne__, __lt__, __le__, __gt__, __ge__, compare, equivalent**</span>

<span class="sd">    These methods compare *self* to another object. For these operators, the other</span>
<span class="sd">    object is passed to :py:meth:`PQU._getOtherAsPQU` and must have the same unit</span>
<span class="sd">    as *self*. The first 6 methods all call the :py:func:`compare` method</span>
<span class="sd">    with epsilonFactor = 5. All methods except &#39;equivalent&#39; compare </span>
<span class="sd">    *self*&#39;s and other&#39;s values and units only. </span>
<span class="sd">    The &#39;equivalent&#39; method also considers *self*&#39;s and other&#39;s uncertainty.</span>

<span class="sd">**convertToUnit, copyToUnit, inUnitsOf, getUnitAsString, getValueAs, getUncertaintyValueAs**</span>

<span class="sd">    These methods change a :py:class:`PQU`&#39;s unit or return a new instance.</span>

<span class="sd">**truncate**</span>

<span class="sd">    This method changes a :py:class:`PQU`&#39;s value and uncertainty to agree with its printed value as defined</span>
<span class="sd">    by its significant digits.</span>

<span class="sd">**changeUncertaintyStyle, changeUncertaintyPercent**</span>

<span class="sd">    These methods allow for the changing of a :py:class:`PQU` instance uncertainty.</span>

<span class="sd">------------------------------------------------------------------------------------------</span>
<span class="sd">Supporting classes</span>
<span class="sd">------------------------------------------------------------------------------------------</span>
<span class="sd">In addition to the :py:class:`PQU` class, the following classes are a part the the PQU module:</span>
<span class="sd">:py:class:`Parsers`, :py:class:`PQU_float`, :py:class:`PQU_uncertainty`, :py:class:`PhysicalUnit` and :py:class:`NumberDict`.</span>
<span class="sd">These classes are only intended as helper classes for the :py:class:`PQU` class; hence, they have limited functionality and</span>
<span class="sd">are only intended for internal use.</span>

<span class="sd">------------------------------------------------------------------------------------------</span>
<span class="sd">History</span>
<span class="sd">------------------------------------------------------------------------------------------</span>

<span class="sd">This module is based on the Scientific/Physics/PhysicalQuantities.py module (Last revision: 2007-5-25)</span>
<span class="sd">written by Konrad Hinsen &lt;hinsen@cnrs-orleans.fr&gt; with contributions from Greg Ward and Berthold Hoellmann.</span>

<span class="sd">Most of the additions to Hinsen&#39;s version were done by Nidhi R. Patel and Bret R. Beck &lt;beck6@llnl.gov&gt;</span>
<span class="sd">with feedback from Caleb M. Mattoon, Neil Summers and David Brown.</span>

<span class="sd">The values of physical constants are taken from the 2010 recommended values from</span>
<span class="sd">CODATA. Other conversion factors (e.g. for British units) come from various </span>
<span class="sd">sources. The correctness of all entries in the unit table cannot be guaranteed,</span>
<span class="sd">so use this at your own risk.</span>

<span class="sd">-----------------------------------</span>
<span class="sd">Issues or features to be aware of</span>
<span class="sd">-----------------------------------</span>

<span class="sd">This section describes several oddities about :py:class:`PQU`.</span>

<span class="sd">    - Units &#39;oz&#39;, &#39;lb&#39; and &#39;ton&#39; (i.e., ounce, pound and ton respectively) are units of mass and not force.</span>
<span class="sd">      As example, the unit &#39;psi&#39; (i.e., pounds per square inch) is equivalent to about &#39;32.174 ft / s**2 * lb / inch**2&#39;.</span>

<span class="sd">    - In the following, the first line produces a significantDigits that is small but correct per :py:class:`PQU` </span>
<span class="sd">      rules as the number of significant digits is determined by the &#39;1&#39;.</span>

<span class="sd">&gt;&gt;&gt; from pqu import PQU</span>
<span class="sd">&gt;&gt;&gt; b1 = PQU.PQU( &#39;1 Bohr&#39; )</span>
<span class="sd">&gt;&gt;&gt; b2 = b1.inBaseUnits( )</span>
<span class="sd">&gt;&gt;&gt; print(b2)</span>
<span class="sd">5.e-11 m</span>
<span class="sd">&gt;&gt;&gt; print(b2.value.info( ))</span>
<span class="sd">value = 5.29177208114537818e-11, significantDigits = 1, order = -11, isPercent = False</span>
<span class="sd">&gt;&gt;&gt; </span>
<span class="sd">&gt;&gt;&gt; b3 = PQU.PQU( 1, &#39;Bohr&#39; )        # this yields significantDigits = 16.</span>
<span class="sd">&gt;&gt;&gt; b4 = b3.inBaseUnits( )</span>
<span class="sd">&gt;&gt;&gt; print(b4)</span>
<span class="sd">5.291772081145378e-11 m</span>
<span class="sd">&gt;&gt;&gt; print(b4.value.info( ))</span>
<span class="sd">value = 5.29177208114537818e-11, significantDigits = 16, order = -11, isPercent = False</span>

<span class="sd">    - The temperature units are Kelvin (i.e., &#39;K&#39;), Celsius (&#39;degC&#39;), Rankine (&#39;degR&#39;) and Fahrenheit (&#39;degF&#39;).</span>
<span class="sd">      Two of these units (i.e., &#39;degC&#39; and &#39;degF&#39;) cannot be used with any other unit including itself. That is,</span>
<span class="sd">      PQU( value, &#39;degC&#39; ) and PQU( value, &#39;degF&#39; ) are the only allowed forms when &#39;degF&#39; or &#39;degC&#39; are present.</span>
<span class="sd">      The two absolute temperature units (i.e., &#39;K&#39; and &#39;degR&#39;) have no such restriction. As an example, heat </span>
<span class="sd">      capacity can be expressed in units of &#39;W/(m * K)&#39; or &#39;BTU/(hr * ft * degR)&#39; but cannot be expressed in units</span>
<span class="sd">      of &#39;W/(m * degC)&#39; or &#39;BTU/(hr * ft * degF)&#39;.</span>
<span class="sd">      Any temperature unit can be converted to another temperature unit. For example,</span>

<span class="sd">&gt;&gt;&gt; from pqu import PQU</span>
<span class="sd">&gt;&gt;&gt; t1 = PQU.PQU( &#39;40 degC&#39; )</span>
<span class="sd">&gt;&gt;&gt; print(t1.convertToUnit( &#39;degF&#39; ))</span>
<span class="sd">104. degF</span>
<span class="sd">&gt;&gt;&gt; print(t1.getValueAs( &#39;K&#39; ))</span>
<span class="sd">313.15</span>
<span class="sd">&gt;&gt;&gt; print(t1.convertToUnit( &#39;degR&#39; ))</span>
<span class="sd">564. degR</span>

<span class="sd">    - :py:class:`PQU`, actually :py:class:`PhysicalUnit`, allows the unit to have values. For example &#39;m/s/25**3&#39; is currently a valid</span>
<span class="sd">      unit and stored that way.  This should probably not be allowed and will probably be </span>
<span class="sd">      deprecated (i.e., do not rely on it).</span>
<span class="sd">      The following illustrates the issue:</span>

<span class="sd">&gt;&gt;&gt; from pqu import PQU</span>
<span class="sd">&gt;&gt;&gt; c1 = PQU.PQU( &#39;2.23 c&#39; )</span>
<span class="sd">&gt;&gt;&gt; print(c1)</span>
<span class="sd">2.23 c</span>
<span class="sd">&gt;&gt;&gt; print(c1.getValueAs( &#39;m/s&#39; ))</span>
<span class="sd">668537181.34</span>
<span class="sd">&gt;&gt;&gt; print(c1.convertToUnit( &#39;km / s&#39; ))</span>
<span class="sd">6.69e5 km/s</span>
<span class="sd">&gt;&gt;&gt; print(c1.getValue( ))</span>
<span class="sd">668537.18134</span>
<span class="sd">&gt;&gt;&gt; </span>
<span class="sd">&gt;&gt;&gt; c2 = PQU.PQU( &#39;2.23 c&#39; ) / 3</span>
<span class="sd">&gt;&gt;&gt; print(c2)</span>
<span class="sd">0.743 c</span>
<span class="sd">&gt;&gt;&gt; print(c2.getValueAs( &#39;m/s&#39; ))</span>
<span class="sd">222845727.113</span>
<span class="sd">&gt;&gt;&gt; print(c2.convertToUnit( &#39;km / s&#39; ))</span>
<span class="sd">2.23e5 km/s</span>
<span class="sd">&gt;&gt;&gt; print(c2.getValue( ))</span>
<span class="sd">222845.727113</span>
<span class="sd">&gt;&gt;&gt; </span>
<span class="sd">&gt;&gt;&gt; c3 = PQU.PQU( &#39;2.23 c / 3&#39; )</span>
<span class="sd">&gt;&gt;&gt; print(c3)</span>
<span class="sd">2.23 c/3</span>
<span class="sd">&gt;&gt;&gt; print(c3.getValueAs( &#39;m/s&#39; ))</span>
<span class="sd">222845727.113</span>
<span class="sd">&gt;&gt;&gt; print(c3.convertToUnit( &#39;km / s&#39; ))</span>
<span class="sd">2.23e5 km/s</span>
<span class="sd">&gt;&gt;&gt; print(c3.getValue( ))</span>
<span class="sd">222845.727113</span>
<span class="sd">&gt;&gt;&gt; </span>
<span class="sd">&gt;&gt;&gt; print(c1 == c2, c1 == c3, c2 == c3)</span>
<span class="sd">False False True</span>
<span class="sd">&gt;&gt;&gt; </span>
<span class="sd">&gt;&gt;&gt; print(PQU.PQU( &#39;2.23 2. * c / 3**2 / pi&#39; ))</span>
<span class="sd">2.23 c*2.0/9/3.14159265359</span>

<span class="sd">----------------------------</span>
<span class="sd">Future plans</span>
<span class="sd">----------------------------</span>

<span class="sd">    - Use fractions.Fraction in units.</span>
<span class="sd">    - Added uncertainty to data in pqu_constants.py and supporting logic.</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span> <span class="nn">sys</span><span class="o">,</span> <span class="nn">math</span><span class="o">,</span> <span class="nn">re</span><span class="o">,</span> <span class="nn">copy</span>
<span class="kn">from</span> <span class="nn">functools</span> <span class="kn">import</span> <span class="n">reduce</span>
<span class="kn">from</span> <span class="nn">.NumberDict</span> <span class="kn">import</span> <span class="n">NumberDict</span>

<span class="n">MAJORVERSION</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">MINORVERSION</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">PATCHVERSION</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">__version__</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%s</span><span class="s1">.</span><span class="si">%s</span><span class="s1">.</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span> <span class="n">MAJORVERSION</span><span class="p">,</span> <span class="n">MINORVERSION</span><span class="p">,</span> <span class="n">PATCHVERSION</span> <span class="p">)</span>

<span class="n">maxSignificantDigits</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">float_info</span><span class="o">.</span><span class="n">dig</span>


<div class="viewcode-block" id="compare"><a class="viewcode-back" href="../../pqu/pqu.html#pqu.PQU.compare">[docs]</a><span class="k">def</span> <span class="nf">compare</span><span class="p">(</span> <span class="n">value1</span><span class="p">,</span> <span class="n">value2</span><span class="p">,</span> <span class="n">epsilonFactor</span> <span class="o">=</span> <span class="mi">0</span> <span class="p">)</span> <span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This function compares two floats (or objects that can be converted to floats) in a fuzzy way </span>
<span class="sd">    where the fuzz factor is *epsilonFactor* * sys.float_info.epsilon. This function returns</span>

<span class="sd">         0          if the floats are comparable as given by *epsilonFactor* (see below),</span>
<span class="sd">         otherwise, it returns 1 (-1) if *value1* is greater (less) than *value2*.</span>

<span class="sd">    Two floats are comparable if the magnitude of the &#39;relative difference&#39; between them is less than or equal to </span>
<span class="sd">    *epsilonFactor* * sys.float_info.epsilon. The relative difference is defined as</span>

<span class="sd">         ( value1 - value2 ) / max( abs( value1 ), abs( value2 ) )</span>

<span class="sd">    Hence, two floats are comparable if</span>

<span class="sd">        ( value1 - value2 ) &lt;= epsilonFactor * sys.float_info.epsilon * max( abs( value1 ), abs( value2 ) )</span>

<span class="sd">    For the default *epsilonFactor* = 0, a 0 is return (i.e., the two floats are &#39;equal&#39;) only if they have the same value</span>

<span class="sd">    :param value1: value to compare to value2</span>
<span class="sd">    :type value1: any object which float() accepts</span>

<span class="sd">    :param value2: value to compare to value1</span>
<span class="sd">    :type value2: any object which float() accepts</span>

<span class="sd">    :param epsilonFactor: The factor to scale sys.float_info.epsilon to determine the fuzz factor.</span>
<span class="sd">    :type epsilonFactor: any object which float() accepts</span>

<span class="sd">    :returns: 1 if value1 is deemed greater than value2, 0 if equal and -1 otherwise</span>
<span class="sd">    :rtype: `int`</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">valueOfSelf</span><span class="p">,</span> <span class="n">valueOfOther</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span> <span class="n">value1</span> <span class="p">),</span> <span class="nb">float</span><span class="p">(</span> <span class="n">value2</span> <span class="p">)</span>
    <span class="n">delta</span> <span class="o">=</span> <span class="n">valueOfSelf</span> <span class="o">-</span> <span class="n">valueOfOther</span>
    <span class="k">if</span><span class="p">(</span> <span class="n">delta</span> <span class="o">==</span> <span class="mi">0</span> <span class="p">)</span> <span class="p">:</span> <span class="k">return</span><span class="p">(</span> <span class="mi">0</span> <span class="p">)</span>
    <span class="n">_max</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span> <span class="nb">abs</span><span class="p">(</span> <span class="n">valueOfSelf</span> <span class="p">),</span> <span class="nb">abs</span><span class="p">(</span> <span class="n">valueOfOther</span> <span class="p">)</span> <span class="p">)</span>
    <span class="k">if</span><span class="p">(</span> <span class="nb">abs</span><span class="p">(</span> <span class="n">delta</span> <span class="p">)</span> <span class="o">&lt;=</span> <span class="p">(</span> <span class="nb">float</span><span class="p">(</span> <span class="n">epsilonFactor</span> <span class="p">)</span> <span class="o">*</span> <span class="n">sys</span><span class="o">.</span><span class="n">float_info</span><span class="o">.</span><span class="n">epsilon</span> <span class="o">*</span> <span class="n">_max</span> <span class="p">)</span> <span class="p">)</span> <span class="p">:</span> <span class="k">return</span><span class="p">(</span> <span class="mi">0</span> <span class="p">)</span>
    <span class="k">if</span><span class="p">(</span> <span class="n">delta</span> <span class="o">&lt;</span> <span class="mf">0.</span> <span class="p">)</span> <span class="p">:</span> <span class="k">return</span><span class="p">(</span> <span class="o">-</span><span class="mi">1</span> <span class="p">)</span>
    <span class="k">return</span><span class="p">(</span> <span class="mi">1</span> <span class="p">)</span></div>

<div class="viewcode-block" id="valueOrPQ"><a class="viewcode-back" href="../../pqu/pqu.html#pqu.PQU.valueOrPQ">[docs]</a><span class="k">def</span> <span class="nf">valueOrPQ</span><span class="p">(</span> <span class="n">value</span><span class="p">,</span> <span class="n">unitFrom</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">unitTo</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">asPQU</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">checkOrder</span> <span class="o">=</span> <span class="kc">True</span> <span class="p">)</span> <span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This function is designed as a convenience function for working with :py:class:`PQU`</span>
<span class="sd">    and float instances. That is, instead of checking the type of value, let valueOrPQ handle some of the</span>
<span class="sd">    details. The first argument can be either a :py:class:`PQU` or something</span>
<span class="sd">    that is a valid argument for the python &#39;float&#39; function (e.g., 1.23, &quot;1.23&quot;). The returned instance</span>
<span class="sd">    is a :py:class:`PQU` if asPQU is **True** and a float otherwise. The unitFrom and unitTo</span>
<span class="sd">    arguments can be either None, a :py:class:`PhysicalUnit` or a string that represents a :py:class:`PhysicalUnit` (e.g., &quot;m&quot;, &quot;&quot;,</span>
<span class="sd">    &quot;MeV * b&quot;). If unitTo is not None, the returned instance will be in units of unitTo. If unitFrom is not None</span>
<span class="sd">    and the first argument (i.e., value) is a :py:class:`PQU` instance, it must have the</span>
<span class="sd">    same units.</span>

<span class="sd">    Note, this function was originally written when :py:class:`PQU` did not support dimensionless</span>
<span class="sd">    units. As it now supports dimensionless units, this function may not be of much value but should be kept anyway.</span>

<span class="sd">    Options for input are:</span>
<span class="sd">        +-----+--------+------+-----------------+---------------------------------------+</span>
<span class="sd">        |     |        |      |  from _getUnit  |           returned value asPQU        |</span>
<span class="sd">        +-----+--------+------+--------+--------+-----------+---------------------------+</span>
<span class="sd">        |value|unitFrom|unitTo|unitFrom|unitTo  |**False**  |**True**                   |</span>
<span class="sd">        +=====+========+======+========+========+===========+===========================+</span>
<span class="sd">        |float|None    |None  |None    |None    |float      |float                      |</span>
<span class="sd">        +-----+--------+------+--------+--------+-----------+---------------------------+</span>
<span class="sd">        |float|None    |string|None    |PU      |float in   |PQ in unitTo               |</span>
<span class="sd">        |     |        |or PU |        |        |unitTo     |                          `|</span>
<span class="sd">        +-----+--------+------+--------+--------+-----------+---------------------------+</span>
<span class="sd">        |float|string  |None  |PU      |None    |float in   |PQ in unitFrom             |</span>
<span class="sd">        |     |or PU   |      |        |        |unitFrom   |                           |</span>
<span class="sd">        +-----+--------+------+--------+--------+-----------+---------------------------+</span>
<span class="sd">        |float|string  |string|PU      |PU      |float in   |PQ in unitTo               |</span>
<span class="sd">        |     |or PU   |or PU |        |        |unitTo     |                           |</span>
<span class="sd">        +-----+--------+------+--------+--------+-----------+---------------------------+</span>
<span class="sd">        |PQU  |None    |None  |PU      |None    |float      |PQ                         |</span>
<span class="sd">        +-----+--------+------+--------+--------+-----------+---------------------------+</span>
<span class="sd">        |PQU  |string  |None  |PU      |None    |float in   |PQU (need to check that PQ |</span>
<span class="sd">        |     |or PU   |      |        |        |unitFrom   |and unitFrom are the same) |</span>
<span class="sd">        +-----+--------+------+--------+--------+-----------+---------------------------+</span>
<span class="sd">        |PQU  |string  |string|PU      |PU      |float in   |PQU in unitTo (ditto)      | </span>
<span class="sd">        |     |or PU   |or PU |        |        |unitTo     |                           |</span>
<span class="sd">        +-----+--------+------+--------+--------+-----------+---------------------------+</span>
<span class="sd">        |PQU  |None    |string|PU      |PU      |float in   |PQU in unitTo              |</span>
<span class="sd">        |     |        |or PU |        |        |unitTo     |                           |</span>
<span class="sd">        +-----+--------+------+--------+--------+-----------+---------------------------+</span>

<span class="sd">    :param value: The number object convert if requested</span>
<span class="sd">    :type value: :py:class:`PQU` instance or any object which float() accepts</span>

<span class="sd">    :param unitFrom: If not None, the unit for value</span>
<span class="sd">    :type unitFrom: None or instance from which units can be determined</span>

<span class="sd">    :param unitTo: If not None, the unit the returned value is in</span>
<span class="sd">    :type unitTo: None or instance from which units can be determined</span>

<span class="sd">    :param asPQU: If **True** returned instance is a :py:class:`PQU`; otherwise, it is a float</span>
<span class="sd">    :type asPQU: `bool`</span>

<span class="sd">    :returns: value - in units of unitTo if unitTo is not None</span>
<span class="sd">    :rtype: `float` or :py:class:`PQU` instance</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">_getUnit</span><span class="p">(</span> <span class="n">unit</span><span class="p">,</span> <span class="n">default</span> <span class="o">=</span> <span class="kc">None</span> <span class="p">)</span> <span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns an instance of :py:class:`PhysicalUnit` based first on the argument &#39;unit&#39; and then &#39;default&#39;. &#39;unit&#39; </span>
<span class="sd">        can only be a :py:class:`PhysicalUnit`, string (e.g., &#39;&#39;, &#39;MeV&#39;, &#39;b * eV&#39;) or None. Default must be either </span>
<span class="sd">        a :py:class:`PQU instance` or None.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span><span class="p">(</span> <span class="nb">isinstance</span><span class="p">(</span> <span class="n">default</span><span class="p">,</span> <span class="n">PQU</span> <span class="p">)</span> <span class="p">)</span> <span class="p">:</span>
            <span class="n">default</span> <span class="o">=</span> <span class="n">default</span><span class="o">.</span><span class="n">unit</span>
        <span class="k">else</span> <span class="p">:</span>
            <span class="n">default</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="k">if</span><span class="p">(</span> <span class="n">unit</span> <span class="ow">is</span> <span class="kc">None</span> <span class="p">)</span> <span class="p">:</span>
            <span class="k">if</span><span class="p">(</span> <span class="n">default</span> <span class="ow">is</span> <span class="kc">None</span> <span class="p">)</span> <span class="p">:</span> <span class="k">return</span><span class="p">(</span> <span class="kc">None</span> <span class="p">)</span>
            <span class="k">return</span> <span class="n">_findUnit</span><span class="p">(</span> <span class="n">default</span> <span class="p">)</span>

        <span class="k">return</span><span class="p">(</span> <span class="n">_findUnit</span><span class="p">(</span> <span class="n">unit</span> <span class="p">)</span> <span class="p">)</span>

    <span class="n">unitFrom</span> <span class="o">=</span> <span class="n">_getUnit</span><span class="p">(</span> <span class="n">unitFrom</span><span class="p">,</span> <span class="n">value</span> <span class="p">)</span>
    <span class="n">unitTo</span> <span class="o">=</span> <span class="n">_getUnit</span><span class="p">(</span> <span class="n">unitTo</span> <span class="p">)</span>

    <span class="k">if</span><span class="p">(</span> <span class="n">unitFrom</span> <span class="ow">is</span> <span class="kc">None</span> <span class="p">)</span> <span class="p">:</span>        <span class="c1"># Handles first 2 cases in table above.</span>
        <span class="k">if</span><span class="p">(</span> <span class="n">asPQU</span> <span class="p">)</span> <span class="p">:</span> <span class="k">return</span><span class="p">(</span> <span class="n">PQU</span><span class="p">(</span> <span class="n">value</span><span class="p">,</span> <span class="n">unitTo</span><span class="p">,</span> <span class="n">checkOrder</span> <span class="o">=</span> <span class="n">checkOrder</span> <span class="p">)</span> <span class="p">)</span>
        <span class="k">return</span><span class="p">(</span> <span class="nb">float</span><span class="p">(</span> <span class="n">value</span> <span class="p">)</span> <span class="p">)</span>

    <span class="k">if</span><span class="p">(</span> <span class="nb">isinstance</span><span class="p">(</span> <span class="n">value</span><span class="p">,</span> <span class="n">PQU</span> <span class="p">)</span> <span class="p">)</span> <span class="p">:</span>
        <span class="k">if</span><span class="p">(</span> <span class="n">unitFrom</span> <span class="o">!=</span> <span class="n">value</span><span class="o">.</span><span class="n">unit</span> <span class="p">)</span> <span class="p">:</span> <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span> <span class="s2">&quot;Unit &#39;</span><span class="si">%s</span><span class="s2">&#39; not compatible with unit &#39;</span><span class="si">%s</span><span class="s2">&#39;&quot;</span> <span class="o">%</span> <span class="p">(</span> <span class="n">unitFrom</span><span class="p">,</span> <span class="n">value</span><span class="o">.</span><span class="n">unit</span> <span class="p">)</span> <span class="p">)</span>
        <span class="n">value</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
    <span class="k">else</span> <span class="p">:</span>
        <span class="n">value</span> <span class="o">=</span> <span class="n">PQU</span><span class="p">(</span> <span class="n">value</span><span class="p">,</span> <span class="n">unitFrom</span><span class="p">,</span> <span class="n">checkOrder</span> <span class="o">=</span> <span class="n">checkOrder</span> <span class="p">)</span>  <span class="c1"># At this point unitFrom is a PhysicalUnit instance.</span>
    <span class="k">if</span><span class="p">(</span> <span class="n">unitTo</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">)</span> <span class="p">:</span> <span class="n">value</span><span class="o">.</span><span class="n">convertToUnit</span><span class="p">(</span> <span class="n">unitTo</span> <span class="p">)</span>
    <span class="k">if</span><span class="p">(</span> <span class="n">asPQU</span> <span class="p">)</span> <span class="p">:</span> <span class="k">return</span><span class="p">(</span> <span class="n">value</span> <span class="p">)</span>
    <span class="k">return</span><span class="p">(</span> <span class="nb">float</span><span class="p">(</span> <span class="n">value</span> <span class="p">)</span> <span class="p">)</span></div>

<div class="viewcode-block" id="floatToShortestString"><a class="viewcode-back" href="../../pqu/pqu.html#pqu.PQU.floatToShortestString">[docs]</a><span class="k">def</span> <span class="nf">floatToShortestString</span><span class="p">(</span> <span class="n">value</span><span class="p">,</span> <span class="n">significantDigits</span> <span class="o">=</span> <span class="mi">15</span><span class="p">,</span> <span class="n">trimZeros</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">keepPeriod</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">favorEFormBy</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">includeSign</span> <span class="o">=</span> <span class="kc">False</span> <span class="p">)</span> <span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This function returns the shortest string representation of the float &#39;value&#39; that is accurate to </span>
<span class="sd">    &#39;significantDigits&#39; digits when converted back to a float.</span>

<span class="sd">    The float is converted to both the E-form (i.e., &#39;%e&#39;) and F-form (i.e., &#39;%f&#39;) with significantDigits.</span>
<span class="sd">    Then, after &#39;trimZeros&#39; and &#39;keepPeriod&#39; options are implemented, if the length of the E-form minus </span>
<span class="sd">    favorEFormBy is less than or equal to the length of the F-form, the E-form is returned. Otherwise </span>
<span class="sd">    the F-form is returned.</span>

<span class="sd">    For example, for significantDigits = 12 the returned string for the float 1.234 will be &quot;1.234&quot;, and</span>
<span class="sd">    not &quot;1.234000000000&quot; or &quot;1.23400000000e+00&quot; while the string for the float 1.234e-9 will be &quot;1.234-9&quot;, and</span>
<span class="sd">    not &quot;0.00000000123400000000&quot; or &quot;1.23400000000e-09&quot;.</span>

<span class="sd">    :param value:               The float to convert to a string.</span>
<span class="sd">    :type value: float</span>

<span class="sd">    :param significantDigits:   The number of significant digits desired. Restricted to the range 0 to 24 inclusive.</span>
<span class="sd">    :type significantDigits: integer</span>

<span class="sd">    :param trimZeros:           If **True**, unneeded zeros to the right of &#39;.&#39; are removed.</span>
<span class="sd">    :type trimZeros: bool</span>

<span class="sd">    :param keepPeriod:          If **False**, &#39;.&#39; is removed if there is no digit to its right.</span>
<span class="sd">    :type keepPeriod: bool</span>

<span class="sd">    :param favorEFormBy:        The integer subtracted from the length of the E-form before the form</span>
<span class="sd">                                with the shortest representation is determined.</span>
<span class="sd">    :type favorEFormBy: integer</span>

<span class="sd">    :param includeSign:         If **True**, the returned string will always start with a sign character </span>
<span class="sd">                                (i.e., &#39;+&#39; or &#39;-&#39;). Otherwise, only negative values will have a sign.</span>
<span class="sd">    :type includeSign: bool</span>

<span class="sd">    :rtype: `str`</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">value</span><span class="p">)</span><span class="o">==</span><span class="nb">str</span><span class="p">:</span> <span class="k">return</span> <span class="n">value</span>

    <span class="k">def</span> <span class="nf">isfinite</span><span class="p">(</span> <span class="n">value</span> <span class="p">)</span> <span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns **True** if value is neither infinite nor not-a-number (NaN) and **False** otherwise.&quot;&quot;&quot;</span>

        <span class="k">if</span><span class="p">(</span> <span class="n">math</span><span class="o">.</span><span class="n">isinf</span><span class="p">(</span> <span class="n">value</span> <span class="p">)</span> <span class="ow">or</span> <span class="n">math</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span> <span class="n">value</span> <span class="p">)</span> <span class="p">)</span> <span class="p">:</span> <span class="k">return</span><span class="p">(</span> <span class="kc">False</span> <span class="p">)</span>
        <span class="k">return</span><span class="p">(</span> <span class="kc">True</span> <span class="p">)</span>

    <span class="n">signNeeded</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
    <span class="k">if</span><span class="p">(</span> <span class="n">includeSign</span> <span class="p">)</span> <span class="p">:</span> <span class="n">signNeeded</span> <span class="o">=</span> <span class="s1">&#39;+&#39;</span>

    <span class="k">if</span><span class="p">(</span> <span class="ow">not</span><span class="p">(</span> <span class="n">isfinite</span><span class="p">(</span> <span class="n">value</span> <span class="p">)</span> <span class="p">)</span> <span class="p">)</span> <span class="p">:</span> <span class="k">return</span><span class="p">(</span> <span class="p">(</span> <span class="s2">&quot;%&quot;</span> <span class="o">+</span> <span class="n">signNeeded</span> <span class="o">+</span> <span class="s2">&quot;e&quot;</span> <span class="p">)</span> <span class="o">%</span> <span class="n">value</span> <span class="p">)</span>

    <span class="n">significantDigitsMinus1</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span> <span class="mi">24</span><span class="p">,</span> <span class="nb">max</span><span class="p">(</span> <span class="mi">0</span><span class="p">,</span> <span class="n">significantDigits</span> <span class="o">-</span> <span class="mi">1</span> <span class="p">)</span> <span class="p">)</span>  <span class="c1"># 24 is arbitrary.</span>

    <span class="n">EForm</span> <span class="o">=</span> <span class="p">(</span> <span class="s1">&#39;</span><span class="si">%%%s</span><span class="s1">.</span><span class="si">%d</span><span class="s1">e&#39;</span> <span class="o">%</span> <span class="p">(</span> <span class="n">signNeeded</span><span class="p">,</span> <span class="n">significantDigitsMinus1</span> <span class="p">)</span> <span class="p">)</span> <span class="o">%</span> <span class="n">value</span>

    <span class="n">mantissa</span><span class="p">,</span> <span class="n">exponent</span> <span class="o">=</span> <span class="n">EForm</span><span class="o">.</span><span class="n">split</span><span class="p">(</span> <span class="s1">&#39;e&#39;</span> <span class="p">)</span>
    <span class="k">if</span><span class="p">(</span> <span class="n">significantDigitsMinus1</span> <span class="o">==</span> <span class="mi">0</span> <span class="p">)</span> <span class="p">:</span>
        <span class="k">if</span><span class="p">(</span> <span class="n">mantissa</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;.&#39;</span> <span class="p">)</span> <span class="p">:</span> <span class="n">mantissa</span> <span class="o">+=</span> <span class="s1">&#39;.&#39;</span>     <span class="c1"># This is required, else the trimZeros will remove all characters for value = 0.</span>
    <span class="k">if</span><span class="p">(</span> <span class="n">trimZeros</span> <span class="p">)</span> <span class="p">:</span> <span class="n">mantissa</span> <span class="o">=</span> <span class="n">mantissa</span><span class="o">.</span><span class="n">rstrip</span><span class="p">(</span> <span class="s1">&#39;0&#39;</span> <span class="p">)</span>
    <span class="k">if</span><span class="p">(</span> <span class="ow">not</span><span class="p">(</span> <span class="n">keepPeriod</span> <span class="p">)</span> <span class="ow">and</span> <span class="p">(</span> <span class="n">mantissa</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;.&#39;</span> <span class="p">)</span> <span class="p">)</span> <span class="p">:</span> <span class="n">mantissa</span> <span class="o">=</span> <span class="n">mantissa</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

    <span class="n">exponent</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span> <span class="n">exponent</span> <span class="p">)</span>
    <span class="k">if</span><span class="p">(</span> <span class="n">exponent</span> <span class="o">==</span> <span class="mi">0</span> <span class="p">)</span> <span class="p">:</span> <span class="k">return</span><span class="p">(</span> <span class="n">mantissa</span> <span class="p">)</span>
    <span class="n">EForm</span> <span class="o">=</span> <span class="n">mantissa</span> <span class="o">+</span> <span class="s1">&#39;e&#39;</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="si">%d</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">exponent</span>            <span class="c1"># Reconstruct &quot;%e&quot; string.</span>

    <span class="n">digitsRightOfPeriod</span> <span class="o">=</span> <span class="n">significantDigitsMinus1</span> <span class="o">-</span> <span class="n">exponent</span>  <span class="c1"># For &quot;%f&quot; string, determine number of digit to the right of the &#39;.&#39;.</span>
    <span class="k">if</span><span class="p">(</span> <span class="p">(</span> <span class="n">digitsRightOfPeriod</span> <span class="o">&gt;</span> <span class="mi">25</span> <span class="p">)</span> <span class="ow">or</span> <span class="p">(</span> <span class="n">exponent</span> <span class="o">&gt;</span> <span class="mi">50</span> <span class="p">)</span> <span class="p">)</span> <span class="p">:</span> <span class="k">return</span><span class="p">(</span> <span class="n">EForm</span> <span class="p">)</span>
    <span class="n">digitsRightOfPeriod</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span> <span class="n">digitsRightOfPeriod</span><span class="p">,</span> <span class="mi">0</span> <span class="p">)</span>

    <span class="n">FForm</span> <span class="o">=</span> <span class="p">(</span> <span class="s1">&#39;</span><span class="si">%%%s</span><span class="s1">.</span><span class="si">%d</span><span class="s1">f&#39;</span> <span class="o">%</span> <span class="p">(</span> <span class="n">signNeeded</span><span class="p">,</span> <span class="n">digitsRightOfPeriod</span> <span class="p">)</span> <span class="p">)</span> <span class="o">%</span> <span class="n">value</span>
    <span class="k">if</span><span class="p">(</span> <span class="s1">&#39;e&#39;</span> <span class="ow">in</span> <span class="n">FForm</span> <span class="p">)</span> <span class="p">:</span> <span class="k">return</span><span class="p">(</span> <span class="n">EForm</span> <span class="p">)</span>                <span class="c1"># For very large numbers, the &#39;%.?f&#39; format returns &#39;e&#39; format (e.g., .1234e300 --&gt; &quot;1e+299&quot;).</span>

    <span class="k">if</span><span class="p">(</span> <span class="s1">&#39;.&#39;</span> <span class="ow">in</span> <span class="n">FForm</span> <span class="p">)</span> <span class="p">:</span>
        <span class="k">if</span><span class="p">(</span> <span class="n">trimZeros</span> <span class="p">)</span> <span class="p">:</span> <span class="n">FForm</span> <span class="o">=</span> <span class="n">FForm</span><span class="o">.</span><span class="n">rstrip</span><span class="p">(</span> <span class="s1">&#39;0&#39;</span> <span class="p">)</span>
        <span class="k">if</span><span class="p">(</span> <span class="ow">not</span><span class="p">(</span> <span class="n">keepPeriod</span> <span class="p">)</span> <span class="p">)</span> <span class="p">:</span>
            <span class="k">if</span><span class="p">(</span> <span class="n">FForm</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;.&#39;</span> <span class="p">)</span> <span class="p">:</span> <span class="n">FForm</span> <span class="o">=</span> <span class="n">FForm</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">else</span> <span class="p">:</span>
        <span class="k">if</span><span class="p">(</span> <span class="n">keepPeriod</span> <span class="p">)</span> <span class="p">:</span> <span class="n">FForm</span> <span class="o">+=</span> <span class="s1">&#39;.&#39;</span>
    <span class="k">if</span><span class="p">(</span> <span class="p">(</span> <span class="nb">len</span><span class="p">(</span> <span class="n">FForm</span> <span class="p">)</span> <span class="o">+</span> <span class="n">favorEFormBy</span> <span class="p">)</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span> <span class="n">EForm</span> <span class="p">)</span> <span class="p">)</span> <span class="p">:</span> <span class="k">return</span><span class="p">(</span> <span class="n">FForm</span> <span class="p">)</span>

    <span class="k">return</span><span class="p">(</span> <span class="n">EForm</span> <span class="p">)</span></div>

<span class="n">toShortestString</span> <span class="o">=</span> <span class="n">floatToShortestString</span>    <span class="c1"># For legacy use. Deprecated: last date 1-April-2014 (no joke).</span>

<div class="viewcode-block" id="PQU_float"><a class="viewcode-back" href="../../pqu/pqu.html#pqu.PQU.PQU_float">[docs]</a><span class="k">class</span> <span class="nc">PQU_float</span> <span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This class is used by the classes :py:class:`PQU` and :py:class:`PQU_uncertainty` to store more information about a float than</span>
<span class="sd">    is provided by the python float class as well as methods to operator on this information. The main members are:</span>

<span class="sd">    - value              --- The python value of the float.</span>
<span class="sd">    - significantDigits  --- The number of significant digits the value possess as defined by the creator of *self*.</span>
<span class="sd">    - order              --- An integer that represents the order of the most significant digit of *self*. </span>
<span class="sd">                             Calculated internally equivalent to int( log10( value ) ) and stored for convenience.</span>
<span class="sd">    - _isPercent         --- **True** if *self* represents a percent and **False** otherwise. Note, the value is always stored as</span>
<span class="sd">                             the non-percent value (e.g., 1% and 12% are stored as 0.01 and 0.12 respectively).</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">significantDigits</span><span class="p">,</span> <span class="n">isPercent</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">checkOrder</span> <span class="o">=</span> <span class="kc">True</span> <span class="p">)</span> <span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a new :py:class:`PQU_float` instance with value, significantDigits and isPercent. Order is calculated from value.</span>
<span class="sd">        If argument checkOrder is **True**, staticmethod *self*.fixFloatsOrder is called and its returned value and order</span>
<span class="sd">        are used.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">value</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span> <span class="n">value</span> <span class="p">)</span>
        <span class="k">if</span><span class="p">(</span> <span class="n">isPercent</span> <span class="p">)</span> <span class="p">:</span> <span class="n">value</span> <span class="o">/=</span> <span class="mf">100.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">order</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">calculateOrder</span><span class="p">(</span> <span class="n">value</span> <span class="p">)</span>
        <span class="k">if</span><span class="p">(</span> <span class="n">checkOrder</span> <span class="p">)</span> <span class="p">:</span> <span class="n">value</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">order</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fixFloatsOrder</span><span class="p">(</span> <span class="n">value</span> <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">value</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_isPercent</span> <span class="o">=</span> <span class="nb">bool</span><span class="p">(</span> <span class="n">isPercent</span> <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setSignificantDigits</span><span class="p">(</span> <span class="n">significantDigits</span> <span class="p">)</span>

    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span> <span class="bp">self</span> <span class="p">)</span> <span class="p">:</span>

        <span class="k">return</span><span class="p">(</span> <span class="s1">&#39;</span><span class="si">%s</span><span class="s1">( &quot;</span><span class="si">%s</span><span class="s1">&quot; )&#39;</span> <span class="o">%</span> <span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span> <span class="bp">self</span> <span class="p">)</span> <span class="p">)</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span> <span class="bp">self</span> <span class="p">)</span> <span class="p">:</span>

        <span class="k">return</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">toString</span><span class="p">(</span> <span class="p">)</span> <span class="p">)</span>

    <span class="k">def</span> <span class="fm">__hash__</span><span class="p">(</span> <span class="bp">self</span> <span class="p">)</span> <span class="p">:</span>

        <span class="k">return</span><span class="p">(</span> <span class="nb">hash</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="p">)</span> <span class="o">+</span> <span class="nb">hash</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">_isPercent</span> <span class="p">)</span> <span class="o">+</span> <span class="nb">hash</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">significantDigits</span> <span class="p">)</span> <span class="p">)</span>

    <span class="k">def</span> <span class="fm">__eq__</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">other</span> <span class="p">)</span> <span class="p">:</span>

        <span class="k">return</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">==</span> <span class="nb">float</span><span class="p">(</span> <span class="n">other</span> <span class="p">)</span> <span class="p">)</span>

    <span class="k">def</span> <span class="fm">__ne__</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">other</span> <span class="p">)</span> <span class="p">:</span>

        <span class="k">return</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">!=</span> <span class="nb">float</span><span class="p">(</span> <span class="n">other</span> <span class="p">)</span> <span class="p">)</span>

    <span class="k">def</span> <span class="fm">__le__</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">other</span> <span class="p">)</span> <span class="p">:</span>

        <span class="k">return</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">&lt;=</span> <span class="nb">float</span><span class="p">(</span> <span class="n">other</span> <span class="p">)</span> <span class="p">)</span>

    <span class="k">def</span> <span class="fm">__lt__</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">other</span> <span class="p">)</span> <span class="p">:</span>

        <span class="k">return</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">&lt;</span> <span class="nb">float</span><span class="p">(</span> <span class="n">other</span> <span class="p">)</span> <span class="p">)</span>

    <span class="k">def</span> <span class="fm">__ge__</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">other</span> <span class="p">)</span> <span class="p">:</span>

        <span class="k">return</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">&gt;=</span> <span class="nb">float</span><span class="p">(</span> <span class="n">other</span> <span class="p">)</span> <span class="p">)</span>

    <span class="k">def</span> <span class="fm">__gt__</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">other</span> <span class="p">)</span> <span class="p">:</span>

        <span class="k">return</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">&gt;</span> <span class="nb">float</span><span class="p">(</span> <span class="n">other</span> <span class="p">)</span> <span class="p">)</span>

    <span class="k">def</span> <span class="fm">__abs__</span><span class="p">(</span> <span class="bp">self</span> <span class="p">)</span> <span class="p">:</span>

        <span class="k">return</span><span class="p">(</span> <span class="n">PQU_float</span><span class="p">(</span> <span class="nb">abs</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">significantDigits</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_isPercent</span><span class="p">,</span> <span class="n">checkOrder</span> <span class="o">=</span> <span class="kc">False</span> <span class="p">)</span> <span class="p">)</span>

    <span class="k">def</span> <span class="fm">__neg__</span><span class="p">(</span> <span class="bp">self</span> <span class="p">)</span> <span class="p">:</span>

        <span class="k">return</span><span class="p">(</span> <span class="n">PQU_float</span><span class="p">(</span> <span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">significantDigits</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_isPercent</span><span class="p">,</span> <span class="n">checkOrder</span> <span class="o">=</span> <span class="kc">False</span> <span class="p">)</span> <span class="p">)</span>

    <span class="k">def</span> <span class="fm">__add__</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">other</span> <span class="p">)</span> <span class="p">:</span>

        <span class="k">if</span><span class="p">(</span> <span class="nb">isinstance</span><span class="p">(</span> <span class="n">other</span><span class="p">,</span> <span class="n">PQU</span> <span class="p">)</span> <span class="p">)</span> <span class="p">:</span> <span class="k">return</span><span class="p">(</span> <span class="n">other</span><span class="o">.</span><span class="fm">__radd__</span><span class="p">(</span> <span class="bp">self</span> <span class="p">)</span> <span class="p">)</span>
        <span class="k">if</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">_isPercent</span> <span class="p">)</span> <span class="p">:</span> <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span> <span class="s1">&#39;Addition of per cent is not allowed (defined)&#39;</span> <span class="p">)</span>
        <span class="n">significantOrder</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">order</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">significantDigits</span>
        <span class="k">if</span><span class="p">(</span> <span class="nb">isinstance</span><span class="p">(</span> <span class="n">other</span><span class="p">,</span> <span class="n">PQU_float</span> <span class="p">)</span> <span class="p">)</span> <span class="p">:</span>
            <span class="k">if</span><span class="p">(</span> <span class="n">other</span><span class="o">.</span><span class="n">_isPercent</span> <span class="p">)</span> <span class="p">:</span> <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span> <span class="s1">&#39;Addition of per cent is not allowed (defined)&#39;</span> <span class="p">)</span>
            <span class="n">value</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">value</span>
            <span class="n">significantOrder</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span> <span class="n">significantOrder</span><span class="p">,</span> <span class="n">other</span><span class="o">.</span><span class="n">order</span> <span class="o">-</span> <span class="n">other</span><span class="o">.</span><span class="n">significantDigits</span> <span class="p">)</span>
        <span class="k">else</span> <span class="p">:</span>
            <span class="n">value</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span> <span class="n">other</span> <span class="p">)</span>
        <span class="n">pqu_f</span> <span class="o">=</span> <span class="n">PQU_float</span><span class="p">(</span> <span class="n">value</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">significantOrder</span><span class="p">,</span> <span class="kc">False</span> <span class="p">)</span>
        <span class="n">significantOrder</span> <span class="o">=</span> <span class="n">pqu_f</span><span class="o">.</span><span class="n">order</span> <span class="o">-</span> <span class="n">significantOrder</span>
        <span class="n">pqu_f</span><span class="o">.</span><span class="n">setSignificantDigits</span><span class="p">(</span> <span class="n">significantOrder</span> <span class="p">)</span>
        <span class="k">return</span><span class="p">(</span> <span class="n">pqu_f</span> <span class="p">)</span>

    <span class="fm">__radd__</span> <span class="o">=</span> <span class="fm">__add__</span>

    <span class="k">def</span> <span class="fm">__iadd__</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">other</span> <span class="p">)</span> <span class="p">:</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_setFrom</span><span class="p">(</span> <span class="bp">self</span> <span class="o">+</span> <span class="n">other</span> <span class="p">)</span>
        <span class="k">return</span><span class="p">(</span> <span class="bp">self</span> <span class="p">)</span>

    <span class="k">def</span> <span class="fm">__sub__</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">other</span> <span class="p">)</span> <span class="p">:</span>

        <span class="k">if</span><span class="p">(</span> <span class="nb">isinstance</span><span class="p">(</span> <span class="n">other</span><span class="p">,</span> <span class="n">PQU</span> <span class="p">)</span> <span class="p">)</span> <span class="p">:</span> <span class="k">return</span><span class="p">(</span> <span class="n">other</span><span class="o">.</span><span class="fm">__rsub__</span><span class="p">(</span> <span class="bp">self</span> <span class="p">)</span> <span class="p">)</span>
        <span class="k">if</span><span class="p">(</span> <span class="nb">isinstance</span><span class="p">(</span> <span class="n">other</span><span class="p">,</span> <span class="n">PQU_float</span> <span class="p">)</span> <span class="p">)</span> <span class="p">:</span>
            <span class="n">other_</span> <span class="o">=</span> <span class="o">-</span><span class="n">other</span>
        <span class="k">else</span> <span class="p">:</span>
            <span class="n">other_</span> <span class="o">=</span> <span class="o">-</span><span class="nb">float</span><span class="p">(</span> <span class="n">other</span> <span class="p">)</span>
        <span class="k">return</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="fm">__add__</span><span class="p">(</span> <span class="n">other_</span> <span class="p">)</span> <span class="p">)</span>

    <span class="k">def</span> <span class="fm">__rsub__</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">other</span> <span class="p">)</span> <span class="p">:</span>

        <span class="k">return</span><span class="p">(</span> <span class="o">-</span><span class="bp">self</span> <span class="o">+</span> <span class="n">other</span> <span class="p">)</span>

    <span class="k">def</span> <span class="fm">__isub__</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">other</span> <span class="p">)</span> <span class="p">:</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_setFrom</span><span class="p">(</span> <span class="bp">self</span> <span class="o">-</span> <span class="n">other</span> <span class="p">)</span>
        <span class="k">return</span><span class="p">(</span> <span class="bp">self</span> <span class="p">)</span>

    <span class="k">def</span> <span class="fm">__mul__</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">other</span> <span class="p">)</span> <span class="p">:</span>

        <span class="k">if</span><span class="p">(</span> <span class="nb">isinstance</span><span class="p">(</span> <span class="n">other</span><span class="p">,</span> <span class="n">PQU</span> <span class="p">)</span> <span class="p">)</span> <span class="p">:</span> <span class="k">return</span><span class="p">(</span> <span class="n">other</span><span class="o">.</span><span class="fm">__rmul__</span><span class="p">(</span> <span class="bp">self</span> <span class="p">)</span> <span class="p">)</span>
        <span class="n">significantDigits</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">significantDigits</span>
        <span class="k">if</span><span class="p">(</span> <span class="nb">isinstance</span><span class="p">(</span> <span class="n">other</span><span class="p">,</span> <span class="n">PQU_float</span> <span class="p">)</span> <span class="p">)</span> <span class="p">:</span>
            <span class="n">value</span><span class="p">,</span> <span class="n">significantDigits</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="nb">min</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">significantDigits</span><span class="p">,</span> <span class="n">other</span><span class="o">.</span><span class="n">significantDigits</span> <span class="p">)</span>
        <span class="k">else</span> <span class="p">:</span>
            <span class="n">value</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span> <span class="n">other</span> <span class="p">)</span>
        <span class="k">return</span><span class="p">(</span> <span class="n">PQU_float</span><span class="p">(</span> <span class="n">value</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">significantDigits</span><span class="p">,</span> <span class="kc">False</span> <span class="p">)</span> <span class="p">)</span>

    <span class="fm">__rmul__</span> <span class="o">=</span> <span class="fm">__mul__</span>

    <span class="k">def</span> <span class="fm">__imul__</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">other</span> <span class="p">)</span> <span class="p">:</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_setFrom</span><span class="p">(</span> <span class="bp">self</span> <span class="o">*</span> <span class="n">other</span> <span class="p">)</span>
        <span class="k">return</span><span class="p">(</span> <span class="bp">self</span> <span class="p">)</span>

    <span class="k">def</span> <span class="fm">__truediv__</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">other</span> <span class="p">)</span> <span class="p">:</span>

        <span class="k">if</span><span class="p">(</span> <span class="nb">isinstance</span><span class="p">(</span> <span class="n">other</span><span class="p">,</span> <span class="n">PQU</span> <span class="p">)</span> <span class="p">)</span> <span class="p">:</span> <span class="k">return</span><span class="p">(</span> <span class="n">other</span><span class="o">.</span><span class="fm">__rtruediv__</span><span class="p">(</span> <span class="bp">self</span> <span class="p">)</span> <span class="p">)</span>
        <span class="n">significantDigits</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">significantDigits</span>
        <span class="k">if</span><span class="p">(</span> <span class="nb">isinstance</span><span class="p">(</span> <span class="n">other</span><span class="p">,</span> <span class="n">PQU_float</span> <span class="p">)</span> <span class="p">)</span> <span class="p">:</span>
            <span class="n">value</span><span class="p">,</span> <span class="n">significantDigits</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="nb">min</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">significantDigits</span><span class="p">,</span> <span class="n">other</span><span class="o">.</span><span class="n">significantDigits</span> <span class="p">)</span>
        <span class="k">else</span> <span class="p">:</span>
            <span class="n">value</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span> <span class="n">other</span> <span class="p">)</span>
        <span class="k">return</span><span class="p">(</span> <span class="n">PQU_float</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">/</span> <span class="n">value</span><span class="p">,</span> <span class="n">significantDigits</span><span class="p">,</span> <span class="kc">False</span> <span class="p">)</span> <span class="p">)</span>

    <span class="k">def</span> <span class="fm">__rtruediv__</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">other</span> <span class="p">)</span> <span class="p">:</span>

        <span class="n">value</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span> <span class="n">other</span> <span class="p">)</span>
        <span class="k">return</span><span class="p">(</span> <span class="n">PQU_float</span><span class="p">(</span> <span class="n">value</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">significantDigits</span> <span class="p">)</span> <span class="p">)</span>

    <span class="k">def</span> <span class="fm">__itruediv__</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">other</span> <span class="p">)</span> <span class="p">:</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_setFrom</span><span class="p">(</span> <span class="bp">self</span> <span class="o">/</span> <span class="n">other</span> <span class="p">)</span>
        <span class="k">return</span><span class="p">(</span> <span class="bp">self</span> <span class="p">)</span>

    <span class="n">__div__</span> <span class="o">=</span> <span class="fm">__truediv__</span>   <span class="c1"># for Python 2.x</span>
    <span class="n">__rdiv__</span> <span class="o">=</span> <span class="fm">__rtruediv__</span>
    <span class="n">__idiv__</span> <span class="o">=</span> <span class="fm">__itruediv__</span>

    <span class="k">def</span> <span class="fm">__pow__</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">other</span> <span class="p">)</span> <span class="p">:</span>

        <span class="n">power</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span> <span class="n">other</span> <span class="p">)</span>
        <span class="k">return</span><span class="p">(</span> <span class="n">PQU_float</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="o">**</span><span class="n">power</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">significantDigits</span> <span class="p">)</span> <span class="p">)</span>

    <span class="k">def</span> <span class="fm">__float__</span><span class="p">(</span> <span class="bp">self</span> <span class="p">)</span> <span class="p">:</span>

        <span class="k">return</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="p">)</span>

    <span class="k">def</span> <span class="fm">__bool__</span><span class="p">(</span> <span class="bp">self</span> <span class="p">)</span> <span class="p">:</span>

        <span class="k">return</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">!=</span> <span class="mf">0.</span> <span class="p">)</span>

    <span class="n">__nonzero__</span> <span class="o">=</span> <span class="fm">__bool__</span>      <span class="c1"># for python 2.x</span>

    <span class="k">def</span> <span class="nf">_setFrom</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">other</span> <span class="p">)</span> <span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Sets *self*&#39;s members from other. Other must be a :py:class:`PQU_float` instance.&quot;&quot;&quot;</span>

        <span class="k">if</span><span class="p">(</span> <span class="ow">not</span><span class="p">(</span> <span class="nb">isinstance</span><span class="p">(</span> <span class="n">other</span><span class="p">,</span> <span class="n">PQU_float</span> <span class="p">)</span> <span class="p">)</span> <span class="p">)</span> <span class="p">:</span> <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span> <span class="s2">&quot;other type </span><span class="si">%s</span><span class="s2"> not supported&quot;</span> <span class="o">%</span> <span class="nb">type</span><span class="p">(</span> <span class="n">other</span> <span class="p">)</span> <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">value</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_isPercent</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">_isPercent</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">order</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">order</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">significantDigits</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">significantDigits</span>

<div class="viewcode-block" id="PQU_float.getValue"><a class="viewcode-back" href="../../pqu/pqu.html#pqu.PQU.PQU_float.getValue">[docs]</a>    <span class="k">def</span> <span class="nf">getValue</span><span class="p">(</span> <span class="bp">self</span> <span class="p">)</span> <span class="p">:</span>      <span class="c1"># Deprecated - replaced with __float__</span>
        <span class="s2">&quot;Returns *self*&#39;s value. Equivalent to float( *self* ).&quot;</span>

        <span class="k">return</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="p">)</span></div>

<div class="viewcode-block" id="PQU_float.getOrder"><a class="viewcode-back" href="../../pqu/pqu.html#pqu.PQU.PQU_float.getOrder">[docs]</a>    <span class="k">def</span> <span class="nf">getOrder</span><span class="p">(</span> <span class="bp">self</span> <span class="p">)</span> <span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns *self*&#39;s order.</span>

<span class="sd">        :rtype: `int`</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">order</span> <span class="p">)</span></div>

<div class="viewcode-block" id="PQU_float.getSignificantDigits"><a class="viewcode-back" href="../../pqu/pqu.html#pqu.PQU.PQU_float.getSignificantDigits">[docs]</a>    <span class="k">def</span> <span class="nf">getSignificantDigits</span><span class="p">(</span> <span class="bp">self</span> <span class="p">)</span> <span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns *self*&#39;s significant digits.</span>

<span class="sd">        :rtype: `int`</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">significantDigits</span> <span class="p">)</span></div>

<div class="viewcode-block" id="PQU_float.info"><a class="viewcode-back" href="../../pqu/pqu.html#pqu.PQU.PQU_float.info">[docs]</a>    <span class="k">def</span> <span class="nf">info</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">significantDigits</span> <span class="o">=</span> <span class="mi">17</span> <span class="p">)</span> <span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a detailed string of *self*. Mainly for debugging.</span>

<span class="sd">        :rtype: `str`</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">value</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%%</span><span class="s2">.</span><span class="si">%d</span><span class="s2">e&quot;</span> <span class="o">%</span> <span class="n">significantDigits</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span>
        <span class="k">return</span><span class="p">(</span> <span class="s2">&quot;value = </span><span class="si">%s</span><span class="s2">, significantDigits = </span><span class="si">%d</span><span class="s2">, order = </span><span class="si">%d</span><span class="s2">, isPercent = </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span> <span class="n">value</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">significantDigits</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">order</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_isPercent</span> <span class="p">)</span> <span class="p">)</span></div>

<div class="viewcode-block" id="PQU_float.isPercent"><a class="viewcode-back" href="../../pqu/pqu.html#pqu.PQU.PQU_float.isPercent">[docs]</a>    <span class="k">def</span> <span class="nf">isPercent</span><span class="p">(</span> <span class="bp">self</span> <span class="p">)</span> <span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns **True** if *self* is a percent and **False** otherwise.</span>

<span class="sd">        :rtype: `bool`</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">_isPercent</span> <span class="p">)</span></div>

<div class="viewcode-block" id="PQU_float.setPercentFlag"><a class="viewcode-back" href="../../pqu/pqu.html#pqu.PQU.PQU_float.setPercentFlag">[docs]</a>    <span class="k">def</span> <span class="nf">setPercentFlag</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">isPercent</span><span class="p">,</span> <span class="n">scaleValue</span> <span class="o">=</span> <span class="kc">False</span> <span class="p">)</span> <span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        If argument isPercent is **True** and *self* is not a percent, *self* is converted to a percent.</span>
<span class="sd">        If argument isPercent is **False** and *self* is a percent, *self* is converted to non-percent.</span>
<span class="sd">        Otherwise, a raise is executed.</span>

<span class="sd">        If scaleValue is **False**, the value is not changed; otherwise, value is scale by 0.01 (100)</span>
<span class="sd">        if isPercent is **True** (**False**).</span>

<span class="sd">        :param isPercent: see documentation.</span>
<span class="sd">        :type isPercent: `bool`</span>

<span class="sd">        :param scaleValue: see documentation.</span>
<span class="sd">        :type scaleValue: `bool`</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span><span class="p">(</span> <span class="nb">bool</span><span class="p">(</span> <span class="n">isPercent</span> <span class="p">)</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">_isPercent</span> <span class="p">)</span> <span class="p">:</span> <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span> <span class="s2">&quot;Percent flag is already </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">_isPercent</span> <span class="p">)</span>
        <span class="k">if</span><span class="p">(</span> <span class="n">isPercent</span> <span class="p">)</span> <span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_isPercent</span><span class="p">,</span> <span class="n">scale</span><span class="p">,</span> <span class="n">orderDelta</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span>
        <span class="k">else</span> <span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_isPercent</span><span class="p">,</span> <span class="n">scale</span><span class="p">,</span> <span class="n">orderDelta</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="mf">100.</span><span class="p">,</span> <span class="mi">2</span>
        <span class="k">if</span><span class="p">(</span> <span class="n">scaleValue</span> <span class="p">)</span> <span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">*=</span> <span class="n">scale</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">order</span> <span class="o">+=</span> <span class="n">orderDelta</span></div>

<div class="viewcode-block" id="PQU_float.setSignificantDigits"><a class="viewcode-back" href="../../pqu/pqu.html#pqu.PQU.PQU_float.setSignificantDigits">[docs]</a>    <span class="k">def</span> <span class="nf">setSignificantDigits</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">significantDigits</span> <span class="p">)</span> <span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Sets *self*&#39;s significant digits to significantDigits.</span>

<span class="sd">        :param significantDigits: see documentation.</span>
<span class="sd">        :type significantDigits: `int`</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">significantDigits</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span> <span class="mi">1</span><span class="p">,</span> <span class="nb">min</span><span class="p">(</span> <span class="n">maxSignificantDigits</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span> <span class="n">significantDigits</span> <span class="p">)</span> <span class="p">)</span> <span class="p">)</span></div>

<div class="viewcode-block" id="PQU_float.toString"><a class="viewcode-back" href="../../pqu/pqu.html#pqu.PQU.PQU_float.toString">[docs]</a>    <span class="k">def</span> <span class="nf">toString</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">trimZeros</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">keepPeriod</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">includePercent</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">favorEFormBy</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">significantDigits</span> <span class="o">=</span> <span class="kc">None</span> <span class="p">)</span> <span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a string representation of *self* (i.e., &#39;1.234e6&#39; or &#39;12%&#39;) using function :py:func:`floatToShortestString`.</span>

<span class="sd">        :param bool trimZeros: See function :py:func:`floatToShortestString`</span>
<span class="sd">        :param bool keepPeriod: See function :py:func:`floatToShortestString`</span>
<span class="sd">        :param int favorEFormBy: See function :py:func:`floatToShortestString`</span>
<span class="sd">        :param significantDigits: (*int* or *None*) Used to override self&#39;s default significantDigits</span>
<span class="sd">        :rtype: `str`</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span>
        <span class="k">if</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">_isPercent</span> <span class="p">)</span> <span class="p">:</span> <span class="n">value</span> <span class="o">*=</span> <span class="mf">100.</span>
        <span class="k">if</span><span class="p">(</span> <span class="n">significantDigits</span> <span class="ow">is</span> <span class="kc">None</span> <span class="p">)</span> <span class="p">:</span> <span class="n">significantDigits</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">significantDigits</span>
        <span class="n">str1</span> <span class="o">=</span> <span class="n">floatToShortestString</span><span class="p">(</span> <span class="n">value</span><span class="p">,</span> <span class="n">significantDigits</span> <span class="o">=</span> <span class="n">significantDigits</span><span class="p">,</span> <span class="n">trimZeros</span> <span class="o">=</span> <span class="n">trimZeros</span><span class="p">,</span> 
            <span class="n">keepPeriod</span> <span class="o">=</span> <span class="n">keepPeriod</span><span class="p">,</span> <span class="n">favorEFormBy</span> <span class="o">=</span> <span class="n">favorEFormBy</span> <span class="p">)</span>
        <span class="k">if</span><span class="p">(</span> <span class="n">includePercent</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_isPercent</span> <span class="p">)</span> <span class="p">:</span> <span class="n">str1</span> <span class="o">+=</span> <span class="s1">&#39;%&#39;</span>
        <span class="k">return</span><span class="p">(</span> <span class="n">str1</span> <span class="p">)</span></div>

<div class="viewcode-block" id="PQU_float.truncate"><a class="viewcode-back" href="../../pqu/pqu.html#pqu.PQU.PQU_float.truncate">[docs]</a>    <span class="k">def</span> <span class="nf">truncate</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">significantDigits</span> <span class="o">=</span> <span class="kc">None</span> <span class="p">)</span> <span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Adjusts *self*&#39;s value so that only significantDigits are non-zero. For example, if value is 3.453983207834109</span>
<span class="sd">        and significantDigits = 4 then the value is set to 3.454. If significantDigits is None, *self*&#39;s significantDigits</span>
<span class="sd">        is used.</span>

<span class="sd">        :param significantDigits: </span>
<span class="sd">        :type significantDigits: None or `int`</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span><span class="p">(</span> <span class="n">significantDigits</span> <span class="ow">is</span> <span class="kc">None</span> <span class="p">)</span> <span class="p">:</span> <span class="n">significantDigits</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">significantDigits</span>
        <span class="n">significantDigits</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span> <span class="n">maxSignificantDigits</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="nb">max</span><span class="p">(</span> <span class="mi">1</span><span class="p">,</span> <span class="n">significantDigits</span> <span class="p">)</span> <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span> <span class="s2">&quot;</span><span class="si">%%</span><span class="s2">.</span><span class="si">%d</span><span class="s2">e&quot;</span> <span class="o">%</span> <span class="p">(</span> <span class="n">significantDigits</span> <span class="o">-</span> <span class="mi">1</span> <span class="p">)</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setSignificantDigits</span><span class="p">(</span> <span class="n">significantDigits</span> <span class="p">)</span></div>

<div class="viewcode-block" id="PQU_float.calculateOrder"><a class="viewcode-back" href="../../pqu/pqu.html#pqu.PQU.PQU_float.calculateOrder">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">calculateOrder</span><span class="p">(</span> <span class="n">value</span> <span class="p">)</span> <span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the order of value. Value must be convertible to a float. A float&#39;s order is the exponent in the</span>
<span class="sd">        representation &#39;m * 10**o&#39; where &#39;m&#39; is the mantissa and &#39;o&#39; is the exponent. For example, 1.234e43 has order 43.</span>

<span class="sd">        :param value: any object convertible to a float.</span>
<span class="sd">        :rtype: integer</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">value</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span> <span class="nb">float</span><span class="p">(</span> <span class="n">value</span> <span class="p">)</span> <span class="p">)</span>
        <span class="k">if</span><span class="p">(</span> <span class="n">value</span> <span class="o">==</span> <span class="mf">0.</span> <span class="p">)</span> <span class="p">:</span> <span class="k">return</span><span class="p">(</span> <span class="mi">0</span> <span class="p">)</span>
        <span class="n">log10</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">log10</span><span class="o">.</span><span class="n">is_integer</span><span class="p">():</span> <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="n">log10</span><span class="p">)</span>
        <span class="n">s1</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%.17e</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">value</span>
        <span class="k">return</span><span class="p">(</span> <span class="nb">int</span><span class="p">(</span> <span class="n">s1</span><span class="o">.</span><span class="n">split</span><span class="p">(</span> <span class="s1">&#39;e&#39;</span> <span class="p">)[</span><span class="mi">1</span><span class="p">]</span> <span class="p">)</span> <span class="p">)</span></div>

<div class="viewcode-block" id="PQU_float.fixFloatsOrder"><a class="viewcode-back" href="../../pqu/pqu.html#pqu.PQU.PQU_float.fixFloatsOrder">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">fixFloatsOrder</span><span class="p">(</span> <span class="n">value</span> <span class="p">)</span> <span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Many numbers are not represented in IEEE floating point by there true value. For example, &#39;1e-12&#39; is </span>
<span class="sd">        stored as the float 9.9999999999999998e-13. The order of the true value is -12 while the order of the floating </span>
<span class="sd">        point representation is -13.  This function is implemented to help with this issue.  For example, for </span>
<span class="sd">        :py:class:`PQU` the string &quot;2.300000000003 (1)&quot; was originally being reprinted as &quot;2.300000000003 (10)&quot; because of this issue.</span>
<span class="sd">        To check for this, the value is multiplied by a small (of order sys.float_info.epsilon) factor to see if order </span>
<span class="sd">        changes.  If it does, value is set to the smallest multiplier greater than 1 for which order is changed. </span>
<span class="sd">        The fixed value and its order are returned.</span>

<span class="sd">        :param value: any object convertible to a float.</span>
<span class="sd">        :rtype: tuple of float and integer</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">value</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span> <span class="n">value</span> <span class="p">)</span>
        <span class="n">order1</span> <span class="o">=</span> <span class="n">PQU_float</span><span class="o">.</span><span class="n">calculateOrder</span><span class="p">(</span> <span class="n">value</span> <span class="p">)</span>
        <span class="n">order2</span> <span class="o">=</span> <span class="n">PQU_float</span><span class="o">.</span><span class="n">calculateOrder</span><span class="p">(</span> <span class="n">value</span> <span class="o">*</span> <span class="p">(</span> <span class="mi">1</span> <span class="o">+</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">sys</span><span class="o">.</span><span class="n">float_info</span><span class="o">.</span><span class="n">epsilon</span> <span class="p">)</span> <span class="p">)</span>
        <span class="k">if</span><span class="p">(</span> <span class="n">order1</span> <span class="o">!=</span> <span class="n">order2</span> <span class="p">)</span> <span class="p">:</span>
            <span class="k">for</span> <span class="n">i1</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span> <span class="mi">5</span> <span class="p">)</span> <span class="p">:</span>
                <span class="n">value_</span> <span class="o">=</span> <span class="n">value</span> <span class="o">*</span> <span class="p">(</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">i1</span> <span class="o">*</span> <span class="n">sys</span><span class="o">.</span><span class="n">float_info</span><span class="o">.</span><span class="n">epsilon</span> <span class="p">)</span>
                <span class="n">order2</span> <span class="o">=</span> <span class="n">PQU_float</span><span class="o">.</span><span class="n">calculateOrder</span><span class="p">(</span> <span class="n">value_</span> <span class="p">)</span>
                <span class="k">if</span><span class="p">(</span> <span class="n">order1</span> <span class="o">!=</span> <span class="n">order2</span> <span class="p">)</span> <span class="p">:</span> <span class="k">break</span>
            <span class="n">value</span> <span class="o">=</span> <span class="n">value_</span>
            <span class="n">order1</span> <span class="o">=</span> <span class="n">order2</span>
        <span class="k">return</span><span class="p">(</span> <span class="n">value</span><span class="p">,</span> <span class="n">order1</span> <span class="p">)</span></div>

<div class="viewcode-block" id="PQU_float.surmiseSignificantDigits"><a class="viewcode-back" href="../../pqu/pqu.html#pqu.PQU.PQU_float.surmiseSignificantDigits">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">surmiseSignificantDigits</span><span class="p">(</span> <span class="n">value</span> <span class="p">)</span> <span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This factory function returns a :py:class:`PQU_float` instance given a float *value* and sets its significantDigits to</span>
<span class="sd">        something &quot;reasonable&quot;. The significantDigits are determined by using PQU.floatToShortestString with trimZeros = True.</span>

<span class="sd">        :param value:   The float that is converted to a :py:class:`PQU_float` instance.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">value_</span> <span class="o">=</span> <span class="n">PQU</span><span class="p">(</span> <span class="n">floatToShortestString</span><span class="p">(</span> <span class="nb">float</span><span class="p">(</span> <span class="n">value</span> <span class="p">),</span> <span class="n">trimZeros</span> <span class="o">=</span> <span class="kc">True</span> <span class="p">)</span> <span class="p">)</span>
        <span class="k">return</span><span class="p">(</span> <span class="n">PQU_float</span><span class="p">(</span> <span class="n">value</span><span class="p">,</span> <span class="n">value_</span><span class="o">.</span><span class="n">getSignificantDigits</span><span class="p">(</span> <span class="p">)</span> <span class="p">)</span> <span class="p">)</span></div></div>


<div class="viewcode-block" id="PQU_uncertainty"><a class="viewcode-back" href="../../pqu/pqu.html#pqu.PQU.PQU_uncertainty">[docs]</a><span class="k">class</span> <span class="nc">PQU_uncertainty</span> <span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This class is used by :py:class:`PQU` to store the style of uncertainty and information about its value.</span>
<span class="sd">    The members are:</span>

<span class="sd">    * style --- One of the three following uncertainty styles supported by :py:class:`PQU`:</span>
<span class="sd">                - pqu_uncertaintyStyleNone          - No uncertainty was given for the :py:class:`PQU` instance.</span>
<span class="sd">                - pqu_uncertaintyStylePlusMinus     - The uncertainty was given as &#39;+/- value&#39; (e.g., &#39;123 +/- 32&#39;).</span>
<span class="sd">                - pqu_uncertaintyStyleParenthesis   - The uncertainty was given as &#39;(value)&#39; (e.g., &#39;123(32)&#39;.</span>

<span class="sd">    * value --- The value stored as a :py:class:`PQU_float`.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">pqu_uncertaintyStyleNone</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">pqu_uncertaintyStylePlusMinus</span> <span class="o">=</span> <span class="s1">&#39;plusMinus&#39;</span>
    <span class="n">pqu_uncertaintyStyleParenthesis</span> <span class="o">=</span> <span class="s1">&#39;parenthesis&#39;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">uncertaintyStyle</span><span class="p">,</span> <span class="n">value</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">significantDigits</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">isPercent</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">checkOrder</span> <span class="o">=</span> <span class="kc">True</span> <span class="p">)</span> <span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Constructor method for the :py:class:`PQU_uncertainty` class. The arguments value, significantDigits, isPrecent</span>
<span class="sd">        and checkOrder are passed onto :py:class:`PQU_float`. significantDigits will be forced to be 1 or 2.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span><span class="p">(</span> <span class="n">isPercent</span> <span class="ow">and</span> <span class="p">(</span> <span class="n">uncertaintyStyle</span> <span class="o">!=</span> <span class="n">PQU_uncertainty</span><span class="o">.</span><span class="n">pqu_uncertaintyStylePlusMinus</span> <span class="p">)</span> <span class="p">)</span> <span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span> <span class="s1">&#39;percent only supported for style &quot;</span><span class="si">%s</span><span class="s1">&quot;&#39;</span> <span class="o">%</span> <span class="n">PQU_uncertainty</span><span class="o">.</span><span class="n">pqu_uncertaintyStylePlusMinus</span> <span class="p">)</span>
        <span class="k">if</span><span class="p">(</span> <span class="n">value</span> <span class="o">==</span> <span class="mf">0.</span> <span class="p">)</span> <span class="p">:</span> <span class="n">uncertaintyStyle</span> <span class="o">=</span> <span class="n">PQU_uncertainty</span><span class="o">.</span><span class="n">pqu_uncertaintyStyleNone</span>
        <span class="n">significantDigits</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span> <span class="mi">1</span><span class="p">,</span> <span class="nb">min</span><span class="p">(</span> <span class="mi">2</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span> <span class="n">significantDigits</span> <span class="p">)</span> <span class="p">)</span> <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">style</span> <span class="o">=</span> <span class="n">uncertaintyStyle</span>
        <span class="k">if</span><span class="p">(</span> <span class="n">uncertaintyStyle</span> <span class="o">==</span> <span class="n">PQU_uncertainty</span><span class="o">.</span><span class="n">pqu_uncertaintyStyleNone</span> <span class="p">)</span> <span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">PQU_float</span><span class="p">(</span> <span class="mf">0.</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">checkOrder</span> <span class="o">=</span> <span class="kc">False</span> <span class="p">)</span>
        <span class="k">elif</span><span class="p">(</span> <span class="n">uncertaintyStyle</span> <span class="o">==</span> <span class="n">PQU_uncertainty</span><span class="o">.</span><span class="n">pqu_uncertaintyStylePlusMinus</span> <span class="p">)</span> <span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">PQU_float</span><span class="p">(</span> <span class="nb">abs</span><span class="p">(</span> <span class="n">value</span> <span class="p">),</span> <span class="n">significantDigits</span><span class="p">,</span> <span class="n">isPercent</span><span class="p">,</span> <span class="n">checkOrder</span> <span class="o">=</span> <span class="n">checkOrder</span> <span class="p">)</span>
        <span class="k">elif</span><span class="p">(</span> <span class="n">uncertaintyStyle</span> <span class="o">==</span> <span class="n">PQU_uncertainty</span><span class="o">.</span><span class="n">pqu_uncertaintyStyleParenthesis</span> <span class="p">)</span> <span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">PQU_float</span><span class="p">(</span> <span class="nb">abs</span><span class="p">(</span> <span class="n">value</span> <span class="p">),</span> <span class="n">significantDigits</span><span class="p">,</span> <span class="n">checkOrder</span> <span class="o">=</span> <span class="n">checkOrder</span> <span class="p">)</span>
        <span class="k">else</span> <span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span> <span class="s1">&#39;Invalid uncertainty style &quot;</span><span class="si">%s</span><span class="s1">&quot;&#39;</span> <span class="o">%</span> <span class="n">uncertaintyStyle</span> <span class="p">)</span>

    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span> <span class="bp">self</span> <span class="p">)</span> <span class="p">:</span>

        <span class="k">return</span><span class="p">(</span> <span class="s1">&#39;</span><span class="si">%s</span><span class="s1">( &quot;</span><span class="si">%s</span><span class="s1">&quot; )&#39;</span> <span class="o">%</span> <span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span> <span class="bp">self</span> <span class="p">)</span> <span class="p">)</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span> <span class="bp">self</span> <span class="p">)</span> <span class="p">:</span>

        <span class="k">return</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">toString</span><span class="p">(</span> <span class="p">)</span> <span class="p">)</span>

    <span class="k">def</span> <span class="fm">__hash__</span><span class="p">(</span> <span class="bp">self</span> <span class="p">)</span> <span class="p">:</span>

        <span class="k">return</span><span class="p">(</span> <span class="nb">hash</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">style</span> <span class="p">)</span> <span class="o">+</span> <span class="nb">hash</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="p">)</span> <span class="p">)</span>

    <span class="k">def</span> <span class="fm">__mul__</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">other</span> <span class="p">)</span> <span class="p">:</span>
        <span class="s2">&quot;For internal use only. Only works if other is a float.&quot;</span>

        <span class="k">if</span><span class="p">(</span> <span class="ow">not</span><span class="p">(</span> <span class="nb">isinstance</span><span class="p">(</span> <span class="n">other</span><span class="p">,</span> <span class="nb">float</span> <span class="p">)</span> <span class="p">)</span> <span class="p">)</span> <span class="p">:</span> <span class="ne">TypeError</span><span class="p">(</span> <span class="s1">&#39;Other type = &quot;</span><span class="si">%s</span><span class="s1">&quot; not supported&#39;</span> <span class="o">%</span> <span class="nb">type</span><span class="p">(</span> <span class="n">other</span> <span class="p">)</span> <span class="p">)</span>
        <span class="k">return</span><span class="p">(</span> <span class="n">PQU_uncertainty</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">style</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">*</span> <span class="n">other</span><span class="p">,</span> <span class="n">significantDigits</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">significantDigits</span><span class="p">,</span> <span class="n">isPercent</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">isPercent</span><span class="p">(</span> <span class="p">)</span> <span class="p">)</span> <span class="p">)</span>

    <span class="fm">__rmul__</span> <span class="o">=</span> <span class="fm">__mul__</span>

    <span class="k">def</span> <span class="fm">__float__</span><span class="p">(</span> <span class="bp">self</span> <span class="p">)</span> <span class="p">:</span>

        <span class="k">return</span><span class="p">(</span> <span class="nb">float</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="p">)</span> <span class="p">)</span>

    <span class="k">def</span> <span class="nf">_changeUncertaintyStyle</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">style</span> <span class="p">)</span> <span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;For internal use.&quot;&quot;&quot;</span>

        <span class="k">if</span><span class="p">(</span> <span class="ow">not</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">_okayToChangeUncertaintyStyleTo</span><span class="p">(</span> <span class="n">style</span> <span class="p">)</span> <span class="p">)</span> <span class="p">)</span> <span class="p">:</span> 
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span> <span class="s1">&#39;Cannot change uncertainty style from &quot;</span><span class="si">%s</span><span class="s1">&quot; to &quot;</span><span class="si">%s</span><span class="s1">&quot;&#39;</span> <span class="o">%</span> <span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">style</span><span class="p">,</span> <span class="n">style</span> <span class="p">)</span> <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">style</span> <span class="o">=</span> <span class="n">style</span>

    <span class="k">def</span> <span class="nf">_okayToChangeUncertaintyStyleTo</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">style</span><span class="p">,</span> <span class="n">checkPercent</span> <span class="o">=</span> <span class="kc">True</span> <span class="p">)</span> <span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;For internal use.&quot;&quot;&quot;</span>

        <span class="k">if</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">style</span> <span class="o">==</span> <span class="n">style</span> <span class="p">)</span> <span class="p">:</span> <span class="k">return</span><span class="p">(</span> <span class="kc">True</span> <span class="p">)</span>
        <span class="k">if</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">style</span> <span class="o">==</span> <span class="n">PQU_uncertainty</span><span class="o">.</span><span class="n">pqu_uncertaintyStyleNone</span> <span class="p">)</span> <span class="p">:</span> <span class="k">return</span><span class="p">(</span> <span class="kc">False</span> <span class="p">)</span>
        <span class="k">if</span><span class="p">(</span> <span class="n">style</span> <span class="o">==</span> <span class="n">PQU_uncertainty</span><span class="o">.</span><span class="n">pqu_uncertaintyStyleNone</span> <span class="p">)</span> <span class="p">:</span> <span class="k">return</span><span class="p">(</span> <span class="kc">False</span> <span class="p">)</span>
        <span class="k">if</span><span class="p">(</span> <span class="p">(</span> <span class="n">style</span> <span class="o">!=</span> <span class="n">PQU_uncertainty</span><span class="o">.</span><span class="n">pqu_uncertaintyStyleParenthesis</span> <span class="p">)</span> <span class="ow">and</span> 
            <span class="p">(</span> <span class="n">style</span> <span class="o">!=</span> <span class="n">PQU_uncertainty</span><span class="o">.</span><span class="n">pqu_uncertaintyStylePlusMinus</span> <span class="p">)</span> <span class="p">)</span> <span class="p">:</span> <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span> <span class="s1">&#39;Invalid style &quot;</span><span class="si">%s</span><span class="s1">&quot;&#39;</span> <span class="o">%</span> <span class="n">style</span> <span class="p">)</span>
        <span class="k">if</span><span class="p">(</span> <span class="n">checkPercent</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">isPercent</span><span class="p">(</span> <span class="p">)</span> <span class="p">)</span> <span class="p">:</span> <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span> <span class="s2">&quot;Cannot change pqu_uncertaintyStylePlusMinus that is a percent&quot;</span> <span class="p">)</span>
        <span class="k">return</span><span class="p">(</span> <span class="kc">True</span> <span class="p">)</span>

<div class="viewcode-block" id="PQU_uncertainty.getStyle"><a class="viewcode-back" href="../../pqu/pqu.html#pqu.PQU.PQU_uncertainty.getStyle">[docs]</a>    <span class="k">def</span> <span class="nf">getStyle</span><span class="p">(</span> <span class="bp">self</span> <span class="p">)</span> <span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns *self*&#39;s style.</span>

<span class="sd">        :rtype: One of the three uncertainty styles</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">style</span> <span class="p">)</span></div>

<div class="viewcode-block" id="PQU_uncertainty.getProperValue"><a class="viewcode-back" href="../../pqu/pqu.html#pqu.PQU.PQU_uncertainty.getProperValue">[docs]</a>    <span class="k">def</span> <span class="nf">getProperValue</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">v</span> <span class="p">)</span> <span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns *self*&#39;s value. If value is a percent, returned result is multiplied by argument v first, where v</span>
<span class="sd">        is expected to be the number associated the the percent value.</span>

<span class="sd">        :param v:       Only used if *self*.value is a percent and only the float(v) is used in that case.</span>
<span class="sd">        :rtype: `float`</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">value</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="p">)</span>
        <span class="k">if</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">isPercent</span><span class="p">(</span> <span class="p">)</span> <span class="p">)</span> <span class="p">:</span> <span class="n">value</span> <span class="o">*=</span> <span class="nb">float</span><span class="p">(</span> <span class="n">v</span> <span class="p">)</span>
        <span class="k">return</span><span class="p">(</span> <span class="n">value</span> <span class="p">)</span></div>

<div class="viewcode-block" id="PQU_uncertainty.info"><a class="viewcode-back" href="../../pqu/pqu.html#pqu.PQU.PQU_uncertainty.info">[docs]</a>    <span class="k">def</span> <span class="nf">info</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">significantDigits</span> <span class="o">=</span> <span class="mi">17</span> <span class="p">)</span> <span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns a detailed string of *self*. Mainly for debugging.</span>

<span class="sd">        :rtype: `str`</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">style</span> <span class="o">==</span> <span class="n">PQU_uncertainty</span><span class="o">.</span><span class="n">pqu_uncertaintyStyleNone</span> <span class="p">)</span> <span class="p">:</span> <span class="k">return</span><span class="p">(</span> <span class="s1">&#39;&#39;</span> <span class="p">)</span>
        <span class="k">return</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">info</span><span class="p">(</span> <span class="n">significantDigits</span> <span class="o">=</span> <span class="n">significantDigits</span> <span class="p">)</span> <span class="p">)</span></div>

<div class="viewcode-block" id="PQU_uncertainty.isUncertainty"><a class="viewcode-back" href="../../pqu/pqu.html#pqu.PQU.PQU_uncertainty.isUncertainty">[docs]</a>    <span class="k">def</span> <span class="nf">isUncertainty</span><span class="p">(</span> <span class="bp">self</span> <span class="p">)</span> <span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns **False** is style is pqu_uncertaintyStyleNone and **True** otherwise.</span>

<span class="sd">        :rtype: `bool`</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">style</span> <span class="o">!=</span> <span class="n">PQU_uncertainty</span><span class="o">.</span><span class="n">pqu_uncertaintyStyleNone</span> <span class="p">)</span></div>

<div class="viewcode-block" id="PQU_uncertainty.isPercent"><a class="viewcode-back" href="../../pqu/pqu.html#pqu.PQU.PQU_uncertainty.isPercent">[docs]</a>    <span class="k">def</span> <span class="nf">isPercent</span><span class="p">(</span> <span class="bp">self</span> <span class="p">)</span> <span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns **True** if *self* is a percent and **False** otherwise.</span>

<span class="sd">        :rtype: `bool`</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">style</span> <span class="o">==</span> <span class="n">PQU_uncertainty</span><span class="o">.</span><span class="n">pqu_uncertaintyStylePlusMinus</span> <span class="p">)</span> <span class="p">:</span> <span class="k">return</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">isPercent</span><span class="p">(</span> <span class="p">)</span> <span class="p">)</span>
        <span class="k">return</span><span class="p">(</span> <span class="kc">False</span> <span class="p">)</span></div>

<div class="viewcode-block" id="PQU_uncertainty.toString"><a class="viewcode-back" href="../../pqu/pqu.html#pqu.PQU.PQU_uncertainty.toString">[docs]</a>    <span class="k">def</span> <span class="nf">toString</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">prefix</span> <span class="o">=</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="n">significantDigits</span> <span class="o">=</span> <span class="kc">None</span> <span class="p">)</span> <span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a string representation of *self* (i.e., &#39;+/- 1.2%&#39;).</span>

<span class="sd">        :param str prefix: A prefix for the &#39;+/-&#39; style</span>
<span class="sd">        :param significantDigits: Passed onto method :py:meth:`PQU_float.toString`</span>
<span class="sd">        :rtype: `str`</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">style</span> <span class="o">==</span> <span class="n">PQU_uncertainty</span><span class="o">.</span><span class="n">pqu_uncertaintyStyleNone</span> <span class="p">)</span> <span class="p">:</span> <span class="k">return</span><span class="p">(</span> <span class="s1">&#39;&#39;</span> <span class="p">)</span>
        <span class="k">if</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">style</span> <span class="o">==</span> <span class="n">PQU_uncertainty</span><span class="o">.</span><span class="n">pqu_uncertaintyStylePlusMinus</span> <span class="p">)</span> <span class="p">:</span>
            <span class="n">favorEFormBy</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">if</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">order</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">getSignificantDigits</span><span class="p">(</span> <span class="p">)</span> <span class="o">==</span> <span class="mi">0</span> <span class="p">)</span> <span class="p">:</span> <span class="n">favorEFormBy</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="k">return</span><span class="p">(</span> <span class="s1">&#39;</span><span class="si">%s</span><span class="s1">+/- </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span> <span class="n">prefix</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">toString</span><span class="p">(</span> <span class="n">trimZeros</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">favorEFormBy</span> <span class="o">=</span> <span class="n">favorEFormBy</span><span class="p">,</span> <span class="n">significantDigits</span> <span class="o">=</span> <span class="n">significantDigits</span> <span class="p">)</span> <span class="p">)</span> <span class="p">)</span>
        <span class="k">return</span><span class="p">(</span> <span class="s1">&#39;(</span><span class="si">%d</span><span class="s1">)&#39;</span> <span class="o">%</span> <span class="nb">int</span><span class="p">(</span> <span class="nb">pow</span><span class="p">(</span> <span class="mf">10.</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">getSignificantDigits</span><span class="p">(</span> <span class="p">)</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">getOrder</span><span class="p">(</span> <span class="p">)</span> <span class="o">-</span> <span class="mi">1</span> <span class="p">)</span> <span class="o">*</span> <span class="nb">float</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="p">)</span> <span class="o">+</span> <span class="mf">1e-12</span> <span class="p">)</span> <span class="p">)</span></div>

<div class="viewcode-block" id="PQU_uncertainty.truncate"><a class="viewcode-back" href="../../pqu/pqu.html#pqu.PQU.PQU_uncertainty.truncate">[docs]</a>    <span class="k">def</span> <span class="nf">truncate</span><span class="p">(</span> <span class="bp">self</span> <span class="p">)</span> <span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Adjusts *self*&#39;s value so that only the significant digits are non-zero. This is most useful when a :py:class:`PQU` instance is</span>
<span class="sd">        calculated from other :py:class:`PQU` instance which can create an uncertainty with many non-zero digits. As example, adding two</span>
<span class="sd">        :py:class:`PQU`s with uncertainties 1.3 and 3.2 each with two significant digits, produces the uncertainty sqrt( 1.3**2 + 3.2**2 ) </span>
<span class="sd">        = 3.453983207834109. This uncertainty also only has two significant digits. After calling truncate the uncertainty</span>
<span class="sd">        become 3.5 which is the value that the method toString would return.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">truncate</span><span class="p">(</span> <span class="p">)</span></div></div>

<div class="viewcode-block" id="PQU"><a class="viewcode-back" href="../../pqu/pqu.html#pqu.PQU.PQU">[docs]</a><span class="k">class</span> <span class="nc">PQU</span> <span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This class supports a float value with an optional uncertainty and unit. Many basic math operations are supported </span>
<span class="sd">    (e.g., +, -, *, /).  A :py:class:`PQU` is anything that the staticmethod :py:meth:`Parsers.parsePQUString` can parse.</span>

<span class="sd">    In this section the following notations are used:</span>

<span class="sd">        +---------------------------+-----------------------------------------------------------------------------------+</span>
<span class="sd">        | Notation                  | Denote                                                                            |</span>
<span class="sd">        +===========================+===================================================================================+</span>
<span class="sd">        | pqu                       | The argument is a pqu instance.                                                   |</span>
<span class="sd">        +---------------------------+-----------------------------------------------------------------------------------+</span>
<span class="sd">        | [],                       | The argument is optional.                                                         |</span>
<span class="sd">        +---------------------------+-----------------------------------------------------------------------------------+</span>
<span class="sd">        | int                       | A python int (e.g., 23).                                                          |</span>
<span class="sd">        +---------------------------+-----------------------------------------------------------------------------------+</span>
<span class="sd">        | float                     | A python float (e.g., 1.23e-12).                                                  |</span>
<span class="sd">        +---------------------------+-----------------------------------------------------------------------------------+</span>
<span class="sd">        | number                    | Any of the following, int, float, :py:class:`PQU_float`, a string representing a  |</span>
<span class="sd">        |                           | float (i.e.,                                                                      |</span>
<span class="sd">        |                           | the python float function must be able to convert the string - e.g., &#39;12.3e3&#39; but |</span>
<span class="sd">        |                           | not &#39;12.3 eV&#39;) or any object having a __float__ method (hence, a numpy float      |</span>
<span class="sd">        |                           | will work).                                                                       |</span>
<span class="sd">        +---------------------------+-----------------------------------------------------------------------------------+</span>
<span class="sd">        | uncertainty = number_unc  | The uncertainty argument must be a valid number or a :py:class:`PQU_uncertainty`  | </span>
<span class="sd">        |                           | object. If number, uncertainty is of style &#39;+/-&#39;.                                 |</span>
<span class="sd">        +---------------------------+-----------------------------------------------------------------------------------+</span>
<span class="sd">        | unit = string_pu          | The unit argument must be a valid unit string (e.g., &quot;MeV&quot;, &quot;MeV/m&quot; but not       |</span>
<span class="sd">        |                           | &quot;1 MeV&quot;) or a :py:class:`PhysicalUnit` object.                                    |</span>
<span class="sd">        +---------------------------+-----------------------------------------------------------------------------------+</span>
<span class="sd">        | string                    | String can be anything that the method :py:meth:`Parsers.parsePQUString` is       |</span>
<span class="sd">        |                           | capable of parsing (e.g., &#39;1.23&#39;, &#39;1.23 m&#39;, &#39;1.23%&#39;, &#39;1.23(12) m&#39;,                |</span>
<span class="sd">        |                           | &#39;1.23 +/- 0.12m&#39;). If it contains a unit (uncertainty) then the unit              |</span>
<span class="sd">        |                           | (uncertainty) argument must be None.                                              |</span>
<span class="sd">        +---------------------------+-----------------------------------------------------------------------------------+</span>
<span class="sd">                </span>
<span class="sd">        Calling options are:</span>

<span class="sd">            - PQU( pqu )                                            # The new PQU gets all data from pqu. Unit and uncertainty arguments must be None.</span>
<span class="sd">            - PQU( number, [ unit = string_pu ], [ uncertainty = number_unc ] )</span>
<span class="sd">            - PQU( string )</span>
<span class="sd">            - PQU( string, unit = string_pu )                       # string must not contain a unit.</span>
<span class="sd">            - PQU( string, uncertainty = uncertainty )              # string must not contain an uncertainty.</span>
<span class="sd">            - PQU( string, unit = string_pu, uncertainty = number ) # string must not contain a unit or an uncertainty.</span>

<span class="sd">        For example, the following are allowed and are the same:</span>
<span class="sd">            - PQU( &quot;1.23&quot;, &quot;m&quot;, &quot;12%&quot; )</span>
<span class="sd">            - PQU( &quot;1.23 m&quot;, uncertainty = &quot;12%&quot; )</span>
<span class="sd">            - PQU( &quot;1.23 +/- 12%&quot;, &quot;m&quot; )</span>
<span class="sd">            - PQU( &quot;1.23 +/- 12%&quot;, &quot;m&quot;, None )    # Same as above as None is the default.</span>
<span class="sd">            - PQU( &quot;1.23+/-12% m&quot; )</span>

<span class="sd">        While the following are not allowed:</span>
<span class="sd">            - PQU( &quot;1.23+/-12% m&quot;, &quot;m&quot; )                    # Unit already given in value.</span>
<span class="sd">            - PQU( &quot;1.23+/-12% m&quot;, uncertainty = &quot;12%&quot; )    # Uncertainty already given in value.</span>
<span class="sd">            - PQU( &quot;1.23+/-12% m&quot;, &quot;m&quot;, &quot;12%&quot; )             # Unit and uncertainty already given in value.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">unit</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">uncertainty</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">checkOrder</span> <span class="o">=</span> <span class="kc">True</span> <span class="p">)</span> <span class="p">:</span>

        <span class="k">if</span><span class="p">(</span> <span class="nb">isinstance</span><span class="p">(</span> <span class="n">value</span><span class="p">,</span> <span class="n">PQU</span> <span class="p">)</span> <span class="p">)</span> <span class="p">:</span>
            <span class="k">if</span><span class="p">(</span> <span class="n">unit</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">)</span> <span class="p">:</span> <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span> <span class="s1">&#39;When value is a PQU instance, unit must be None not type &quot;</span><span class="si">%s</span><span class="s1">&quot;&#39;</span> <span class="o">%</span> <span class="nb">type</span><span class="p">(</span> <span class="n">unit</span> <span class="p">)</span> <span class="p">)</span>
            <span class="k">if</span><span class="p">(</span> <span class="n">uncertainty</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">)</span> <span class="p">:</span> <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span> <span class="s1">&#39;When value is a PQU instance, uncertainty must be None not type &quot;</span><span class="si">%s</span><span class="s1">&quot;&#39;</span> <span class="o">%</span> <span class="nb">type</span><span class="p">(</span> <span class="n">uncertainty</span> <span class="p">)</span> <span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">value</span>       <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span> <span class="n">value</span><span class="o">.</span><span class="n">value</span> <span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">unit</span>        <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span> <span class="n">value</span><span class="o">.</span><span class="n">unit</span> <span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">uncertainty</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span> <span class="n">value</span><span class="o">.</span><span class="n">uncertainty</span> <span class="p">)</span>
            <span class="k">return</span>

        <span class="k">if</span><span class="p">(</span> <span class="nb">isinstance</span><span class="p">(</span> <span class="n">uncertainty</span><span class="p">,</span> <span class="n">PQU_uncertainty</span> <span class="p">)</span> <span class="p">)</span> <span class="p">:</span> <span class="n">uncertainty</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span> <span class="n">uncertainty</span> <span class="p">)</span>
        <span class="k">if</span><span class="p">(</span> <span class="nb">isinstance</span><span class="p">(</span> <span class="n">unit</span><span class="p">,</span> <span class="n">PhysicalUnit</span> <span class="p">)</span> <span class="p">)</span> <span class="p">:</span> <span class="n">unit</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span> <span class="n">unit</span> <span class="p">)</span>

        <span class="k">if</span><span class="p">(</span> <span class="nb">isinstance</span><span class="p">(</span> <span class="n">value</span><span class="p">,</span> <span class="nb">str</span>  <span class="p">)</span> <span class="p">)</span> <span class="p">:</span>
            <span class="n">value</span><span class="p">,</span> <span class="n">unit_</span><span class="p">,</span> <span class="n">uncertainty_</span> <span class="o">=</span> <span class="n">Parsers</span><span class="o">.</span><span class="n">parsePQUString</span><span class="p">(</span> <span class="n">value</span> <span class="p">)</span>
            <span class="k">if</span><span class="p">(</span> <span class="n">uncertainty_</span><span class="o">.</span><span class="n">style</span> <span class="o">!=</span> <span class="n">PQU_uncertainty</span><span class="o">.</span><span class="n">pqu_uncertaintyStyleNone</span> <span class="p">)</span> <span class="p">:</span>
                <span class="k">if</span><span class="p">(</span> <span class="n">uncertainty</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">)</span> <span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span> <span class="s1">&#39;uncertainty argument = &quot;</span><span class="si">%s</span><span class="s1">&quot; must be None when value = &quot;</span><span class="si">%s</span><span class="s1">&quot; is string with uncertainty.&#39;</span> <span class="o">%</span> <span class="p">(</span> <span class="n">uncertainty</span><span class="p">,</span> <span class="n">value</span> <span class="p">)</span> <span class="p">)</span>
                <span class="n">uncertainty</span> <span class="o">=</span> <span class="n">uncertainty_</span>
            <span class="k">if</span><span class="p">(</span> <span class="ow">not</span><span class="p">(</span> <span class="n">unit_</span><span class="o">.</span><span class="n">isDimensionless</span><span class="p">(</span> <span class="p">)</span> <span class="p">)</span> <span class="p">)</span> <span class="p">:</span>
                <span class="k">if</span><span class="p">(</span> <span class="n">unit</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">)</span> <span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span> <span class="s1">&#39;unit argument = &quot;</span><span class="si">%s</span><span class="s1">&quot; must be None when value = &quot;</span><span class="si">%s</span><span class="s1">&quot; is string with unit.&#39;</span> <span class="o">%</span> <span class="p">(</span> <span class="n">unit</span><span class="p">,</span> <span class="n">value</span> <span class="p">)</span> <span class="p">)</span>
            <span class="k">if</span><span class="p">(</span> <span class="nb">len</span><span class="p">(</span> <span class="n">unit_</span><span class="o">.</span><span class="n">symbols</span> <span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">)</span> <span class="p">:</span> <span class="n">unit</span> <span class="o">=</span> <span class="n">unit_</span>
        <span class="k">else</span> <span class="p">:</span>
            <span class="k">if</span><span class="p">(</span> <span class="nb">isinstance</span><span class="p">(</span> <span class="n">value</span><span class="p">,</span> <span class="n">PQU_float</span> <span class="p">)</span> <span class="p">)</span> <span class="p">:</span>
                <span class="n">value</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span> <span class="n">value</span> <span class="p">)</span>
            <span class="k">else</span> <span class="p">:</span>
                <span class="k">try</span> <span class="p">:</span>
                    <span class="n">value</span> <span class="o">=</span> <span class="n">PQU_float</span><span class="p">(</span> <span class="n">value</span><span class="p">,</span> <span class="n">maxSignificantDigits</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">checkOrder</span> <span class="o">=</span> <span class="n">checkOrder</span> <span class="p">)</span>
                <span class="k">except</span> <span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span> <span class="s1">&#39;Cannot convert value = &quot;</span><span class="si">%s</span><span class="s1">&quot; to a float.&#39;</span> <span class="o">%</span> <span class="p">(</span> <span class="n">value</span><span class="p">,</span> <span class="p">)</span> <span class="p">)</span>

        <span class="k">if</span><span class="p">(</span> <span class="n">unit</span> <span class="ow">is</span> <span class="kc">None</span> <span class="p">)</span> <span class="p">:</span> <span class="n">unit</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="n">unit</span> <span class="o">=</span> <span class="n">_findUnit</span><span class="p">(</span> <span class="n">unit</span> <span class="p">)</span>           <span class="c1"># unit can be a PhysicalUnit instance or a string convertible to PhysicalUnit object.</span>

        <span class="k">if</span><span class="p">(</span> <span class="n">uncertainty</span> <span class="ow">is</span> <span class="kc">None</span> <span class="p">)</span> <span class="p">:</span>
            <span class="n">uncertainty</span> <span class="o">=</span> <span class="n">PQU_uncertainty</span><span class="p">(</span> <span class="n">PQU_uncertainty</span><span class="o">.</span><span class="n">pqu_uncertaintyStyleNone</span> <span class="p">)</span>
        <span class="k">else</span> <span class="p">:</span>
            <span class="k">if</span><span class="p">(</span> <span class="ow">not</span><span class="p">(</span> <span class="nb">isinstance</span><span class="p">(</span> <span class="n">uncertainty</span><span class="p">,</span> <span class="n">PQU_uncertainty</span> <span class="p">)</span> <span class="p">)</span> <span class="p">)</span> <span class="p">:</span>
                <span class="n">significantDigits</span><span class="p">,</span> <span class="n">isPercent</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="kc">False</span>
                <span class="n">uncertainty_</span> <span class="o">=</span> <span class="n">uncertainty</span>
                <span class="k">if</span><span class="p">(</span> <span class="nb">isinstance</span><span class="p">(</span> <span class="n">uncertainty</span><span class="p">,</span> <span class="nb">str</span> <span class="p">)</span> <span class="p">)</span> <span class="p">:</span>
                    <span class="n">uncertainty_</span><span class="p">,</span> <span class="n">significantDigitsForZero</span><span class="p">,</span> <span class="n">str2</span> <span class="o">=</span> <span class="n">Parsers</span><span class="o">.</span><span class="n">parseFloat</span><span class="p">(</span> <span class="n">uncertainty</span><span class="p">,</span> <span class="n">uncertainty</span> <span class="p">)</span>
                    <span class="k">if</span><span class="p">(</span> <span class="n">str2</span><span class="p">[:</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;%&#39;</span> <span class="p">)</span> <span class="p">:</span> <span class="n">isPercent</span><span class="p">,</span> <span class="n">str2</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">str2</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
                    <span class="k">if</span><span class="p">(</span> <span class="nb">len</span><span class="p">(</span> <span class="n">str2</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span> <span class="p">)</span> <span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">)</span> <span class="p">:</span> <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span> <span class="s1">&#39;Extra characters for uncertainty &quot;</span><span class="si">%s</span><span class="s1">&quot;&#39;</span> <span class="o">%</span> <span class="n">uncertainty</span> <span class="p">)</span>
                <span class="k">if</span><span class="p">(</span> <span class="nb">isinstance</span><span class="p">(</span> <span class="n">uncertainty</span><span class="p">,</span> <span class="n">PQU_float</span> <span class="p">)</span> <span class="p">)</span> <span class="p">:</span>
                    <span class="n">significantDigits</span><span class="p">,</span> <span class="n">isPercent</span> <span class="o">=</span> <span class="n">uncertainty_</span><span class="o">.</span><span class="n">getSignificantDigits</span><span class="p">(</span> <span class="p">),</span> <span class="n">uncertainty_</span><span class="o">.</span><span class="n">isPercent</span><span class="p">(</span> <span class="p">)</span>
                <span class="k">try</span> <span class="p">:</span>
                    <span class="n">uncertainty_</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span> <span class="n">uncertainty_</span> <span class="p">)</span>
                <span class="k">except</span> <span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span> <span class="s1">&#39;Invalid uncertainty = &quot;</span><span class="si">%s</span><span class="s1">&quot;&#39;</span> <span class="o">%</span> <span class="n">uncertainty</span> <span class="p">)</span>
                <span class="k">if</span><span class="p">(</span> <span class="n">uncertainty_</span> <span class="o">==</span> <span class="mf">0.</span> <span class="p">)</span> <span class="p">:</span>
                    <span class="n">uncertainty</span> <span class="o">=</span> <span class="n">PQU_uncertainty</span><span class="p">(</span> <span class="n">PQU_uncertainty</span><span class="o">.</span><span class="n">pqu_uncertaintyStyleNone</span> <span class="p">)</span>
                <span class="k">else</span> <span class="p">:</span>
                    <span class="n">uncertainty</span> <span class="o">=</span> <span class="n">PQU_uncertainty</span><span class="p">(</span> <span class="n">PQU_uncertainty</span><span class="o">.</span><span class="n">pqu_uncertaintyStylePlusMinus</span><span class="p">,</span> <span class="n">uncertainty_</span><span class="p">,</span> 
                        <span class="n">significantDigits</span> <span class="o">=</span> <span class="n">significantDigits</span><span class="p">,</span> <span class="n">isPercent</span> <span class="o">=</span> <span class="n">isPercent</span> <span class="p">)</span>
            <span class="k">if</span><span class="p">(</span> <span class="n">uncertainty</span><span class="o">.</span><span class="n">getStyle</span><span class="p">(</span> <span class="p">)</span> <span class="o">==</span> <span class="n">PQU_uncertainty</span><span class="o">.</span><span class="n">pqu_uncertaintyStylePlusMinus</span> <span class="p">)</span> <span class="p">:</span>
                <span class="n">uncertaintyLeastOrder</span> <span class="o">=</span> <span class="n">uncertainty</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">getOrder</span><span class="p">(</span> <span class="p">)</span> <span class="o">-</span> <span class="n">uncertainty</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">getSignificantDigits</span><span class="p">(</span> <span class="p">)</span>
                <span class="k">if</span><span class="p">(</span> <span class="n">uncertainty</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">isPercent</span><span class="p">(</span> <span class="p">)</span> <span class="p">)</span> <span class="p">:</span>
                    <span class="n">uncertainty_</span> <span class="o">=</span> <span class="n">uncertainty</span><span class="o">.</span><span class="n">value</span> <span class="o">*</span> <span class="nb">float</span><span class="p">(</span> <span class="n">value</span> <span class="p">)</span>
                    <span class="n">uncertaintyLeastOrder</span> <span class="o">=</span> <span class="n">uncertainty_</span><span class="o">.</span><span class="n">getOrder</span><span class="p">(</span> <span class="p">)</span> <span class="o">-</span> <span class="n">uncertainty_</span><span class="o">.</span><span class="n">getSignificantDigits</span><span class="p">(</span> <span class="p">)</span> <span class="c1"># As uncertainty_ is still %.</span>
                <span class="n">significantDigits</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">getOrder</span><span class="p">(</span> <span class="p">)</span> <span class="o">-</span> <span class="n">uncertaintyLeastOrder</span>
                <span class="n">value</span><span class="o">.</span><span class="n">setSignificantDigits</span><span class="p">(</span> <span class="n">significantDigits</span> <span class="p">)</span>
            <span class="k">elif</span><span class="p">(</span> <span class="n">uncertainty</span><span class="o">.</span><span class="n">getStyle</span><span class="p">(</span> <span class="p">)</span> <span class="o">==</span> <span class="n">PQU_uncertainty</span><span class="o">.</span><span class="n">pqu_uncertaintyStyleParenthesis</span> <span class="p">)</span> <span class="p">:</span>
                <span class="n">parenthesisPower</span> <span class="o">=</span> <span class="n">PQU_float</span><span class="o">.</span><span class="n">fixFloatsOrder</span><span class="p">(</span> <span class="nb">pow</span><span class="p">(</span> <span class="mf">10.</span><span class="p">,</span> <span class="n">value</span><span class="o">.</span><span class="n">order</span> <span class="o">-</span> <span class="n">value</span><span class="o">.</span><span class="n">significantDigits</span> <span class="o">+</span> <span class="mi">1</span> <span class="p">)</span> <span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">uncertainty</span> <span class="o">=</span> <span class="n">PQU_uncertainty</span><span class="p">(</span> <span class="n">PQU_uncertainty</span><span class="o">.</span><span class="n">pqu_uncertaintyStyleParenthesis</span><span class="p">,</span> 
                    <span class="n">uncertainty</span><span class="o">.</span><span class="n">value</span> <span class="o">*</span> <span class="n">parenthesisPower</span><span class="p">,</span> <span class="n">significantDigits</span> <span class="o">=</span> <span class="n">uncertainty</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">getSignificantDigits</span><span class="p">(</span> <span class="p">)</span> <span class="p">)</span>

        <span class="k">if</span><span class="p">(</span> <span class="n">value</span><span class="o">.</span><span class="n">isPercent</span><span class="p">(</span> <span class="p">)</span> <span class="p">)</span> <span class="p">:</span>
            <span class="k">if</span><span class="p">(</span> <span class="n">uncertainty</span><span class="o">.</span><span class="n">isPercent</span><span class="p">(</span> <span class="p">)</span> <span class="p">)</span> <span class="p">:</span> <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span> <span class="s1">&#39;Percent for both value and uncertainty is not allowed&#39;</span> <span class="p">)</span>
            <span class="k">if</span><span class="p">(</span> <span class="ow">not</span><span class="p">(</span> <span class="n">unit</span><span class="o">.</span><span class="n">isDimensionless</span><span class="p">(</span> <span class="p">)</span> <span class="p">)</span> <span class="p">)</span> <span class="p">:</span> <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span> <span class="s1">&#39;Percent value and unit is not allowed&#39;</span> <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">value</span>                  <span class="c1"># Private instance guaranteed by logic above.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">unit</span> <span class="o">=</span> <span class="n">unit</span>                    <span class="c1"># Private instance guaranteed by logic above.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">uncertainty</span> <span class="o">=</span> <span class="n">uncertainty</span>      <span class="c1"># Private instance guaranteed by logic above.</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span> <span class="bp">self</span> <span class="p">)</span> <span class="p">:</span>

        <span class="k">return</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">toString</span><span class="p">(</span> <span class="p">)</span> <span class="p">)</span>

    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span> <span class="bp">self</span> <span class="p">)</span> <span class="p">:</span>

        <span class="k">return</span><span class="p">(</span> <span class="s1">&#39;</span><span class="si">%s</span><span class="s1">( &quot;</span><span class="si">%s</span><span class="s1">&quot; )&#39;</span> <span class="o">%</span> <span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span> <span class="bp">self</span> <span class="p">)</span> <span class="p">)</span>

    <span class="k">def</span> <span class="fm">__hash__</span><span class="p">(</span> <span class="bp">self</span> <span class="p">)</span> <span class="p">:</span>

        <span class="k">return</span><span class="p">(</span> <span class="nb">hash</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="p">)</span> <span class="o">+</span> <span class="nb">hash</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">uncertainty</span> <span class="p">)</span> <span class="o">+</span> <span class="nb">hash</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">unit</span> <span class="p">)</span> <span class="p">)</span>

    <span class="k">def</span> <span class="fm">__abs__</span><span class="p">(</span> <span class="bp">self</span> <span class="p">)</span> <span class="p">:</span>

        <span class="k">return</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span> <span class="nb">abs</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">unit</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">uncertainty</span> <span class="p">)</span> <span class="p">)</span>

    <span class="k">def</span> <span class="fm">__neg__</span><span class="p">(</span> <span class="bp">self</span> <span class="p">)</span> <span class="p">:</span>

        <span class="k">return</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span> <span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">unit</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">uncertainty</span> <span class="p">)</span> <span class="p">)</span>

    <span class="k">def</span> <span class="fm">__add__</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">other</span> <span class="p">)</span> <span class="p">:</span>

        <span class="k">if</span><span class="p">(</span> <span class="bp">self</span> <span class="ow">is</span> <span class="n">other</span> <span class="p">)</span> <span class="p">:</span> <span class="k">return</span><span class="p">(</span> <span class="mi">2</span> <span class="o">*</span> <span class="bp">self</span> <span class="p">)</span>
        <span class="n">other</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_getOtherAsPQU</span><span class="p">(</span> <span class="n">other</span> <span class="p">)</span>
        <span class="n">factor</span><span class="p">,</span> <span class="n">offset</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">unit</span><span class="o">.</span><span class="n">conversionTupleTo</span><span class="p">(</span> <span class="bp">self</span> <span class="p">)</span>
        <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">+</span> <span class="p">(</span> <span class="n">other</span><span class="o">.</span><span class="n">value</span> <span class="o">+</span> <span class="n">offset</span> <span class="p">)</span> <span class="o">*</span> <span class="n">factor</span>
        <span class="n">uncertaintySelf</span><span class="p">,</span> <span class="n">uncertaintyOther</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getUncertaintyValueAs</span><span class="p">(</span> <span class="p">),</span> <span class="n">other</span><span class="o">.</span><span class="n">getUncertaintyValueAs</span><span class="p">(</span> <span class="p">)</span> <span class="o">*</span> <span class="n">factor</span>
        <span class="n">uncertainty</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span> <span class="n">uncertaintySelf</span> <span class="o">*</span> <span class="n">uncertaintySelf</span> <span class="o">+</span> <span class="n">uncertaintyOther</span> <span class="o">*</span> <span class="n">uncertaintyOther</span> <span class="p">)</span>
                <span class="c1"># Guess at style. If it should be pqu_uncertaintyStyleNone then uncertainty will be 0, which PQU_uncertainty will correct.</span>
        <span class="n">uncertainty</span> <span class="o">=</span> <span class="n">PQU_uncertainty</span><span class="p">(</span> <span class="n">PQU_uncertainty</span><span class="o">.</span><span class="n">pqu_uncertaintyStylePlusMinus</span><span class="p">,</span> <span class="n">uncertainty</span> <span class="p">)</span> 
        <span class="n">leastSignificantOrder</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">order</span> <span class="o">-</span> <span class="n">value</span><span class="o">.</span><span class="n">significantDigits</span>
        <span class="n">uncertainty</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">setSignificantDigits</span><span class="p">(</span> <span class="n">uncertainty</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">order</span> <span class="o">-</span> <span class="n">leastSignificantOrder</span> <span class="p">)</span>
        <span class="k">return</span><span class="p">(</span> <span class="n">PQU</span><span class="p">(</span> <span class="n">value</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">unit</span><span class="p">,</span> <span class="n">uncertainty</span> <span class="p">)</span> <span class="p">)</span>

    <span class="fm">__radd__</span> <span class="o">=</span> <span class="fm">__add__</span>

    <span class="k">def</span> <span class="fm">__iadd__</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">other</span> <span class="p">)</span> <span class="p">:</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_setFrom</span><span class="p">(</span> <span class="bp">self</span> <span class="o">+</span> <span class="n">other</span> <span class="p">)</span>
        <span class="k">return</span><span class="p">(</span> <span class="bp">self</span> <span class="p">)</span>

    <span class="k">def</span> <span class="fm">__sub__</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">other</span> <span class="p">)</span> <span class="p">:</span>

        <span class="k">if</span><span class="p">(</span> <span class="bp">self</span> <span class="ow">is</span> <span class="n">other</span> <span class="p">)</span> <span class="p">:</span> <span class="k">return</span><span class="p">(</span> <span class="n">PQU</span><span class="p">(</span> <span class="mf">0.</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">unit</span><span class="p">,</span> <span class="mf">0.</span> <span class="p">)</span> <span class="p">)</span>
        <span class="k">if</span><span class="p">(</span> <span class="nb">isinstance</span><span class="p">(</span> <span class="n">other</span><span class="p">,</span> <span class="nb">str</span> <span class="p">)</span> <span class="p">)</span> <span class="p">:</span> <span class="n">other</span> <span class="o">=</span> <span class="n">PQU</span><span class="p">(</span> <span class="n">other</span> <span class="p">)</span>
        <span class="k">return</span><span class="p">(</span> <span class="bp">self</span> <span class="o">+</span> <span class="o">-</span><span class="n">other</span> <span class="p">)</span>

    <span class="k">def</span> <span class="fm">__rsub__</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">other</span> <span class="p">)</span> <span class="p">:</span>

        <span class="k">if</span><span class="p">(</span> <span class="bp">self</span> <span class="ow">is</span> <span class="n">other</span> <span class="p">)</span> <span class="p">:</span> <span class="k">return</span><span class="p">(</span> <span class="n">PQU</span><span class="p">(</span> <span class="mf">0.</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">unit</span><span class="p">,</span> <span class="mf">0.</span> <span class="p">)</span> <span class="p">)</span>
        <span class="k">return</span><span class="p">(</span> <span class="n">other</span> <span class="o">+</span> <span class="o">-</span><span class="bp">self</span> <span class="p">)</span>

    <span class="k">def</span> <span class="fm">__isub__</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">other</span> <span class="p">)</span> <span class="p">:</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_setFrom</span><span class="p">(</span> <span class="bp">self</span> <span class="o">-</span> <span class="n">other</span> <span class="p">)</span>
        <span class="k">return</span><span class="p">(</span> <span class="bp">self</span> <span class="p">)</span>

    <span class="k">def</span> <span class="fm">__mul__</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">other</span> <span class="p">)</span> <span class="p">:</span>

        <span class="n">other</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_getOtherAsPQU</span><span class="p">(</span> <span class="n">other</span> <span class="p">)</span>

        <span class="n">selfValue</span><span class="p">,</span> <span class="n">otherValue</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span> <span class="bp">self</span> <span class="p">),</span> <span class="nb">float</span><span class="p">(</span> <span class="n">other</span> <span class="p">)</span>
        <span class="n">uncertaintySelf</span><span class="p">,</span> <span class="n">uncertaintyOther</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getUncertaintyValueAs</span><span class="p">(</span> <span class="p">),</span> <span class="n">other</span><span class="o">.</span><span class="n">getUncertaintyValueAs</span><span class="p">(</span> <span class="p">)</span>
        <span class="n">uncertaintySelf2</span><span class="p">,</span> <span class="n">uncertaintyOther2</span> <span class="o">=</span> <span class="n">uncertaintySelf</span> <span class="o">*</span> <span class="n">otherValue</span><span class="p">,</span> <span class="n">uncertaintyOther</span> <span class="o">*</span> <span class="n">selfValue</span>
        <span class="n">extraFactor</span> <span class="o">=</span> <span class="n">uncertaintySelf</span> <span class="o">*</span> <span class="n">uncertaintyOther</span>
        <span class="k">if</span><span class="p">(</span> <span class="p">(</span> <span class="bp">self</span> <span class="ow">is</span> <span class="n">other</span> <span class="p">)</span> <span class="ow">and</span> <span class="p">(</span> <span class="n">selfValue</span> <span class="o">!=</span> <span class="mi">0</span> <span class="p">)</span> <span class="p">)</span> <span class="p">:</span> <span class="n">extraFactor</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">selfValue</span> <span class="o">*</span> <span class="n">otherValue</span>
        <span class="n">uncertainty</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span> <span class="n">uncertaintySelf2</span> <span class="o">*</span> <span class="n">uncertaintySelf2</span> <span class="o">+</span> <span class="n">uncertaintyOther2</span> <span class="o">*</span> <span class="n">uncertaintyOther2</span> <span class="o">+</span> 
            <span class="n">extraFactor</span> <span class="o">*</span> <span class="n">uncertaintySelf</span> <span class="o">*</span> <span class="n">uncertaintyOther</span> <span class="p">)</span>
        <span class="n">significantDigits</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">uncertainty</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">getSignificantDigits</span><span class="p">(</span> <span class="p">),</span> <span class="n">other</span><span class="o">.</span><span class="n">uncertainty</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">getSignificantDigits</span><span class="p">(</span> <span class="p">)</span> <span class="p">)</span>
        <span class="n">uncertainty</span> <span class="o">=</span> <span class="n">PQU_uncertainty</span><span class="p">(</span> <span class="n">PQU_uncertainty</span><span class="o">.</span><span class="n">pqu_uncertaintyStylePlusMinus</span><span class="p">,</span> <span class="n">uncertainty</span><span class="p">,</span> <span class="n">significantDigits</span> <span class="p">)</span>

        <span class="k">return</span><span class="p">(</span> <span class="n">PQU</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">*</span> <span class="n">other</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">unit</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">unit</span> <span class="o">*</span> <span class="n">other</span><span class="o">.</span><span class="n">unit</span><span class="p">,</span> <span class="n">uncertainty</span> <span class="o">=</span> <span class="n">uncertainty</span> <span class="p">)</span> <span class="p">)</span>

    <span class="fm">__rmul__</span> <span class="o">=</span> <span class="fm">__mul__</span>

    <span class="k">def</span> <span class="fm">__imul__</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">other</span> <span class="p">)</span> <span class="p">:</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_setFrom</span><span class="p">(</span> <span class="bp">self</span> <span class="o">*</span> <span class="n">other</span> <span class="p">)</span>
        <span class="k">return</span><span class="p">(</span> <span class="bp">self</span> <span class="p">)</span>

    <span class="k">def</span> <span class="fm">__truediv__</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">other</span> <span class="p">)</span> <span class="p">:</span>

        <span class="k">if</span><span class="p">(</span> <span class="p">(</span> <span class="bp">self</span> <span class="ow">is</span> <span class="n">other</span> <span class="p">)</span> <span class="ow">and</span> <span class="p">(</span> <span class="nb">float</span><span class="p">(</span> <span class="bp">self</span> <span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span> <span class="p">)</span> <span class="p">)</span> <span class="p">:</span> <span class="k">return</span><span class="p">(</span> <span class="n">PQU</span><span class="p">(</span> <span class="mf">1.</span> <span class="p">)</span> <span class="p">)</span>
        <span class="n">other</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_getOtherAsPQU</span><span class="p">(</span> <span class="n">other</span> <span class="p">)</span>
        <span class="n">inv_other</span> <span class="o">=</span> <span class="mf">1.</span> <span class="o">/</span> <span class="nb">float</span><span class="p">(</span> <span class="n">other</span> <span class="p">)</span>
        <span class="k">return</span><span class="p">(</span> <span class="bp">self</span> <span class="o">*</span> <span class="n">PQU</span><span class="p">(</span> <span class="n">inv_other</span><span class="p">,</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">other</span><span class="o">.</span><span class="n">unit</span><span class="p">,</span> <span class="n">inv_other</span> <span class="o">*</span> <span class="n">inv_other</span> <span class="o">*</span> <span class="n">other</span><span class="o">.</span><span class="n">getUncertaintyValueAs</span><span class="p">(</span> <span class="p">)</span> <span class="p">)</span> <span class="p">)</span>

    <span class="k">def</span> <span class="fm">__rtruediv__</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">other</span> <span class="p">)</span> <span class="p">:</span>

        <span class="n">other</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_getOtherAsPQU</span><span class="p">(</span> <span class="n">other</span> <span class="p">)</span>
        <span class="k">return</span><span class="p">(</span> <span class="n">other</span> <span class="o">/</span> <span class="bp">self</span> <span class="p">)</span>

    <span class="k">def</span> <span class="fm">__itruediv__</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">other</span> <span class="p">)</span> <span class="p">:</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_setFrom</span><span class="p">(</span> <span class="bp">self</span> <span class="o">/</span> <span class="n">other</span> <span class="p">)</span>
        <span class="k">return</span><span class="p">(</span> <span class="bp">self</span> <span class="p">)</span>

    <span class="n">__div__</span> <span class="o">=</span> <span class="fm">__truediv__</span>   <span class="c1"># for Python 2.x</span>
    <span class="n">__rdiv__</span> <span class="o">=</span> <span class="fm">__rtruediv__</span>
    <span class="n">__idiv__</span> <span class="o">=</span> <span class="fm">__itruediv__</span>

    <span class="k">def</span> <span class="fm">__pow__</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">other</span> <span class="p">)</span> <span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Does not include uncertainty of other in calculation. Other must be an object convertible to a float. If it</span>
<span class="sd">        is a :py:class:`PQU` instance, it must be dimensionless.&quot;&quot;&quot;</span>

        <span class="n">other</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_getOtherAsPQU</span><span class="p">(</span> <span class="n">other</span> <span class="p">)</span>
        <span class="k">if</span><span class="p">(</span> <span class="ow">not</span><span class="p">(</span> <span class="n">other</span><span class="o">.</span><span class="n">isDimensionless</span><span class="p">(</span> <span class="p">)</span> <span class="p">)</span> <span class="p">)</span> <span class="p">:</span> <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span> <span class="s1">&#39;Power must be dimensionless. It has dimension &quot;</span><span class="si">%s</span><span class="s1">&quot;.&#39;</span> <span class="o">%</span> <span class="n">other</span><span class="o">.</span><span class="n">unit</span> <span class="p">)</span>
        <span class="n">power</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span> <span class="n">other</span> <span class="p">)</span>

        <span class="n">valueToPower</span> <span class="o">=</span> <span class="nb">pow</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">power</span> <span class="p">)</span>
        <span class="n">value</span><span class="p">,</span> <span class="n">uncertainty</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span> <span class="bp">self</span> <span class="p">),</span> <span class="kc">None</span>

        <span class="k">if</span><span class="p">(</span> <span class="n">value</span> <span class="o">!=</span> <span class="mi">0</span> <span class="p">)</span> <span class="p">:</span>  <span class="c1"># This is not the correct answer when value is small compared to uncertainty. Needs work?</span>
            <span class="n">uncertainty</span> <span class="o">=</span> <span class="p">(</span> <span class="n">power</span> <span class="o">*</span> <span class="nb">float</span><span class="p">(</span> <span class="n">valueToPower</span> <span class="p">)</span> <span class="o">/</span> <span class="n">value</span> <span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">uncertainty</span>
            <span class="k">if</span><span class="p">(</span> <span class="n">uncertainty</span><span class="o">.</span><span class="n">getStyle</span><span class="p">(</span> <span class="p">)</span> <span class="o">==</span> <span class="n">PQU_uncertainty</span><span class="o">.</span><span class="n">pqu_uncertaintyStyleParenthesis</span> <span class="p">)</span> <span class="p">:</span> 
                <span class="n">uncertainty</span><span class="o">.</span><span class="n">style</span> <span class="o">=</span> <span class="n">PQU_uncertainty</span><span class="o">.</span><span class="n">pqu_uncertaintyStylePlusMinus</span>
        <span class="n">valueToPower</span> <span class="o">=</span> <span class="n">PQU_float</span><span class="p">(</span> <span class="n">valueToPower</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">getSignificantDigits</span><span class="p">(</span> <span class="p">)</span> <span class="p">)</span>
        <span class="k">return</span><span class="p">(</span> <span class="n">PQU</span><span class="p">(</span> <span class="n">valueToPower</span><span class="p">,</span> <span class="n">unit</span> <span class="o">=</span> <span class="nb">pow</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">unit</span><span class="p">,</span> <span class="n">power</span> <span class="p">),</span> <span class="n">uncertainty</span> <span class="o">=</span> <span class="n">uncertainty</span> <span class="p">)</span> <span class="p">)</span>

    <span class="k">def</span> <span class="fm">__float__</span><span class="p">(</span> <span class="bp">self</span> <span class="p">)</span> <span class="p">:</span>

        <span class="k">return</span><span class="p">(</span> <span class="nb">float</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="p">)</span> <span class="p">)</span>

    <span class="k">def</span> <span class="fm">__bool__</span><span class="p">(</span> <span class="bp">self</span> <span class="p">)</span> <span class="p">:</span>

        <span class="k">return</span><span class="p">(</span> <span class="nb">bool</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="p">)</span> <span class="p">)</span>

    <span class="n">__nonzero__</span> <span class="o">=</span> <span class="fm">__bool__</span>      <span class="c1"># for python 2.x</span>

    <span class="k">def</span> <span class="fm">__eq__</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">other</span> <span class="p">)</span> <span class="p">:</span>

        <span class="k">return</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">compare</span><span class="p">(</span> <span class="n">other</span><span class="p">,</span> <span class="mi">5</span> <span class="p">)</span> <span class="o">==</span> <span class="mi">0</span> <span class="p">)</span>

    <span class="k">def</span> <span class="fm">__ne__</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">other</span> <span class="p">)</span> <span class="p">:</span>

        <span class="k">return</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">compare</span><span class="p">(</span> <span class="n">other</span><span class="p">,</span> <span class="mi">5</span> <span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span> <span class="p">)</span>

    <span class="k">def</span> <span class="fm">__lt__</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">other</span> <span class="p">)</span> <span class="p">:</span>

        <span class="k">return</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">compare</span><span class="p">(</span> <span class="n">other</span><span class="p">,</span> <span class="mi">5</span> <span class="p">)</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="p">)</span>

    <span class="k">def</span> <span class="fm">__le__</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">other</span> <span class="p">)</span> <span class="p">:</span>

        <span class="k">return</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">compare</span><span class="p">(</span> <span class="n">other</span><span class="p">,</span> <span class="mi">5</span> <span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">0</span> <span class="p">)</span>

    <span class="k">def</span> <span class="fm">__gt__</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">other</span> <span class="p">)</span> <span class="p">:</span>

        <span class="k">return</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">compare</span><span class="p">(</span> <span class="n">other</span><span class="p">,</span> <span class="mi">5</span> <span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">)</span>

    <span class="k">def</span> <span class="fm">__ge__</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">other</span> <span class="p">)</span> <span class="p">:</span>

        <span class="k">return</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">compare</span><span class="p">(</span> <span class="n">other</span><span class="p">,</span> <span class="mi">5</span> <span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">0</span> <span class="p">)</span>

    <span class="k">def</span> <span class="nf">_setFrom</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">other</span> <span class="p">)</span> <span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Sets *self*&#39;s members from other. Other must be an instance of :py:class:`PQU`.</span>

<span class="sd">        :param other: The :py:class:`PQU` instance whose members are copied to *self*</span>
<span class="sd">        :type other: a :py:class:`PQU` instance</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span><span class="p">(</span> <span class="ow">not</span><span class="p">(</span> <span class="nb">isinstance</span><span class="p">(</span> <span class="n">other</span><span class="p">,</span> <span class="n">PQU</span> <span class="p">)</span> <span class="p">)</span> <span class="p">)</span> <span class="p">:</span> <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span> <span class="s2">&quot;other type </span><span class="si">%s</span><span class="s2"> not supported&quot;</span> <span class="o">%</span> <span class="nb">type</span><span class="p">(</span> <span class="n">other</span> <span class="p">)</span> <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">unit</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">unit</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">uncertainty</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">uncertainty</span><span class="p">)</span>

<div class="viewcode-block" id="PQU.changeUncertaintyStyle"><a class="viewcode-back" href="../../pqu/pqu.html#pqu.PQU.PQU.changeUncertaintyStyle">[docs]</a>    <span class="k">def</span> <span class="nf">changeUncertaintyStyle</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">style</span> <span class="p">)</span> <span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Changes *self*.uncertainty&#39;s style. If style is the same as *self*.uncertainty&#39;s style nothing is done. If style</span>
<span class="sd">        or *self*.uncertainty&#39;s style is PQU_uncertainty.pqu_uncertaintyStyleNone as raise is executed.</span>

<span class="sd">        :param style: One of the three PQU_uncertainty styles</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">uncertainty</span><span class="o">.</span><span class="n">_okayToChangeUncertaintyStyleTo</span><span class="p">(</span> <span class="n">style</span><span class="p">,</span> <span class="n">checkPercent</span> <span class="o">=</span> <span class="kc">False</span> <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">uncertainty</span><span class="o">.</span><span class="n">_changeUncertaintyStyle</span><span class="p">(</span> <span class="n">style</span> <span class="p">)</span></div>

<div class="viewcode-block" id="PQU.changeUncertaintyPercent"><a class="viewcode-back" href="../../pqu/pqu.html#pqu.PQU.PQU.changeUncertaintyPercent">[docs]</a>    <span class="k">def</span> <span class="nf">changeUncertaintyPercent</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">toPercent</span> <span class="p">)</span> <span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        If *self*&#39;s style is not pqu_uncertaintyStylePlusMinus a raise is executed. Otherwise, if toPercent</span>
<span class="sd">        is **True** (**False**) *self*&#39;s uncertainty will be converted to a percent (non-percent) if not already a percent</span>
<span class="sd">        (non-percent).</span>

<span class="sd">        :param toPercent: Specifies whether *self*&#39;s uncertainty should be percent or not</span>
<span class="sd">        :type toPercent: `bool`</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">style</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">uncertainty</span><span class="o">.</span><span class="n">getStyle</span><span class="p">(</span> <span class="p">)</span>
        <span class="k">if</span><span class="p">(</span> <span class="n">style</span> <span class="o">!=</span> <span class="n">PQU_uncertainty</span><span class="o">.</span><span class="n">pqu_uncertaintyStylePlusMinus</span> <span class="p">)</span> <span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span> <span class="s1">&#39;Can only change pqu_uncertaintyStylePlusMinus style to percent and not </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">style</span> <span class="p">)</span>
        <span class="n">toPercent</span> <span class="o">=</span> <span class="nb">bool</span><span class="p">(</span> <span class="n">toPercent</span> <span class="p">)</span>
        <span class="k">if</span><span class="p">(</span> <span class="n">toPercent</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">uncertainty</span><span class="o">.</span><span class="n">isPercent</span><span class="p">(</span> <span class="p">)</span> <span class="p">)</span> <span class="p">:</span>
            <span class="k">if</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">isPercent</span><span class="p">(</span> <span class="p">)</span> <span class="p">)</span> <span class="p">:</span> <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span> <span class="s1">&#39;Uncertainty cannot be percent when value is a percent&#39;</span> <span class="p">)</span>
            <span class="k">if</span><span class="p">(</span> <span class="n">toPercent</span> <span class="p">)</span> <span class="p">:</span>
                <span class="n">value</span> <span class="o">=</span> <span class="mi">100</span> <span class="o">*</span> <span class="nb">float</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">uncertainty</span> <span class="p">)</span> <span class="o">/</span> <span class="nb">float</span><span class="p">(</span> <span class="bp">self</span> <span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">uncertainty</span> <span class="o">=</span> <span class="n">PQU_uncertainty</span><span class="p">(</span> <span class="n">style</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> 
                    <span class="bp">self</span><span class="o">.</span><span class="n">uncertainty</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">getSignificantDigits</span><span class="p">(</span> <span class="p">),</span> <span class="n">isPercent</span> <span class="o">=</span> <span class="kc">True</span> <span class="p">)</span>
            <span class="k">else</span> <span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">uncertainty</span> <span class="o">=</span> <span class="n">PQU_uncertainty</span><span class="p">(</span> <span class="n">style</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">getUncertaintyValueAs</span><span class="p">(</span> <span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">uncertainty</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">getSignificantDigits</span><span class="p">(</span> <span class="p">)</span> <span class="p">)</span></div>

<div class="viewcode-block" id="PQU.compare"><a class="viewcode-back" href="../../pqu/pqu.html#pqu.PQU.PQU.compare">[docs]</a>    <span class="k">def</span> <span class="nf">compare</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">,</span> <span class="n">epsilonFactor</span> <span class="o">=</span> <span class="mi">0</span> <span class="p">)</span> <span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Compares *self*&#39;s value and unit to other&#39;s value and unit (other&#39;s value is first converted to unit of *self*) </span>
<span class="sd">        using the :py:func:`compare` function.</span>

<span class="sd">        Also see method :py:meth:`PQU.equivalent`.</span>

<span class="sd">        :param other: The :py:class:`PQU` instance to compare to *self*</span>
<span class="sd">        :type other: A :py:class:`PQU` equivalent instance</span>

<span class="sd">        :param epsilonFactor: See the :py:func:`compare` function</span>

<span class="sd">        :returns: See the :py:func:`compare` function</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">other</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_getOtherAsPQU</span><span class="p">(</span> <span class="n">other</span> <span class="p">)</span>
        <span class="n">valueOfOther</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">getValueAs</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">unit</span> <span class="p">)</span>
        <span class="k">return</span><span class="p">(</span> <span class="n">compare</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">valueOfOther</span><span class="p">,</span> <span class="n">epsilonFactor</span> <span class="o">=</span> <span class="n">epsilonFactor</span> <span class="p">)</span> <span class="p">)</span></div>

<div class="viewcode-block" id="PQU.convertToUnit"><a class="viewcode-back" href="../../pqu/pqu.html#pqu.PQU.PQU.convertToUnit">[docs]</a>    <span class="k">def</span> <span class="nf">convertToUnit</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">unit</span> <span class="p">)</span> <span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Changes *self*&#39;s unit to unit and adjusts the value such that the new value/unit is equivalent to</span>
<span class="sd">        the original value/unit. The new unit must be compatible with the original unit of *self*.</span>

<span class="sd">        :param str unit: a unit equivalent</span>
<span class="sd">        :raises TypeError: if the unit string is not a known unit or is a unit incompatible with *self*&#39;s unit</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span><span class="p">(</span> <span class="nb">isinstance</span><span class="p">(</span> <span class="n">unit</span><span class="p">,</span> <span class="n">PQU</span> <span class="p">)</span> <span class="p">)</span> <span class="p">:</span> <span class="n">unit</span> <span class="o">=</span> <span class="n">unit</span><span class="o">.</span><span class="n">unit</span>
        <span class="n">factor</span><span class="p">,</span> <span class="n">offset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">unit</span><span class="o">.</span><span class="n">conversionTupleTo</span><span class="p">(</span> <span class="n">unit</span> <span class="p">)</span>
        <span class="n">unit</span> <span class="o">=</span> <span class="n">_findUnit</span><span class="p">(</span> <span class="n">unit</span> <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">+</span> <span class="n">offset</span> <span class="p">)</span> <span class="o">*</span> <span class="n">factor</span>
        <span class="k">if</span><span class="p">(</span> <span class="ow">not</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">uncertainty</span><span class="o">.</span><span class="n">isPercent</span><span class="p">(</span> <span class="p">)</span> <span class="p">)</span> <span class="p">)</span> <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">uncertainty</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">uncertainty</span> <span class="o">*</span> <span class="n">factor</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">unit</span> <span class="o">=</span> <span class="n">unit</span>
        <span class="k">return</span><span class="p">(</span> <span class="bp">self</span> <span class="p">)</span></div>

<div class="viewcode-block" id="PQU.copyToUnit"><a class="viewcode-back" href="../../pqu/pqu.html#pqu.PQU.PQU.copyToUnit">[docs]</a>    <span class="k">def</span> <span class="nf">copyToUnit</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">unit</span> <span class="p">)</span> <span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Like convertToUnit except a copy is made and returned. The copy unit is changed to unit. Self is left unchanged.</span>

<span class="sd">        :param str unit: a unit equivalent</span>
<span class="sd">        :rtype: :py:class:`PQU`</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span><span class="p">(</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">convertToUnit</span><span class="p">(</span> <span class="n">unit</span> <span class="p">)</span> <span class="p">)</span></div>

<div class="viewcode-block" id="PQU.equivalent"><a class="viewcode-back" href="../../pqu/pqu.html#pqu.PQU.PQU.equivalent">[docs]</a>    <span class="k">def</span> <span class="nf">equivalent</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">,</span> <span class="n">factor</span> <span class="o">=</span> <span class="mf">1.</span> <span class="p">)</span> <span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This method compares *self* to other and returns **True** if they are equivalent and **False** otherwise. The</span>
<span class="sd">        two are considered equivalent if their bands overlap. The band for *self* (or other) is all</span>
<span class="sd">        values within &#39;factor times uncertainty&#39; of its value. That is, the band for *self* is the ranges from</span>
<span class="sd">        &#39;value - factor * uncertainty&#39; to &#39;value + factor * uncertainty&#39;.</span>

<span class="sd">        Note, this is different than the :py:meth:`compare` method which compares the values using sys.float_info.epsilon</span>
<span class="sd">        to calculate a &#39;band&#39; and not their uncertainties.</span>

<span class="sd">        :param other: The object to compare to *self*</span>
<span class="sd">        :type other: a :py:class:`PQU` equivalent</span>
<span class="sd">        :param factor: the 1/2 width in standard deviations of the band</span>
<span class="sd">        :type factor: `float`</span>
<span class="sd">        :returns: 1 if *self* is deemed greater than other, 0 if equal and -1 otherwise</span>
<span class="sd">        &quot;&quot;&quot;</span>
<span class="c1"># BRB. Should this be named equivalent or consistent.</span>

        <span class="n">factor</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span> <span class="n">factor</span> <span class="p">)</span>
        <span class="n">other</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_getOtherAsPQU</span><span class="p">(</span> <span class="n">other</span> <span class="p">)</span>
        <span class="n">other2</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">copyToUnit</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">unit</span> <span class="p">)</span>
        <span class="n">selfValue</span><span class="p">,</span> <span class="n">selfUncFactor</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span> <span class="bp">self</span> <span class="p">),</span> <span class="n">factor</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">getUncertaintyValueAs</span><span class="p">(</span> <span class="p">)</span>
        <span class="n">otherValue</span><span class="p">,</span> <span class="n">otherUncFactor</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span> <span class="n">other2</span> <span class="p">),</span> <span class="n">factor</span> <span class="o">*</span> <span class="n">other2</span><span class="o">.</span><span class="n">getUncertaintyValueAs</span><span class="p">(</span> <span class="p">)</span>

        <span class="k">if</span><span class="p">(</span> <span class="p">(</span> <span class="n">selfValue</span> <span class="o">+</span> <span class="n">selfUncFactor</span> <span class="p">)</span> <span class="o">&lt;</span> <span class="p">(</span> <span class="n">otherValue</span> <span class="o">-</span> <span class="n">otherUncFactor</span> <span class="p">)</span> <span class="p">)</span> <span class="p">:</span> <span class="k">return</span><span class="p">(</span> <span class="kc">False</span> <span class="p">)</span>
        <span class="k">if</span><span class="p">(</span> <span class="p">(</span> <span class="n">selfValue</span> <span class="o">-</span> <span class="n">selfUncFactor</span> <span class="p">)</span> <span class="o">&gt;</span> <span class="p">(</span> <span class="n">otherValue</span> <span class="o">+</span> <span class="n">otherUncFactor</span> <span class="p">)</span> <span class="p">)</span> <span class="p">:</span> <span class="k">return</span><span class="p">(</span> <span class="kc">False</span> <span class="p">)</span>
        <span class="k">return</span><span class="p">(</span> <span class="kc">True</span> <span class="p">)</span></div>

<div class="viewcode-block" id="PQU.inUnitsOf"><a class="viewcode-back" href="../../pqu/pqu.html#pqu.PQU.PQU.inUnitsOf">[docs]</a>    <span class="k">def</span> <span class="nf">inUnitsOf</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">units</span> <span class="p">)</span> <span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Express the quantity in different units. If one unit is specified, a new</span>
<span class="sd">        :py:class:`PQU` object is returned that expresses the quantity</span>
<span class="sd">        in that unit. If several units are specified, the return value is a tuple of</span>
<span class="sd">        PhysicalObject instances with one element per unit such that the sum of all</span>
<span class="sd">        quantities in the tuple equals the the original quantity and all the values</span>
<span class="sd">        except for the last one are integers. This is used to convert to irregular unit</span>
<span class="sd">        systems like hour/minute/second.</span>

<span class="sd">        :param units: one or several units</span>
<span class="sd">        :type units: `str` or sequence of `str`</span>
<span class="sd">        :returns: one or more physical quantities</span>
<span class="sd">        :rtype: `PQU` or `tuple` of `PQU`</span>
<span class="sd">        :raises TypeError: if any of the specified units are not compatible with the original unit</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">units</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span> <span class="nb">map</span><span class="p">(</span> <span class="n">_findUnit</span><span class="p">,</span> <span class="n">units</span> <span class="p">)</span> <span class="p">)</span>

        <span class="k">if</span><span class="p">(</span> <span class="nb">len</span><span class="p">(</span> <span class="n">units</span> <span class="p">)</span> <span class="o">==</span> <span class="mi">1</span> <span class="p">)</span> <span class="p">:</span>
            <span class="n">elf</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">unit</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">uncertainty</span> <span class="p">)</span>
            <span class="n">elf</span><span class="o">.</span><span class="n">convertToUnit</span><span class="p">(</span> <span class="n">units</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="p">)</span>
            <span class="k">return</span><span class="p">(</span> <span class="n">elf</span> <span class="p">)</span>
        <span class="k">else</span> <span class="p">:</span>
            <span class="n">units</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span> <span class="n">reverse</span> <span class="o">=</span> <span class="kc">True</span> <span class="p">)</span>
            <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span>
            <span class="n">baseUnit</span> <span class="o">=</span> <span class="n">units</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">base</span> <span class="o">=</span> <span class="n">value</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">unit</span><span class="o">.</span><span class="n">conversionFactorTo</span><span class="p">(</span> <span class="n">baseUnit</span> <span class="p">)</span>
            <span class="k">for</span> <span class="n">subunit</span> <span class="ow">in</span> <span class="n">units</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="p">:</span>
                <span class="n">value</span> <span class="o">=</span> <span class="n">base</span> <span class="o">*</span> <span class="n">baseUnit</span><span class="o">.</span><span class="n">conversionFactorTo</span><span class="p">(</span> <span class="n">subunit</span> <span class="p">)</span>
                <span class="n">rounded</span> <span class="o">=</span> <span class="n">_round</span><span class="p">(</span> <span class="n">value</span> <span class="p">)</span>
                <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span> <span class="n">rounded</span><span class="p">,</span> <span class="n">subunit</span> <span class="p">)</span> <span class="p">)</span>
                <span class="n">base</span> <span class="o">=</span> <span class="n">base</span> <span class="o">-</span> <span class="n">rounded</span> <span class="o">*</span> <span class="n">subunit</span><span class="o">.</span><span class="n">conversionFactorTo</span><span class="p">(</span> <span class="n">baseUnit</span> <span class="p">)</span>
            <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span> <span class="n">base</span><span class="p">,</span> <span class="n">units</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="p">)</span> <span class="p">)</span>

            <span class="k">return</span><span class="p">(</span> <span class="nb">tuple</span><span class="p">(</span> <span class="n">result</span> <span class="p">)</span> <span class="p">)</span></div>

<div class="viewcode-block" id="PQU.getSignificantDigits"><a class="viewcode-back" href="../../pqu/pqu.html#pqu.PQU.PQU.getSignificantDigits">[docs]</a>    <span class="k">def</span> <span class="nf">getSignificantDigits</span><span class="p">(</span> <span class="bp">self</span> <span class="p">)</span> <span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the number of significant digits for self&#39;s value.</span>

<span class="sd">        :rtype: `int`</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">getSignificantDigits</span><span class="p">(</span> <span class="p">)</span> <span class="p">)</span></div>

<div class="viewcode-block" id="PQU.getUnitAsString"><a class="viewcode-back" href="../../pqu/pqu.html#pqu.PQU.PQU.getUnitAsString">[docs]</a>    <span class="k">def</span> <span class="nf">getUnitAsString</span><span class="p">(</span> <span class="bp">self</span> <span class="p">)</span> <span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a string representation of self&#39;s unit.</span>

<span class="sd">        :rtype: `str`</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">unit</span><span class="o">.</span><span class="n">symbol</span><span class="p">(</span> <span class="p">)</span> <span class="p">)</span></div>

    <span class="n">getUnitSymbol</span> <span class="o">=</span> <span class="n">getUnitAsString</span>         <span class="c1"># To be deprecated.</span>

<div class="viewcode-block" id="PQU.getValueAs"><a class="viewcode-back" href="../../pqu/pqu.html#pqu.PQU.PQU.getValueAs">[docs]</a>    <span class="k">def</span> <span class="nf">getValueAs</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">unit</span><span class="p">,</span> <span class="n">asPQU</span> <span class="o">=</span> <span class="kc">False</span> <span class="p">)</span> <span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns *self*&#39;s value in units of unit. Unit must be compatible with *self*&#39;s unit.</span>

<span class="sd">        :param unit: The unit to return *self*&#39;s value in</span>
<span class="sd">        :rtype: `float`</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">unit</span> <span class="o">=</span> <span class="n">_findUnit</span><span class="p">(</span> <span class="n">unit</span> <span class="p">)</span>
        <span class="n">factor</span><span class="p">,</span> <span class="n">offset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">unit</span><span class="o">.</span><span class="n">conversionTupleTo</span><span class="p">(</span> <span class="n">unit</span> <span class="p">)</span>
        <span class="n">value</span> <span class="o">=</span> <span class="p">(</span> <span class="nb">float</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="p">)</span> <span class="o">+</span> <span class="n">offset</span> <span class="p">)</span> <span class="o">*</span> <span class="n">factor</span>
        <span class="k">if</span><span class="p">(</span> <span class="n">asPQU</span> <span class="p">)</span> <span class="p">:</span> <span class="k">return</span><span class="p">(</span> <span class="n">PQU</span><span class="p">(</span> <span class="n">value</span><span class="p">,</span> <span class="n">unit</span> <span class="p">)</span> <span class="p">)</span>
        <span class="k">return</span><span class="p">(</span> <span class="n">value</span> <span class="p">)</span></div>

<div class="viewcode-block" id="PQU.getUncertaintyValueAs"><a class="viewcode-back" href="../../pqu/pqu.html#pqu.PQU.PQU.getUncertaintyValueAs">[docs]</a>    <span class="k">def</span> <span class="nf">getUncertaintyValueAs</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">unit</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">asPQU</span> <span class="o">=</span> <span class="kc">False</span> <span class="p">)</span> <span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a python float representing *self*&#39;s uncertainty value. If the uncertainty is a percent, the returned</span>
<span class="sd">        float is *self*&#39;s value times *self*&#39;s uncertainty value.</span>

<span class="sd">        :rtype: `float`</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">value</span> <span class="o">=</span> <span class="n">PQU</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">uncertainty</span><span class="o">.</span><span class="n">getProperValue</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">unit</span> <span class="p">)</span>
        <span class="k">if</span><span class="p">(</span> <span class="n">unit</span> <span class="ow">is</span> <span class="kc">None</span> <span class="p">)</span> <span class="p">:</span> <span class="n">unit</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">unit</span>
        <span class="k">return</span><span class="p">(</span> <span class="n">value</span><span class="o">.</span><span class="n">getValueAs</span><span class="p">(</span> <span class="n">unit</span><span class="p">,</span> <span class="n">asPQU</span> <span class="o">=</span> <span class="n">asPQU</span> <span class="p">)</span> <span class="p">)</span></div>

<div class="viewcode-block" id="PQU.getValue"><a class="viewcode-back" href="../../pqu/pqu.html#pqu.PQU.PQU.getValue">[docs]</a>    <span class="k">def</span> <span class="nf">getValue</span><span class="p">(</span> <span class="bp">self</span> <span class="p">)</span> <span class="p">:</span>      <span class="c1"># To be deprecated - replaced by __float__</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns a python float representing *self*&#39;s value. This is equivalent to &#39;float( self )&#39;.&quot;&quot;&quot;</span>

        <span class="k">return</span><span class="p">(</span> <span class="nb">float</span><span class="p">(</span> <span class="bp">self</span> <span class="p">)</span> <span class="p">)</span></div>

<div class="viewcode-block" id="PQU.inBaseUnits"><a class="viewcode-back" href="../../pqu/pqu.html#pqu.PQU.PQU.inBaseUnits">[docs]</a>    <span class="k">def</span> <span class="nf">inBaseUnits</span><span class="p">(</span> <span class="bp">self</span> <span class="p">)</span> <span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        :returns: A copy of *self* converted to base units, i.e. SI units in most cases</span>
<span class="sd">        :rtype: :py:class:`PQU`</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">value</span> <span class="o">=</span> <span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">unit</span><span class="o">.</span><span class="n">offset</span> <span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">unit</span><span class="o">.</span><span class="n">factor</span>
        <span class="n">uncertainty</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">uncertainty</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">unit</span><span class="o">.</span><span class="n">factor</span>

        <span class="n">num</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="n">denom</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="k">for</span> <span class="n">i1</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span> <span class="nb">len</span><span class="p">(</span> <span class="n">_base_symbols</span> <span class="p">)</span> <span class="p">)</span> <span class="p">:</span>
            <span class="n">unit</span> <span class="o">=</span> <span class="n">_base_symbols</span><span class="p">[</span><span class="n">i1</span><span class="p">]</span>
            <span class="n">power</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">unit</span><span class="o">.</span><span class="n">powers</span><span class="p">[</span><span class="n">i1</span><span class="p">]</span>

            <span class="k">if</span><span class="p">(</span> <span class="n">power</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="p">)</span> <span class="p">:</span>
                <span class="n">denom</span> <span class="o">=</span> <span class="n">denom</span> <span class="o">+</span> <span class="s1">&#39;/&#39;</span> <span class="o">+</span> <span class="n">unit</span>
                <span class="k">if</span><span class="p">(</span> <span class="n">power</span> <span class="o">&lt;</span> <span class="o">-</span><span class="mi">1</span> <span class="p">)</span> <span class="p">:</span> <span class="n">denom</span> <span class="o">=</span> <span class="n">denom</span> <span class="o">+</span> <span class="s1">&#39;**&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span> <span class="o">-</span><span class="n">power</span> <span class="p">)</span>
            <span class="k">elif</span><span class="p">(</span> <span class="n">power</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">)</span> <span class="p">:</span>
                <span class="n">num</span> <span class="o">=</span> <span class="n">num</span> <span class="o">+</span> <span class="s1">&#39;*&#39;</span> <span class="o">+</span> <span class="n">unit</span>
                <span class="k">if</span><span class="p">(</span> <span class="n">power</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="p">)</span> <span class="p">:</span> <span class="n">num</span> <span class="o">=</span> <span class="n">num</span> <span class="o">+</span> <span class="s1">&#39;**&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span> <span class="n">power</span> <span class="p">)</span>
        <span class="k">if</span><span class="p">(</span> <span class="nb">len</span><span class="p">(</span> <span class="n">num</span> <span class="p">)</span> <span class="o">==</span> <span class="mi">0</span> <span class="p">)</span> <span class="p">:</span>
            <span class="n">num</span> <span class="o">=</span> <span class="s1">&#39;1&#39;</span>
            <span class="k">if</span><span class="p">(</span> <span class="nb">len</span><span class="p">(</span> <span class="n">denom</span> <span class="p">)</span> <span class="o">==</span> <span class="mi">0</span> <span class="p">)</span> <span class="p">:</span> <span class="n">num</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">num</span> <span class="o">=</span> <span class="n">num</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>

        <span class="k">return</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span> <span class="n">value</span><span class="p">,</span> <span class="n">num</span> <span class="o">+</span> <span class="n">denom</span><span class="p">,</span> <span class="n">uncertainty</span> <span class="p">)</span> <span class="p">)</span></div>

<div class="viewcode-block" id="PQU.info"><a class="viewcode-back" href="../../pqu/pqu.html#pqu.PQU.PQU.info">[docs]</a>    <span class="k">def</span> <span class="nf">info</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">significantDigits</span> <span class="o">=</span> <span class="mi">17</span> <span class="p">)</span> <span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns a detailed string of *self*. Mainly for debugging.</span>

<span class="sd">        :rtype: `str`</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span><span class="p">(</span> <span class="s1">&#39;</span><span class="si">%s</span><span class="s1">, unit = &quot;</span><span class="si">%s</span><span class="s1">&quot;</span><span class="se">\n</span><span class="s1">uncertainty = </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">info</span><span class="p">(</span> <span class="n">significantDigits</span> <span class="o">=</span> <span class="n">significantDigits</span> <span class="p">),</span> \
            <span class="bp">self</span><span class="o">.</span><span class="n">unit</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">uncertainty</span><span class="o">.</span><span class="n">info</span><span class="p">(</span> <span class="n">significantDigits</span> <span class="o">=</span> <span class="n">significantDigits</span> <span class="p">)</span> <span class="p">)</span> <span class="p">)</span></div>

<div class="viewcode-block" id="PQU.isCompatible"><a class="viewcode-back" href="../../pqu/pqu.html#pqu.PQU.PQU.isCompatible">[docs]</a>    <span class="k">def</span> <span class="nf">isCompatible</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">unit</span> <span class="p">)</span> <span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns **True** if *self*&#39;s unit is compatible with unit.</span>

<span class="sd">        :param unit: a unit</span>
<span class="sd">        :type unit: `str`</span>
<span class="sd">        :rtype: `bool`</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">unit</span> <span class="o">=</span> <span class="n">_findUnit</span><span class="p">(</span> <span class="n">unit</span> <span class="p">)</span>
        <span class="k">return</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">unit</span><span class="o">.</span><span class="n">isCompatible</span><span class="p">(</span> <span class="n">unit</span> <span class="p">)</span> <span class="p">)</span></div>

<div class="viewcode-block" id="PQU.isPercent"><a class="viewcode-back" href="../../pqu/pqu.html#pqu.PQU.PQU.isPercent">[docs]</a>    <span class="k">def</span> <span class="nf">isPercent</span><span class="p">(</span> <span class="bp">self</span> <span class="p">)</span> <span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns **True** if value is a percent and **False** otherwise.</span>

<span class="sd">        :rtype: `bool`</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">isPercent</span><span class="p">(</span> <span class="p">)</span> <span class="p">)</span></div>

<div class="viewcode-block" id="PQU.isDimensionless"><a class="viewcode-back" href="../../pqu/pqu.html#pqu.PQU.PQU.isDimensionless">[docs]</a>    <span class="k">def</span> <span class="nf">isDimensionless</span><span class="p">(</span> <span class="bp">self</span> <span class="p">)</span> <span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns **True** if *self* is dimensionless and **False** otherwise.</span>

<span class="sd">        :rtype: `bool`</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">unit</span><span class="o">.</span><span class="n">isDimensionless</span><span class="p">(</span> <span class="p">)</span> <span class="p">)</span></div>

<div class="viewcode-block" id="PQU.isLength"><a class="viewcode-back" href="../../pqu/pqu.html#pqu.PQU.PQU.isLength">[docs]</a>    <span class="k">def</span> <span class="nf">isLength</span><span class="p">(</span> <span class="bp">self</span> <span class="p">)</span> <span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns **True** if *self* has unit of length and **False** otherwise.</span>

<span class="sd">        :rtype: `bool`</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">isPhysicalUnitOf</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;m&#39;</span> <span class="p">)</span> <span class="p">)</span></div>

<div class="viewcode-block" id="PQU.isMass"><a class="viewcode-back" href="../../pqu/pqu.html#pqu.PQU.PQU.isMass">[docs]</a>    <span class="k">def</span> <span class="nf">isMass</span><span class="p">(</span> <span class="bp">self</span> <span class="p">)</span> <span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns **True** if *self* has unit of mass and **False** otherwise.</span>

<span class="sd">        :rtype: `bool`</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">isPhysicalUnitOf</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;g&#39;</span> <span class="p">)</span> <span class="p">)</span></div>

<div class="viewcode-block" id="PQU.isTime"><a class="viewcode-back" href="../../pqu/pqu.html#pqu.PQU.PQU.isTime">[docs]</a>    <span class="k">def</span> <span class="nf">isTime</span><span class="p">(</span> <span class="bp">self</span> <span class="p">)</span> <span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns **True** if *self* has unit of time and **False** otherwise.</span>

<span class="sd">        :rtype: `bool`</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">isPhysicalUnitOf</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;s&#39;</span> <span class="p">)</span> <span class="p">)</span></div>

<div class="viewcode-block" id="PQU.isCurrent"><a class="viewcode-back" href="../../pqu/pqu.html#pqu.PQU.PQU.isCurrent">[docs]</a>    <span class="k">def</span> <span class="nf">isCurrent</span><span class="p">(</span> <span class="bp">self</span> <span class="p">)</span> <span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns **True** if *self* has unit of current and **False** otherwise.</span>

<span class="sd">        :rtype: `bool`</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">isPhysicalUnitOf</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span> <span class="p">)</span> <span class="p">)</span></div>

<div class="viewcode-block" id="PQU.isTemperature"><a class="viewcode-back" href="../../pqu/pqu.html#pqu.PQU.PQU.isTemperature">[docs]</a>    <span class="k">def</span> <span class="nf">isTemperature</span><span class="p">(</span> <span class="bp">self</span> <span class="p">)</span> <span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns **True** if *self* has unit of temperature and **False** otherwise.</span>

<span class="sd">        :rtype: `bool`</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">isPhysicalUnitOf</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;K&#39;</span> <span class="p">)</span> <span class="p">)</span></div>

<div class="viewcode-block" id="PQU.isMoles"><a class="viewcode-back" href="../../pqu/pqu.html#pqu.PQU.PQU.isMoles">[docs]</a>    <span class="k">def</span> <span class="nf">isMoles</span><span class="p">(</span> <span class="bp">self</span> <span class="p">)</span> <span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns **True** if *self* has unit of mol and **False** otherwise.</span>

<span class="sd">        :rtype: `bool`</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">isPhysicalUnitOf</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;mol&#39;</span> <span class="p">)</span> <span class="p">)</span></div>

<div class="viewcode-block" id="PQU.isLuminousIntensity"><a class="viewcode-back" href="../../pqu/pqu.html#pqu.PQU.PQU.isLuminousIntensity">[docs]</a>    <span class="k">def</span> <span class="nf">isLuminousIntensity</span><span class="p">(</span> <span class="bp">self</span> <span class="p">)</span> <span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns **True** if *self* has unit of luminous intensity and **False** otherwise.</span>

<span class="sd">        :rtype: `bool`</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">isPhysicalUnitOf</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;cd&#39;</span> <span class="p">)</span> <span class="p">)</span></div>

<div class="viewcode-block" id="PQU.isAngle"><a class="viewcode-back" href="../../pqu/pqu.html#pqu.PQU.PQU.isAngle">[docs]</a>    <span class="k">def</span> <span class="nf">isAngle</span><span class="p">(</span> <span class="bp">self</span> <span class="p">)</span> <span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns **True** if *self* has unit of angle and **False** otherwise.</span>

<span class="sd">        :rtype: `bool`</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">isPhysicalUnitOf</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;rad&#39;</span> <span class="p">)</span> <span class="p">)</span></div>

<div class="viewcode-block" id="PQU.isSolidAngle"><a class="viewcode-back" href="../../pqu/pqu.html#pqu.PQU.PQU.isSolidAngle">[docs]</a>    <span class="k">def</span> <span class="nf">isSolidAngle</span><span class="p">(</span> <span class="bp">self</span> <span class="p">)</span> <span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns **True** if *self* has unit of solid angle and **False** otherwise.</span>

<span class="sd">        :rtype: `bool`</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">isPhysicalUnitOf</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;sr&#39;</span> <span class="p">)</span> <span class="p">)</span></div>

<div class="viewcode-block" id="PQU.isEnergy"><a class="viewcode-back" href="../../pqu/pqu.html#pqu.PQU.PQU.isEnergy">[docs]</a>    <span class="k">def</span> <span class="nf">isEnergy</span><span class="p">(</span> <span class="bp">self</span> <span class="p">)</span> <span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns **True** if *self* has unit of energy and **False** otherwise.</span>

<span class="sd">        :rtype: `bool`</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">isPhysicalUnitOf</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;J&#39;</span> <span class="p">)</span> <span class="p">)</span></div>

<div class="viewcode-block" id="PQU.isSpin"><a class="viewcode-back" href="../../pqu/pqu.html#pqu.PQU.PQU.isSpin">[docs]</a>    <span class="k">def</span> <span class="nf">isSpin</span><span class="p">(</span> <span class="bp">self</span> <span class="p">)</span> <span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns **True** if *self* has unit of spin (i.e., same as &#39;hbar&#39;) and **False** otherwise.</span>

<span class="sd">        :rtype: `bool`</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">isPhysicalUnitOf</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;hbar&#39;</span> <span class="p">)</span> <span class="p">)</span></div>

<div class="viewcode-block" id="PQU.isCharge"><a class="viewcode-back" href="../../pqu/pqu.html#pqu.PQU.PQU.isCharge">[docs]</a>    <span class="k">def</span> <span class="nf">isCharge</span><span class="p">(</span> <span class="bp">self</span> <span class="p">)</span> <span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns **True** if *self* has unit of charge and **False** otherwise.</span>

<span class="sd">        :rtype: `bool`</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">isPhysicalUnitOf</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;e&#39;</span> <span class="p">)</span> <span class="p">)</span></div>

<div class="viewcode-block" id="PQU.setPercentFlag"><a class="viewcode-back" href="../../pqu/pqu.html#pqu.PQU.PQU.setPercentFlag">[docs]</a>    <span class="k">def</span> <span class="nf">setPercentFlag</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">isPercent</span><span class="p">,</span> <span class="n">scaleValue</span> <span class="o">=</span> <span class="kc">False</span> <span class="p">)</span> <span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Changes the percent flag only when *self* is dimensionless and isPercent != *self*.isPercent( ).</span>
<span class="sd">        Otherwise, a raise is executed.  For scaleValue argument see :py:meth:`PQU_float.setPercentFlag`.</span>

<span class="sd">        :param isPercent: See :py:meth:`PQU_float.setPercentFlag`</span>
<span class="sd">        :param scaleValue: See :py:meth:`PQU_float.setPercentFlag`</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span><span class="p">(</span> <span class="ow">not</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">isDimensionless</span><span class="p">(</span> <span class="p">)</span> <span class="p">)</span> <span class="p">)</span> <span class="p">:</span> <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span> <span class="s1">&#39;Can only set/unset percent on a dimensionless PQU: unit = &quot;</span><span class="si">%s</span><span class="s1">&quot;&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">unit</span> <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">setPercentFlag</span><span class="p">(</span> <span class="n">isPercent</span><span class="p">,</span> <span class="n">scaleValue</span> <span class="p">)</span>
        <span class="k">if</span><span class="p">(</span> <span class="n">scaleValue</span> <span class="ow">and</span> <span class="ow">not</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">uncertainty</span><span class="o">.</span><span class="n">isPercent</span><span class="p">(</span> <span class="p">)</span> <span class="p">)</span> <span class="p">)</span> <span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">uncertainty</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">setPercentFlag</span><span class="p">(</span> <span class="kc">True</span><span class="p">,</span> <span class="n">isPercent</span> <span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">uncertainty</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">setPercentFlag</span><span class="p">(</span> <span class="kc">False</span><span class="p">,</span> <span class="ow">not</span><span class="p">(</span> <span class="n">isPercent</span> <span class="p">)</span> <span class="p">)</span></div>

<div class="viewcode-block" id="PQU.simplify"><a class="viewcode-back" href="../../pqu/pqu.html#pqu.PQU.PQU.simplify">[docs]</a>    <span class="k">def</span> <span class="nf">simplify</span><span class="p">(</span> <span class="bp">self</span> <span class="p">)</span> <span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This method returns a :py:class:`PQU` instance that is the same as *self* but with its units simplified. This is,</span>
<span class="sd">        units that have the same base units are reduce to one of those units. For example, if *self* is equivalent to</span>
<span class="sd">        &#39;1.2 km/m**3&#39; then the returned instance will be equivalent to &#39;1.2e3 / m**2&#39; or &#39;1.2e9 / km**2&#39;</span>
<span class="sd">        (the actual units returned are not guaranteed). As another example, if *self* is equivalent to</span>
<span class="sd">        &#39;1.2 ft**3 / lb / s / ( m**2 / kg )&#39; then one returned outcome is &#39;0.2457793723470261 ft/s&#39;.</span>
<span class="sd">        That is, the &#39;ft&#39; and &#39;m&#39; units have the same base units and are all converted to &#39;ft&#39; (in</span>
<span class="sd">        this case) and the &#39;lb&#39; and &#39;kg&#39; are all converted to &#39;lb&#39; (or &#39;kg&#39;).</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span><span class="p">(</span> <span class="bp">self</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">unit</span><span class="o">.</span><span class="n">simplifyUnitsFactor</span><span class="p">(</span> <span class="p">)</span> <span class="p">)</span></div>

<div class="viewcode-block" id="PQU.toString"><a class="viewcode-back" href="../../pqu/pqu.html#pqu.PQU.PQU.toString">[docs]</a>    <span class="k">def</span> <span class="nf">toString</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">significantDigits</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">keepPeriod</span> <span class="o">=</span> <span class="kc">True</span> <span class="p">)</span> <span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a string representation of *self* (e.g., &#39;35 +/- 1.2% J&#39;).</span>

<span class="sd">        :param significantDigits: Passed onto the methods :py:meth:`PQU_float.toString` and :py:meth:`PQU_uncertainty.toString`</span>
<span class="sd">        :param :param : Passed onto the method :py:meth:`PQU_float.toString`.</span>

<span class="sd">        :rtype: `str`</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">trimZeros</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">getSignificantDigits</span><span class="p">(</span> <span class="p">)</span> <span class="o">&gt;</span> <span class="n">maxSignificantDigits</span>

        <span class="n">includePercent</span><span class="p">,</span> <span class="n">str1</span><span class="p">,</span> <span class="n">str2</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span>
        <span class="n">uncertainty</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">uncertainty</span>
        <span class="k">if</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">isPercent</span><span class="p">(</span> <span class="p">)</span> <span class="p">)</span> <span class="p">:</span>
            <span class="k">if</span><span class="p">(</span>   <span class="bp">self</span><span class="o">.</span><span class="n">uncertainty</span><span class="o">.</span><span class="n">style</span> <span class="o">==</span> <span class="n">PQU_uncertainty</span><span class="o">.</span><span class="n">pqu_uncertaintyStylePlusMinus</span> <span class="p">)</span> <span class="p">:</span>
                <span class="n">str1</span><span class="p">,</span> <span class="n">str2</span><span class="p">,</span> <span class="n">includePercent</span> <span class="o">=</span> <span class="s1">&#39;(&#39;</span><span class="p">,</span> <span class="s1">&#39;)%&#39;</span><span class="p">,</span> <span class="kc">False</span>
                <span class="n">uncertainty</span> <span class="o">=</span> <span class="n">uncertainty</span> <span class="o">*</span> <span class="mi">100</span>
            <span class="k">elif</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">uncertainty</span><span class="o">.</span><span class="n">style</span> <span class="o">==</span> <span class="n">PQU_uncertainty</span><span class="o">.</span><span class="n">pqu_uncertaintyStyleParenthesis</span> <span class="p">)</span> <span class="p">:</span>
                <span class="n">str2</span><span class="p">,</span> <span class="n">includePercent</span> <span class="o">=</span> <span class="s1">&#39;%&#39;</span><span class="p">,</span> <span class="kc">False</span>

        <span class="n">str1</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">toString</span><span class="p">(</span> <span class="n">trimZeros</span> <span class="o">=</span> <span class="n">trimZeros</span><span class="p">,</span> <span class="n">includePercent</span> <span class="o">=</span> <span class="n">includePercent</span><span class="p">,</span> \
                <span class="n">significantDigits</span> <span class="o">=</span> <span class="n">significantDigits</span><span class="p">,</span> <span class="n">keepPeriod</span> <span class="o">=</span> <span class="n">keepPeriod</span> <span class="p">)</span> \
                <span class="o">+</span> <span class="n">uncertainty</span><span class="o">.</span><span class="n">toString</span><span class="p">(</span> <span class="n">significantDigits</span> <span class="o">=</span> <span class="n">significantDigits</span> <span class="p">)</span>
        <span class="n">str3</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">unit</span> <span class="p">)</span>
        <span class="k">if</span><span class="p">(</span> <span class="n">str3</span> <span class="o">!=</span> <span class="s1">&#39;&#39;</span> <span class="p">)</span> <span class="p">:</span> <span class="n">str1</span> <span class="o">+=</span> <span class="s1">&#39; &#39;</span>
        <span class="k">return</span><span class="p">(</span> <span class="n">str1</span> <span class="o">+</span> <span class="n">str2</span> <span class="o">+</span> <span class="n">str3</span> <span class="p">)</span></div>

<div class="viewcode-block" id="PQU.truncate"><a class="viewcode-back" href="../../pqu/pqu.html#pqu.PQU.PQU.truncate">[docs]</a>    <span class="k">def</span> <span class="nf">truncate</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">value</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">uncertainty</span> <span class="o">=</span> <span class="kc">True</span> <span class="p">)</span> <span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        If value is **True**, calls *self*.value&#39;s truncate method. If uncertainty is **True**, </span>
<span class="sd">        calls *self*.uncertainty&#39;s truncate method.  See :py:meth:`PQU_float.truncate`</span>
<span class="sd">        and :py:meth:`PQU_uncertainty.truncate`</span>

<span class="sd">        :param value: If **True** *self*&#39;s value is truncated</span>
<span class="sd">        :type value: `bool`</span>
<span class="sd">        :param uncertainty: If **True** *self*&#39;s uncertainty is truncated</span>
<span class="sd">        :type uncertainty: `bool`</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span><span class="p">(</span> <span class="n">value</span> <span class="p">)</span> <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">truncate</span><span class="p">(</span> <span class="p">)</span>
        <span class="k">if</span><span class="p">(</span> <span class="n">uncertainty</span> <span class="p">)</span> <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">uncertainty</span><span class="o">.</span><span class="n">truncate</span><span class="p">(</span> <span class="p">)</span></div>

<div class="viewcode-block" id="PQU.sqrt"><a class="viewcode-back" href="../../pqu/pqu.html#pqu.PQU.PQU.sqrt">[docs]</a>    <span class="k">def</span> <span class="nf">sqrt</span><span class="p">(</span> <span class="bp">self</span> <span class="p">)</span> <span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns a :py:class:`PQU` of the square root of *self*.&quot;&quot;&quot;</span>

        <span class="k">return</span><span class="p">(</span> <span class="nb">pow</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="mf">0.5</span> <span class="p">)</span> <span class="p">)</span></div>

<div class="viewcode-block" id="PQU.sin"><a class="viewcode-back" href="../../pqu/pqu.html#pqu.PQU.PQU.sin">[docs]</a>    <span class="k">def</span> <span class="nf">sin</span><span class="p">(</span> <span class="bp">self</span> <span class="p">)</span> <span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns a :py:class:`PQU` of the sin of *self*. Self must have unit of angle.&quot;&quot;&quot;</span>

        <span class="k">if</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">unit</span><span class="o">.</span><span class="n">isAngle</span><span class="p">(</span> <span class="p">)</span> <span class="p">)</span> <span class="p">:</span> <span class="k">return</span><span class="p">(</span> <span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">unit</span><span class="o">.</span><span class="n">conversionFactorTo</span><span class="p">(</span> <span class="n">_unit_table</span><span class="p">[</span><span class="s1">&#39;rad&#39;</span><span class="p">]</span> <span class="p">)</span> <span class="p">)</span> <span class="p">)</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span> <span class="s1">&#39;Argument of sin must be an angle.&#39;</span> <span class="p">)</span></div>

<div class="viewcode-block" id="PQU.cos"><a class="viewcode-back" href="../../pqu/pqu.html#pqu.PQU.PQU.cos">[docs]</a>    <span class="k">def</span> <span class="nf">cos</span><span class="p">(</span> <span class="bp">self</span> <span class="p">)</span> <span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns a :py:class:`PQU` of the cos of *self*. Self must have unit of angle.&quot;&quot;&quot;</span>

        <span class="k">if</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">unit</span><span class="o">.</span><span class="n">isAngle</span><span class="p">(</span> <span class="p">)</span> <span class="p">)</span> <span class="p">:</span> <span class="k">return</span><span class="p">(</span> <span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">unit</span><span class="o">.</span><span class="n">conversionFactorTo</span><span class="p">(</span> <span class="n">_unit_table</span><span class="p">[</span><span class="s1">&#39;rad&#39;</span><span class="p">]</span> <span class="p">)</span> <span class="p">)</span> <span class="p">)</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span> <span class="s1">&#39;Argument of cos must be an angle.&#39;</span> <span class="p">)</span></div>

<div class="viewcode-block" id="PQU.tan"><a class="viewcode-back" href="../../pqu/pqu.html#pqu.PQU.PQU.tan">[docs]</a>    <span class="k">def</span> <span class="nf">tan</span><span class="p">(</span> <span class="bp">self</span> <span class="p">)</span> <span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns a :py:class:`PQU` of the tan of *self*. Self must have unit of angle.&quot;&quot;&quot;</span>

        <span class="k">if</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">unit</span><span class="o">.</span><span class="n">isAngle</span><span class="p">(</span> <span class="p">)</span> <span class="p">)</span> <span class="p">:</span> <span class="k">return</span><span class="p">(</span> <span class="n">math</span><span class="o">.</span><span class="n">tan</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">unit</span><span class="o">.</span><span class="n">conversionFactorTo</span><span class="p">(</span> <span class="n">_unit_table</span><span class="p">[</span><span class="s1">&#39;rad&#39;</span><span class="p">]</span> <span class="p">)</span> <span class="p">)</span> <span class="p">)</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span> <span class="s1">&#39;Argument of tan must be an angle.&#39;</span> <span class="p">)</span></div>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_getOtherAsPQU</span><span class="p">(</span> <span class="n">other</span> <span class="p">)</span> <span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a :py:class:`PQU` representation of other. If other is a :py:class:`PQU`</span>
<span class="sd">        instance, it is returned (i.e., no copy is made). Otherwise, the PQU.__init__ </span>
<span class="sd">        method is called with only other as an argument and its return value returned.</span>

<span class="sd">        :param other: a :py:class:`PQU` equivalent to convert, if needed, to a :py:class:`PQU` instance</span>
<span class="sd">        :returns: a :py:class:`PQU` instance equivalent to other</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span><span class="p">(</span> <span class="nb">isinstance</span><span class="p">(</span> <span class="n">other</span><span class="p">,</span> <span class="n">PQU</span> <span class="p">)</span> <span class="p">)</span> <span class="p">:</span> <span class="k">return</span><span class="p">(</span> <span class="n">other</span> <span class="p">)</span>
        <span class="k">return</span><span class="p">(</span> <span class="n">PQU</span><span class="p">(</span> <span class="n">other</span> <span class="p">)</span> <span class="p">)</span>

<div class="viewcode-block" id="PQU.isPhysicalUnitOf"><a class="viewcode-back" href="../../pqu/pqu.html#pqu.PQU.PQU.isPhysicalUnitOf">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">isPhysicalUnitOf</span><span class="p">(</span> <span class="n">elf</span><span class="p">,</span> <span class="n">unit</span> <span class="p">)</span> <span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns **True** if elf has the same unit as the argument unit and **False** otherwise. Elf and unit can be an instance of string,</span>
<span class="sd">        :py:class:`PhysicalUnit` or :py:class:`PQU`.</span>

<span class="sd">        :param elf: The instance to compare to unit</span>
<span class="sd">        :type elf: a unit equivalent</span>
<span class="sd">        :param unit: The desired unit</span>
<span class="sd">        :type unit: a unit equivalent</span>
<span class="sd">        :rtype: `bool`</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">elfUnit</span> <span class="o">=</span> <span class="n">_getPhysicalUnit</span><span class="p">(</span> <span class="n">elf</span> <span class="p">)</span>
        <span class="n">unitUnit</span> <span class="o">=</span> <span class="n">_getPhysicalUnit</span><span class="p">(</span> <span class="n">unit</span> <span class="p">)</span>
        <span class="k">return</span><span class="p">(</span> <span class="n">elfUnit</span><span class="o">.</span><span class="n">isCompatible</span><span class="p">(</span> <span class="n">unitUnit</span> <span class="p">)</span> <span class="p">)</span></div></div>

<span class="n">PhysicalQuantityWithUncertainty</span> <span class="o">=</span> <span class="n">PQU</span>           <span class="c1"># This is deprecated.</span>

<div class="viewcode-block" id="Parsers"><a class="viewcode-back" href="../../pqu/pqu.html#pqu.PQU.Parsers">[docs]</a><span class="k">class</span> <span class="nc">Parsers</span> <span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This is use to parse the allowed **PQU** strings (e.g., &#39;1 m&#39;, &#39;1.32(3) kg).</span>
<span class="sd">    See the table in the :py:meth:`parsePQUString.parsePQUString` doc string for allowed **PQU** strings.</span>
<span class="sd">    This class is mainly for internal use.</span>

<span class="sd">    .. rubric:: Regular Expression Matching</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">_spaces</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;[ \t]*&#39;</span>
    <span class="n">_anything_RE</span> <span class="o">=</span> <span class="s1">&#39;(.*)&#39;</span>
    <span class="n">_sign</span> <span class="o">=</span> <span class="s1">&#39;[+-]?&#39;</span>                                     <span class="c1"># Optional sign regular expression.</span>
    <span class="n">_unsignedInteger</span> <span class="o">=</span> <span class="s1">&#39;\d+&#39;</span>
    <span class="n">_signedInteger</span> <span class="o">=</span> <span class="n">_sign</span> <span class="o">+</span> <span class="n">_unsignedInteger</span>
    <span class="n">_mantissa</span> <span class="o">=</span> <span class="s1">&#39;(</span><span class="si">%s</span><span class="s1">)((\d+)\.?(\d*)|\.(\d+))&#39;</span> <span class="o">%</span> <span class="n">_sign</span>   <span class="c1"># Regular expression matching a decimal or an integer string.</span>
    <span class="n">_exponent</span> <span class="o">=</span> <span class="s1">&#39;([eE](</span><span class="si">%s</span><span class="s1">\d+))?&#39;</span> <span class="o">%</span> <span class="n">_sign</span>                <span class="c1"># Optional exponent regular expression.</span>

    <span class="n">_floatingPoint_RE</span> <span class="o">=</span> <span class="s1">&#39;(</span><span class="si">%s%s</span><span class="s1">)&#39;</span> <span class="o">%</span> <span class="p">(</span> <span class="n">_mantissa</span><span class="p">,</span> <span class="n">_exponent</span> <span class="p">)</span>   <span class="c1"># Floating point regular expression.</span>
    <span class="n">_floatingPoint_PO</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span> <span class="s1">&#39;^&#39;</span> <span class="o">+</span> <span class="n">_spaces</span> <span class="o">+</span> <span class="n">_floatingPoint_RE</span> <span class="o">+</span> <span class="n">_spaces</span> <span class="o">+</span> <span class="s1">&#39;$&#39;</span> <span class="p">)</span>

    <span class="n">_floatingPoint_andAnythingElse_RE</span> <span class="o">=</span> <span class="s1">&#39;^&#39;</span> <span class="o">+</span> <span class="n">_floatingPoint_RE</span> <span class="o">+</span> <span class="n">_anything_RE</span>
    <span class="n">_floatingPoint_andAnythingElse_PO</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span> <span class="n">_floatingPoint_andAnythingElse_RE</span> <span class="p">)</span>

    <span class="n">_uncertaintyPlusMinus_andAnythingElse_RE</span> <span class="o">=</span> <span class="s1">&#39;^&#39;</span> <span class="o">+</span> <span class="n">_spaces</span> <span class="o">+</span> <span class="sa">r</span><span class="s1">&#39;\+/-&#39;</span> <span class="o">+</span> <span class="n">_spaces</span> <span class="o">+</span> <span class="n">_floatingPoint_RE</span> <span class="o">+</span> <span class="n">_anything_RE</span>
    <span class="n">_uncertaintyPlusMinus_andAnythingElse_PO</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span> <span class="n">_uncertaintyPlusMinus_andAnythingElse_RE</span> <span class="p">)</span>

    <span class="n">_uncertaintyParenthesis_andAnythingElse_RE</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;^[(](\d\d?)[)]&#39;</span> <span class="o">+</span> <span class="n">_anything_RE</span>
    <span class="n">_uncertaintyParenthesis_andAnythingElse_PO</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span> <span class="n">_uncertaintyParenthesis_andAnythingElse_RE</span> <span class="p">)</span>

    <span class="n">_unitCharacters_RE</span> <span class="o">=</span> <span class="s1">&#39;([ a-zA-Z*/()]*)&#39;</span>           <span class="c1"># This does not match a valid unit, it only match the part of a</span>
                                                    <span class="c1"># string that contains characters that can be present in a unit string.</span>

<div class="viewcode-block" id="Parsers.parseFloat"><a class="viewcode-back" href="../../pqu/pqu.html#pqu.PQU.Parsers.parseFloat">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">parseFloat</span><span class="p">(</span> <span class="n">str1</span><span class="p">,</span> <span class="n">fullStr</span> <span class="p">)</span> <span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This method parses the beginning of str1 for a valid float. An arbitrary number of white spaces can exists before the </span>
<span class="sd">        float characters. This method returns a tuple of length 3. The first item of the tuple is the float </span>
<span class="sd">        value returned as a :py:class:`PQU_float` instance with significantDigits determined from the string.  The second </span>
<span class="sd">        item is significantDigitsForZero which, if the string represents a 0 value, gives the number of significant </span>
<span class="sd">        digits for the zero; otherwise None is returned. As example, the string &#39;000.000&#39; has 4 significant digits </span>
<span class="sd">        (i.e., it is considered equivalent to the representation &#39;0.000&#39;).  The last object is the string of all </span>
<span class="sd">        characters after the last one used for converting the float.  For example, with str1 = &#39;   12.345e3ABCD XYS&#39; </span>
<span class="sd">        the returned tuple is:</span>

<span class="sd">        ( PQU_float( 1.2345e4, 5 ), None, &#39;ABCD XYS&#39; ).</span>

<span class="sd">        :param str1: String to parse.</span>
<span class="sd">        :param fullStr: String which str1 is a part of.</span>
<span class="sd">        :rtype: ( PQU_float, integer | None, string )</span>
<span class="sd">        &quot;&quot;&quot;</span>

<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The following table list the components of the groups returned by the regular expression match.</span>

<span class="sd">        Group |</span>
<span class="sd">        index | contents</span>
<span class="sd">        ------+-------------------------------------------------------------------------------------</span>
<span class="sd">          0   | Float (e.g., for &#39;12.34e-12 +/- 6.7e-13 m / s**2&#39; this would be &#39;12.34e-12&#39;)</span>
<span class="sd">          1   | Float&#39;s sign</span>
<span class="sd">          2   | Mantissa part of float</span>
<span class="sd">          3   | Float&#39;s digits to the left of the period (e.g., for &#39;12.34e-12&#39; this would be &#39;12&#39;)</span>
<span class="sd">          4   | Float&#39;s digits to the right of the period if there are digits to left of period (e.g., for &#39;12.34e-12&#39; this would be &#39;34&#39;)</span>
<span class="sd">          5   | Float&#39;s digits to the right of the period if there are no digits to left of period (e.g., for &#39;.56e-12&#39; this would be &#39;56&#39;)</span>
<span class="sd">          6   | Float&#39;s exponent (e.g., for &#39;12.34e-12&#39; this would be &#39;e-12&#39;)</span>
<span class="sd">          7   | Float&#39;s exponent value (e.g., for &#39;12.34e-12&#39; this would be &#39;-12&#39;)</span>
<span class="sd">          8   | Everything after the float</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span><span class="p">(</span> <span class="ow">not</span><span class="p">(</span> <span class="nb">isinstance</span><span class="p">(</span> <span class="n">str1</span><span class="p">,</span> <span class="nb">str</span> <span class="p">)</span> <span class="p">)</span> <span class="p">)</span> <span class="p">:</span> <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span> <span class="s1">&#39;Argument must be a string: type = </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="nb">type</span><span class="p">(</span> <span class="n">str1</span> <span class="p">)</span> <span class="p">)</span>
        <span class="n">match</span> <span class="o">=</span> <span class="n">Parsers</span><span class="o">.</span><span class="n">_floatingPoint_andAnythingElse_PO</span><span class="o">.</span><span class="n">match</span><span class="p">(</span> <span class="n">str1</span> <span class="p">)</span>
        <span class="k">if</span><span class="p">(</span> <span class="n">match</span> <span class="ow">is</span> <span class="kc">None</span> <span class="p">)</span> <span class="p">:</span> <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span> <span class="s1">&#39;String does not start with a float: &quot;</span><span class="si">%s</span><span class="s1">&quot; of &quot;</span><span class="si">%s</span><span class="s1">&quot;&#39;</span> <span class="o">%</span> <span class="p">(</span> <span class="n">str1</span><span class="p">,</span> <span class="n">fullStr</span> <span class="p">)</span> <span class="p">)</span>
        <span class="n">groups</span> <span class="o">=</span> <span class="n">match</span><span class="o">.</span><span class="n">groups</span><span class="p">(</span> <span class="p">)</span>
        <span class="n">value</span><span class="p">,</span> <span class="n">order</span><span class="p">,</span> <span class="n">significantDigits</span><span class="p">,</span> <span class="n">significantDigitsForZero</span> <span class="o">=</span> <span class="n">Parsers</span><span class="o">.</span><span class="n">_parseFloatGroups</span><span class="p">(</span> <span class="n">groups</span> <span class="p">)</span>
        <span class="k">return</span><span class="p">(</span> <span class="n">PQU_float</span><span class="p">(</span> <span class="n">value</span><span class="p">,</span> <span class="n">significantDigits</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="n">checkOrder</span> <span class="o">=</span> <span class="kc">False</span> <span class="p">),</span> <span class="n">significantDigitsForZero</span><span class="p">,</span> <span class="n">groups</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span> <span class="p">)</span></div>

<div class="viewcode-block" id="Parsers.parsePlusMinusUncertainty"><a class="viewcode-back" href="../../pqu/pqu.html#pqu.PQU.Parsers.parsePlusMinusUncertainty">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">parsePlusMinusUncertainty</span><span class="p">(</span> <span class="n">str1</span><span class="p">,</span> <span class="n">fullStr</span> <span class="p">)</span> <span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This method parses the beginning of str1 for the sub-string &#39;+/-&#39; followed by a float string. An arbitrary number of </span>
<span class="sd">        white spaces can exists before the &#39;+/-&#39; sub-string and between it and the float string. This method</span>
<span class="sd">        returns a tuple of length 2. The first item of the tuple is float value returned as a :py:class:`PQU_uncertainty`</span>
<span class="sd">        of style pqu_uncertaintyStylePlusMinus. Characters after the last one used for converting the float are </span>
<span class="sd">        returned as the second item. For example, with str1 = &#39; +/-  12. ABCD XYS&#39; the returned tuple is:</span>

<span class="sd">        ( PQU_uncertainty( PQU_uncertainty.pqu_uncertaintyStylePlusMinus, 12. ), &#39; ABCD XYS&#39; )</span>

<span class="sd">        :param str1: String to parse.</span>
<span class="sd">        :param fullStr: String which str1 is a part of.</span>
<span class="sd">        :rtype: ( PQU_uncertainty, string )</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span><span class="p">(</span> <span class="ow">not</span><span class="p">(</span> <span class="nb">isinstance</span><span class="p">(</span> <span class="n">str1</span><span class="p">,</span> <span class="nb">str</span> <span class="p">)</span> <span class="p">)</span> <span class="p">)</span> <span class="p">:</span> <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span> <span class="s1">&#39;Argument must be a string: type = </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="nb">type</span><span class="p">(</span> <span class="n">str1</span> <span class="p">)</span> <span class="p">)</span>
        <span class="n">match</span> <span class="o">=</span> <span class="n">Parsers</span><span class="o">.</span><span class="n">_uncertaintyPlusMinus_andAnythingElse_PO</span><span class="o">.</span><span class="n">match</span><span class="p">(</span> <span class="n">str1</span> <span class="p">)</span>
        <span class="k">if</span><span class="p">(</span> <span class="n">match</span> <span class="ow">is</span> <span class="kc">None</span> <span class="p">)</span> <span class="p">:</span> <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span> <span class="s1">&#39;String does not match &quot;+/-&quot; with a float: &quot;</span><span class="si">%s</span><span class="s1">&quot; of &quot;</span><span class="si">%s</span><span class="s1">&quot;&#39;</span> <span class="o">%</span> <span class="p">(</span> <span class="n">str1</span><span class="p">,</span> <span class="n">fullStr</span> <span class="p">)</span> <span class="p">)</span>
        <span class="n">groups</span> <span class="o">=</span> <span class="n">match</span><span class="o">.</span><span class="n">groups</span><span class="p">(</span> <span class="p">)</span>
        <span class="n">value</span><span class="p">,</span> <span class="n">order</span><span class="p">,</span> <span class="n">significantDigits</span><span class="p">,</span> <span class="n">significantDigitsForZero</span> <span class="o">=</span> <span class="n">Parsers</span><span class="o">.</span><span class="n">_parseFloatGroups</span><span class="p">(</span> <span class="n">groups</span> <span class="p">)</span>
        <span class="n">uncertainty</span> <span class="o">=</span> <span class="n">PQU_uncertainty</span><span class="p">(</span> <span class="n">PQU_uncertainty</span><span class="o">.</span><span class="n">pqu_uncertaintyStylePlusMinus</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">significantDigits</span><span class="p">,</span> <span class="n">checkOrder</span> <span class="o">=</span> <span class="kc">False</span> <span class="p">)</span>
        <span class="k">return</span><span class="p">(</span> <span class="n">uncertainty</span><span class="p">,</span> <span class="n">groups</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span> <span class="p">)</span></div>

<div class="viewcode-block" id="Parsers.parseParenthesisUncertainty"><a class="viewcode-back" href="../../pqu/pqu.html#pqu.PQU.Parsers.parseParenthesisUncertainty">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">parseParenthesisUncertainty</span><span class="p">(</span> <span class="n">str1</span><span class="p">,</span> <span class="n">fullStr</span> <span class="p">)</span> <span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This method parses the beginning of str1 for the sub-string &#39;(#)&#39; where &#39;#&#39; is a 1 or 2 digit</span>
<span class="sd">        number.  This method returns a tuple of length 2. The first item of the tuple is the number returned as </span>
<span class="sd">        a :py:class:`PQU_uncertainty` of style pqu_uncertaintyStyleParenthesis. Characters after the &#39;)&#39; are returned </span>
<span class="sd">        as the second item. For example, with str1 = &#39;(34) ABCD XYS&#39; the returned tuple is:</span>

<span class="sd">        ( PQU_uncertainty( PQU_uncertainty.pqu_uncertaintyStyleParenthesis, 34, significantDigits = 2 ), &#39; ABCD XYS&#39; ).</span>

<span class="sd">        :param str1: String to parse.</span>
<span class="sd">        :param fullStr: String which str1 is a part of.</span>
<span class="sd">        :rtype: ( PQU_uncertainty, string )</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span><span class="p">(</span> <span class="ow">not</span><span class="p">(</span> <span class="nb">isinstance</span><span class="p">(</span> <span class="n">str1</span><span class="p">,</span> <span class="nb">str</span> <span class="p">)</span> <span class="p">)</span> <span class="p">)</span> <span class="p">:</span> <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span> <span class="s1">&#39;Argument must be a string: type = </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="nb">type</span><span class="p">(</span> <span class="n">str1</span> <span class="p">)</span> <span class="p">)</span>
        <span class="n">match</span> <span class="o">=</span> <span class="n">Parsers</span><span class="o">.</span><span class="n">_uncertaintyParenthesis_andAnythingElse_PO</span><span class="o">.</span><span class="n">match</span><span class="p">(</span> <span class="n">str1</span> <span class="p">)</span>
        <span class="k">if</span><span class="p">(</span> <span class="n">match</span> <span class="ow">is</span> <span class="kc">None</span> <span class="p">)</span> <span class="p">:</span> <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span> <span class="s1">&#39;String does not match &quot;(#)&quot; or &quot;(##)&quot; where &quot;#&quot; is a digit: &quot;</span><span class="si">%s</span><span class="s1">&quot; or &quot;</span><span class="si">%s</span><span class="s1">&quot;&#39;</span> <span class="o">%</span> 
            <span class="p">(</span> <span class="n">str1</span><span class="p">,</span> <span class="n">fullStr</span> <span class="p">)</span> <span class="p">)</span>
        <span class="n">groups</span> <span class="o">=</span> <span class="n">match</span><span class="o">.</span><span class="n">groups</span><span class="p">(</span> <span class="p">)</span>
        <span class="n">uncertainty</span> <span class="o">=</span> <span class="n">PQU_uncertainty</span><span class="p">(</span> <span class="n">PQU_uncertainty</span><span class="o">.</span><span class="n">pqu_uncertaintyStyleParenthesis</span><span class="p">,</span> <span class="nb">float</span><span class="p">(</span> <span class="n">groups</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="p">),</span> <span class="nb">len</span><span class="p">(</span> <span class="n">groups</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="p">),</span> <span class="n">checkOrder</span> <span class="o">=</span> <span class="kc">False</span> <span class="p">)</span>
        <span class="k">return</span><span class="p">(</span> <span class="n">uncertainty</span><span class="p">,</span> <span class="n">groups</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="p">)</span></div>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_parseFloatGroups</span><span class="p">(</span> <span class="n">groups</span> <span class="p">)</span> <span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        For internal use. This method analyzes the groups to determine the properties of a float and returns its</span>
<span class="sd">        value, order, significantDigits and significantDigitsForZero.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">significantDigitsForZero</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span><span class="p">(</span> <span class="n">groups</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span> <span class="p">)</span> <span class="p">:</span> <span class="k">return</span><span class="p">(</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span> <span class="p">)</span>
        <span class="k">if</span><span class="p">(</span> <span class="nb">float</span><span class="p">(</span> <span class="n">groups</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="p">)</span> <span class="o">==</span> <span class="mf">0.</span> <span class="p">)</span> <span class="p">:</span>    <span class="c1"># Mantissa is zero.</span>
            <span class="n">significantDigits</span><span class="p">,</span> <span class="n">index</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span>
            <span class="k">if</span><span class="p">(</span> <span class="n">groups</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span> <span class="p">)</span> <span class="p">:</span> <span class="n">index</span> <span class="o">=</span> <span class="mi">5</span>
            <span class="n">significantDigitsForZero</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span> <span class="n">groups</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="p">)</span>     <span class="c1"># Needed for zero with () style uncertainty (e.g., &quot;0.0000(4)&quot;).</span>
        <span class="k">else</span> <span class="p">:</span>
            <span class="n">mantissa</span> <span class="o">=</span> <span class="n">groups</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span>
            <span class="k">if</span><span class="p">(</span> <span class="n">mantissa</span> <span class="ow">is</span> <span class="kc">None</span> <span class="p">)</span> <span class="p">:</span>       <span class="c1"># Mantissa has digits to the left and maybe right of the period (e.g., &quot;123.45&quot;).</span>
                <span class="n">mantissa</span> <span class="o">=</span> <span class="n">groups</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
                <span class="k">if</span><span class="p">(</span> <span class="n">groups</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">)</span> <span class="p">:</span> <span class="n">mantissa</span> <span class="o">+=</span> <span class="n">groups</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span>
            <span class="n">significantDigits</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span> <span class="n">mantissa</span><span class="o">.</span><span class="n">lstrip</span><span class="p">(</span> <span class="s1">&#39;0&#39;</span> <span class="p">)</span> <span class="p">)</span>

        <span class="n">value</span><span class="p">,</span> <span class="n">order</span> <span class="o">=</span> <span class="n">PQU_float</span><span class="o">.</span><span class="n">fixFloatsOrder</span><span class="p">(</span> <span class="nb">float</span><span class="p">(</span> <span class="n">groups</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="p">)</span> <span class="p">)</span>
        <span class="k">return</span><span class="p">(</span> <span class="n">value</span><span class="p">,</span> <span class="n">order</span><span class="p">,</span> <span class="n">significantDigits</span><span class="p">,</span> <span class="n">significantDigitsForZero</span> <span class="p">)</span>

<div class="viewcode-block" id="Parsers.parsePQUString"><a class="viewcode-back" href="../../pqu/pqu.html#pqu.PQU.Parsers.parsePQUString">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">parsePQUString</span><span class="p">(</span> <span class="n">str1</span> <span class="p">)</span> <span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Parses the string str1 and returns the tuple ( value, unit, uncertainty ) where value is an instance of </span>
<span class="sd">        :py:class:`PQU_float`, unit is an instance of :py:class:`PhysicalUnit` and uncertainty is an instance </span>
<span class="sd">        of :py:class:`PQU_uncertainty`.</span>

<span class="sd">        The string can be one of the following :py:class:`PQU` forms. Here, F represents a valid float string, () represents</span>
<span class="sd">        the string &#39;(#)&#39; where &#39;#&#39; is a 1 or 2 digit number, +/- represents the string &#39;+/- F&#39;, % is itself</span>
<span class="sd">        and u is a unit.</span>

<span class="sd">        +----+----------+----------------+---------+---------------------+---------------------+------+</span>
<span class="sd">        |  # | Form     | Example        | Value   | Value - uncertainty | Value + uncertainty | Unit |</span>
<span class="sd">        +====+==========+================+=========+=====================+=====================+======+</span>
<span class="sd">        |  0 | F        | &#39;234&#39;          | 234.    | N/A                 | N/A                 | N/A  |</span>
<span class="sd">        +----+----------+----------------+---------+---------------------+---------------------+------+</span>
<span class="sd">        |  1 | F%       | &#39;234%&#39;         | 2.34    | N/A                 | N/A                 | N/A  |</span>
<span class="sd">        +----+----------+----------------+---------+---------------------+---------------------+------+</span>
<span class="sd">        |  2 | F u      | &#39;234 m&#39;        | 234.    | N/A                 | N/A                 | &#39;m&#39;  |</span>
<span class="sd">        +----+----------+----------------+---------+---------------------+---------------------+------+</span>
<span class="sd">        |  3 | F()      | &#39;234(5)&#39;       | 234.    | 229.                | 239.                | N/A  |</span>
<span class="sd">        +----+----------+----------------+---------+---------------------+---------------------+------+</span>
<span class="sd">        |  4 | F()%     | &#39;234(5)%&#39;      | 2.34    | 2.29                | 2.39                | N/A  |</span>
<span class="sd">        +----+----------+----------------+---------+---------------------+---------------------+------+</span>
<span class="sd">        |  5 | F() u    | &#39;234(5) m&#39;     | 234.    | 229.                | 239.                | &#39;m&#39;  |</span>
<span class="sd">        +----+----------+----------------+---------+---------------------+---------------------+------+</span>
<span class="sd">        |  6 | F +/-    | &#39;234 +/- 5&#39;    | 234.    | 229.                | 239.                | N/A  |</span>
<span class="sd">        +----+----------+----------------+---------+---------------------+---------------------+------+</span>
<span class="sd">        |  7 | F +/-%   | &#39;234 +/- 5%&#39;   | 234.    | 222.                | 246.                | N/A  |</span>
<span class="sd">        +----+----------+----------------+---------+---------------------+---------------------+------+</span>
<span class="sd">        |  8 | F +/- u  | &#39;234 +/- 5 m&#39;  | 234.    | 229.                | 239.                | &#39;m&#39;  |</span>
<span class="sd">        +----+----------+----------------+---------+---------------------+---------------------+------+</span>
<span class="sd">        |  9 | F +/-% u | &#39;234 +/- 5% m&#39; | 234.    | 222.                | 246.                | &#39;m&#39;  |</span>
<span class="sd">        +----+----------+----------------+---------+---------------------+---------------------+------+</span>
<span class="sd">        | 10 | (F +/-)% | &#39;(234 +/- 5)%&#39; | 2.34    | 2.29                | 2.39                | N/A  |</span>
<span class="sd">        +----+----------+----------------+---------+---------------------+---------------------+------+</span>

<span class="sd">        Note 1) 5% of 234 is 11.7 rounded to 12.</span>

<span class="sd">        :param str1: String to parse.</span>
<span class="sd">        :rtype: ( :py:class:`PQU_float`, :py:class:`PhysicalUnit`, :py:class:`PQU_uncertainty` )</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">str2</span><span class="p">,</span> <span class="n">form10</span><span class="p">,</span> <span class="n">isPercent</span> <span class="o">=</span> <span class="n">str1</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span> <span class="p">),</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span>
        <span class="k">if</span><span class="p">(</span> <span class="n">str2</span><span class="p">[:</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;(&quot;</span> <span class="p">)</span> <span class="p">:</span> <span class="n">form10</span><span class="p">,</span> <span class="n">str2</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">str2</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
        <span class="n">value</span><span class="p">,</span> <span class="n">significantDigitsForZero</span><span class="p">,</span> <span class="n">str2</span> <span class="o">=</span> <span class="n">Parsers</span><span class="o">.</span><span class="n">parseFloat</span><span class="p">(</span> <span class="n">str2</span><span class="p">,</span> <span class="n">str1</span> <span class="p">)</span>

        <span class="k">if</span><span class="p">(</span> <span class="n">form10</span> <span class="p">)</span> <span class="p">:</span>
            <span class="n">uncertainty</span><span class="p">,</span> <span class="n">str2</span> <span class="o">=</span> <span class="n">Parsers</span><span class="o">.</span><span class="n">parsePlusMinusUncertainty</span><span class="p">(</span> <span class="n">str2</span><span class="p">,</span> <span class="n">str1</span> <span class="p">)</span>
            <span class="n">uncertainty</span><span class="o">.</span><span class="n">value</span> <span class="o">*=</span> <span class="mf">0.01</span>
            <span class="n">str2</span> <span class="o">=</span> <span class="n">str2</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span> <span class="p">)</span>
            <span class="k">if</span><span class="p">(</span> <span class="n">str2</span> <span class="o">!=</span> <span class="s1">&#39;)%&#39;</span> <span class="p">)</span> <span class="p">:</span> <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span> <span class="s1">&#39;input not of the form &quot;(F +/- F)%&#39;</span> <span class="p">)</span>
            <span class="n">isPercent</span><span class="p">,</span> <span class="n">str2</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="s1">&#39;&#39;</span>
        <span class="k">else</span> <span class="p">:</span>
            <span class="n">uncertainty</span> <span class="o">=</span> <span class="n">PQU_uncertainty</span><span class="p">(</span> <span class="n">PQU_uncertainty</span><span class="o">.</span><span class="n">pqu_uncertaintyStyleNone</span> <span class="p">)</span>
            <span class="k">if</span><span class="p">(</span> <span class="n">str2</span><span class="p">[:</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;%&#39;</span> <span class="p">)</span> <span class="p">:</span>          <span class="c1"># The &#39;%&#39; must immediately follow the float string.</span>
                <span class="n">isPercent</span><span class="p">,</span> <span class="n">str2</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">str2</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
            <span class="k">else</span> <span class="p">:</span>
                <span class="n">str2</span> <span class="o">=</span> <span class="n">str2</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span> <span class="p">)</span>
                <span class="k">if</span><span class="p">(</span> <span class="n">str2</span><span class="p">[:</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;(&#39;</span> <span class="p">)</span> <span class="p">:</span>      <span class="c1"># Must be &#39;()&#39; style uncertainty.</span>
                    <span class="n">uncertainty</span><span class="p">,</span> <span class="n">str2</span> <span class="o">=</span> <span class="n">Parsers</span><span class="o">.</span><span class="n">parseParenthesisUncertainty</span><span class="p">(</span> <span class="n">str2</span><span class="p">,</span> <span class="n">str1</span> <span class="p">)</span>
                    <span class="k">if</span><span class="p">(</span> <span class="n">str2</span><span class="p">[:</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;%&#39;</span> <span class="p">)</span> <span class="p">:</span> <span class="n">isPercent</span><span class="p">,</span> <span class="n">str2</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">str2</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
                    <span class="k">if</span><span class="p">(</span> <span class="n">significantDigitsForZero</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">)</span> <span class="p">:</span> <span class="n">value</span><span class="o">.</span><span class="n">setSignificantDigits</span><span class="p">(</span> <span class="n">significantDigitsForZero</span> <span class="o">+</span> <span class="mi">1</span> <span class="p">)</span>
                <span class="k">elif</span><span class="p">(</span> <span class="n">str2</span><span class="p">[:</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;+&#39;</span> <span class="p">)</span> <span class="p">:</span>    <span class="c1"># Must be &#39;+/-&#39; style uncertainty.</span>
                    <span class="n">uncertainty</span><span class="p">,</span> <span class="n">str2</span> <span class="o">=</span> <span class="n">Parsers</span><span class="o">.</span><span class="n">parsePlusMinusUncertainty</span><span class="p">(</span> <span class="n">str2</span><span class="p">,</span> <span class="n">str1</span> <span class="p">)</span>
                    <span class="k">if</span><span class="p">(</span> <span class="n">str2</span><span class="p">[:</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;%&#39;</span> <span class="p">)</span> <span class="p">:</span>          <span class="c1"># The &#39;%&#39; must immediately follow the float string.</span>
                        <span class="n">str2</span> <span class="o">=</span> <span class="n">str2</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
                        <span class="n">uncertainty</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">setPercentFlag</span><span class="p">(</span> <span class="kc">True</span><span class="p">,</span> <span class="n">scaleValue</span> <span class="o">=</span> <span class="kc">True</span> <span class="p">)</span>

        <span class="n">str2</span> <span class="o">=</span> <span class="n">str2</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span> <span class="p">)</span>
        <span class="k">if</span><span class="p">(</span> <span class="n">isPercent</span> <span class="p">)</span> <span class="p">:</span>                   <span class="c1"># str2 must now be empty as units are not allowed with &quot;%&quot;.</span>
            <span class="k">if</span><span class="p">(</span> <span class="nb">len</span><span class="p">(</span> <span class="n">str2</span> <span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">)</span> <span class="p">:</span> <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span> <span class="s1">&#39;value with percent cannot have units: &quot;</span><span class="si">%s</span><span class="s1">&quot;&#39;</span> <span class="o">%</span> <span class="n">str1</span> <span class="p">)</span>
            <span class="n">value</span><span class="o">.</span><span class="n">setPercentFlag</span><span class="p">(</span> <span class="kc">True</span><span class="p">,</span> <span class="n">scaleValue</span> <span class="o">=</span> <span class="kc">True</span> <span class="p">)</span>
        <span class="k">try</span> <span class="p">:</span>
            <span class="n">unit</span> <span class="o">=</span> <span class="n">_findUnit</span><span class="p">(</span> <span class="n">str2</span> <span class="p">)</span>
        <span class="k">except</span> <span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span> <span class="s1">&#39;Invalid unit &quot;</span><span class="si">%s</span><span class="s1">&quot;, in PQU string &quot;</span><span class="si">%s</span><span class="s1">&quot;&#39;</span> <span class="o">%</span> <span class="p">(</span> <span class="n">str2</span><span class="p">,</span> <span class="n">str1</span> <span class="p">)</span> <span class="p">)</span>
        <span class="k">return</span><span class="p">(</span> <span class="n">value</span><span class="p">,</span> <span class="n">unit</span><span class="p">,</span> <span class="n">uncertainty</span> <span class="p">)</span></div></div>

<div class="viewcode-block" id="PhysicalUnit"><a class="viewcode-back" href="../../pqu/pqu.html#pqu.PQU.PhysicalUnit">[docs]</a><span class="k">class</span> <span class="nc">PhysicalUnit</span> <span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    .. rubric:: PHYSICAL UNIT</span>

<span class="sd">    A physical unit is defined by a symbol (possibly composite), a scaling factor, and</span>
<span class="sd">    the powers of each of the SI base units that enter into it. Units can be </span>
<span class="sd">    multiplied, divided, and raised to integer powers. This class is mainly for internal use.</span>

<span class="sd">    :param symbols: a dictionary mapping each symbol component to its associated integer</span>
<span class="sd">                power (e.g., ``{&#39;m&#39;: 1, &#39;s&#39;: -1}``) for `m/s`). As a shorthand, a string may be </span>
<span class="sd">                passed which is assigned an implicit power 1.</span>
<span class="sd">    :type symbols: `dict` or `str`</span>

<span class="sd">    :param factor: a scaling factor</span>
<span class="sd">    :type factor: `float`</span>

<span class="sd">    :param offset: an additive offset to the base unit (used only for temperatures)</span>
<span class="sd">    :type offset: `float`</span>

<span class="sd">    :param powers: the integer powers for each of the nine base units</span>
<span class="sd">    :type powers: `list` of `int`</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">symbols</span><span class="p">,</span> <span class="n">factor</span><span class="p">,</span> <span class="n">powers</span><span class="p">,</span> <span class="n">offset</span> <span class="o">=</span> <span class="mi">0</span> <span class="p">)</span> <span class="p">:</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        :param symbols: a dictionary mapping each symbol component to its associated integer</span>
<span class="sd">                    power (e.g., ``{&#39;m&#39;: 1, &#39;s&#39;: -1}``) for `m/s`). As a shorthand, a string may be </span>
<span class="sd">                    passed which is assigned an implicit power 1.</span>
<span class="sd">        :type symbols: `dict` or `str`</span>

<span class="sd">        :param factor: a scaling factor</span>
<span class="sd">        :type factor: `float`</span>

<span class="sd">        :param offset: an additive offset to the base unit (used only for temperatures)</span>
<span class="sd">        :type offset: `float`</span>

<span class="sd">        :param powers: the integer powers for each of the nine base units</span>
<span class="sd">        :type powers: `list` of `int`</span>
<span class="sd">        &#39;&#39;&#39;</span>

        <span class="k">if</span><span class="p">(</span> <span class="n">symbols</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">)</span> <span class="p">:</span>
            <span class="k">if</span><span class="p">(</span> <span class="s1">&#39;1&#39;</span> <span class="ow">in</span> <span class="n">symbols</span> <span class="p">)</span> <span class="p">:</span>
                <span class="n">rmOne</span> <span class="o">=</span> <span class="kc">False</span>
                <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">symbols</span><span class="p">:</span>
                    <span class="k">if</span><span class="p">(</span> <span class="n">symbols</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">)</span> <span class="p">:</span> <span class="n">rmOne</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="k">if</span><span class="p">(</span> <span class="n">rmOne</span> <span class="p">)</span> <span class="p">:</span> <span class="k">del</span> <span class="n">symbols</span><span class="p">[</span><span class="s1">&#39;1&#39;</span><span class="p">]</span>

        <span class="k">if</span><span class="p">(</span> <span class="nb">isinstance</span><span class="p">(</span> <span class="n">symbols</span><span class="p">,</span> <span class="nb">str</span> <span class="p">)</span> <span class="p">)</span> <span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">symbols</span> <span class="o">=</span> <span class="n">NumberDict</span><span class="p">(</span> <span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">symbols</span><span class="p">[</span><span class="n">symbols</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">else</span> <span class="p">:</span>
            <span class="k">if</span><span class="p">(</span> <span class="n">symbols</span> <span class="ow">is</span> <span class="kc">None</span> <span class="p">)</span> <span class="p">:</span> <span class="n">symbols</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">symbols</span> <span class="o">=</span> <span class="n">symbols</span>
        <span class="k">if</span><span class="p">(</span> <span class="s1">&#39;&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">symbols</span> <span class="p">)</span> <span class="p">:</span> <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">symbols</span><span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">factor</span> <span class="o">=</span> <span class="n">factor</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">offset</span> <span class="o">=</span> <span class="n">offset</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">powers</span> <span class="o">=</span> <span class="n">powers</span>

    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span> <span class="bp">self</span> <span class="p">)</span> <span class="p">:</span>

        <span class="k">return</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span> <span class="o">+</span> <span class="s2">&quot;(&#39;&quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">symbol</span><span class="p">(</span> <span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;&#39;)&quot;</span> <span class="p">)</span>

    <span class="k">def</span> <span class="fm">__hash__</span><span class="p">(</span> <span class="bp">self</span> <span class="p">)</span> <span class="p">:</span>

        <span class="k">return</span><span class="p">(</span> <span class="nb">hash</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">factor</span> <span class="p">)</span> <span class="o">+</span> <span class="nb">hash</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">offset</span> <span class="p">)</span> <span class="o">+</span> <span class="nb">hash</span><span class="p">(</span> <span class="nb">tuple</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">powers</span> <span class="p">)</span> <span class="p">)</span> <span class="p">)</span>

    <span class="k">def</span> <span class="fm">__lt__</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">other</span> <span class="p">)</span> <span class="p">:</span>

        <span class="k">if</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">powers</span> <span class="o">!=</span> <span class="n">other</span><span class="o">.</span><span class="n">powers</span> <span class="p">)</span> <span class="p">:</span> <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span> <span class="s1">&#39;Incompatible units&#39;</span> <span class="p">)</span>
        <span class="k">return</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">factor</span><span class="o">.</span><span class="fm">__lt__</span><span class="p">(</span> <span class="n">other</span><span class="o">.</span><span class="n">factor</span> <span class="p">)</span> <span class="p">)</span>

    <span class="k">def</span> <span class="fm">__eq__</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">other</span> <span class="p">)</span> <span class="p">:</span>

        <span class="k">if</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">powers</span> <span class="o">!=</span> <span class="n">other</span><span class="o">.</span><span class="n">powers</span> <span class="p">)</span> <span class="p">:</span> <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span> <span class="s1">&#39;Incompatible units&#39;</span> <span class="p">)</span>
        <span class="k">return</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">factor</span><span class="o">.</span><span class="fm">__eq__</span><span class="p">(</span> <span class="n">other</span><span class="o">.</span><span class="n">factor</span> <span class="p">)</span> <span class="p">)</span>

    <span class="k">def</span> <span class="fm">__ne__</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">other</span> <span class="p">)</span> <span class="p">:</span>

        <span class="k">if</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">powers</span> <span class="o">!=</span> <span class="n">other</span><span class="o">.</span><span class="n">powers</span> <span class="p">)</span> <span class="p">:</span> <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span> <span class="s1">&#39;Incompatible units&#39;</span> <span class="p">)</span>
        <span class="k">return</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">factor</span><span class="o">.</span><span class="fm">__ne__</span><span class="p">(</span> <span class="n">other</span><span class="o">.</span><span class="n">factor</span> <span class="p">)</span> <span class="p">)</span>

    <span class="k">def</span> <span class="fm">__mul__</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">other</span> <span class="p">)</span> <span class="p">:</span>

        <span class="k">if</span><span class="p">(</span> <span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">offset</span> <span class="o">!=</span> <span class="mi">0</span> <span class="p">)</span> <span class="ow">or</span> <span class="p">(</span> <span class="nb">isinstance</span><span class="p">(</span> <span class="n">other</span><span class="p">,</span> <span class="n">PhysicalUnit</span> <span class="p">)</span> <span class="ow">and</span> <span class="p">(</span> <span class="n">other</span><span class="o">.</span><span class="n">offset</span> <span class="o">!=</span> <span class="mi">0</span> <span class="p">)</span> <span class="p">)</span> <span class="p">)</span> <span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span> <span class="s2">&quot;cannot multiply units with non-zero offset&quot;</span> <span class="p">)</span>

        <span class="k">if</span><span class="p">(</span> <span class="nb">isinstance</span><span class="p">(</span> <span class="n">other</span><span class="p">,</span> <span class="n">PhysicalUnit</span> <span class="p">)</span> <span class="p">)</span> <span class="p">:</span>
            <span class="k">return</span><span class="p">(</span> <span class="n">PhysicalUnit</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">symbols</span> <span class="o">+</span> <span class="n">other</span><span class="o">.</span><span class="n">symbols</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">factor</span> <span class="o">*</span> <span class="n">other</span><span class="o">.</span><span class="n">factor</span><span class="p">,</span> <span class="nb">list</span><span class="p">(</span> <span class="nb">map</span><span class="p">(</span> <span class="k">lambda</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">:</span> <span class="n">a</span> <span class="o">+</span> <span class="n">b</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">powers</span><span class="p">,</span> <span class="n">other</span><span class="o">.</span><span class="n">powers</span> <span class="p">)</span> <span class="p">)</span> <span class="p">)</span> <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span><span class="p">(</span> <span class="n">PhysicalUnit</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">symbols</span> <span class="o">+</span> <span class="p">{</span> <span class="nb">str</span><span class="p">(</span> <span class="n">other</span> <span class="p">)</span> <span class="p">:</span> <span class="mi">1</span> <span class="p">},</span> <span class="bp">self</span><span class="o">.</span><span class="n">factor</span> <span class="o">*</span> <span class="n">other</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">powers</span> <span class="p">)</span> <span class="p">)</span>

    <span class="fm">__rmul__</span> <span class="o">=</span> <span class="fm">__mul__</span>

    <span class="k">def</span> <span class="fm">__truediv__</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">other</span> <span class="p">)</span> <span class="p">:</span>

        <span class="k">if</span><span class="p">(</span> <span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">offset</span> <span class="o">!=</span> <span class="mi">0</span> <span class="p">)</span> <span class="ow">or</span> <span class="p">(</span> <span class="nb">isinstance</span><span class="p">(</span> <span class="n">other</span><span class="p">,</span> <span class="n">PhysicalUnit</span> <span class="p">)</span> <span class="ow">and</span> <span class="p">(</span> <span class="n">other</span><span class="o">.</span><span class="n">offset</span> <span class="o">!=</span> <span class="mi">0</span> <span class="p">)</span> <span class="p">)</span> <span class="p">)</span> <span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span> <span class="s2">&quot; cannot divide units with non-zero offset&quot;</span> <span class="p">)</span>

        <span class="k">if</span><span class="p">(</span> <span class="nb">isinstance</span><span class="p">(</span> <span class="n">other</span><span class="p">,</span> <span class="n">PhysicalUnit</span> <span class="p">)</span> <span class="p">)</span> <span class="p">:</span>
            <span class="k">return</span><span class="p">(</span> <span class="n">PhysicalUnit</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">symbols</span> <span class="o">-</span> <span class="n">other</span><span class="o">.</span><span class="n">symbols</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">factor</span> <span class="o">/</span> <span class="n">other</span><span class="o">.</span><span class="n">factor</span><span class="p">,</span> <span class="nb">list</span><span class="p">(</span> <span class="nb">map</span><span class="p">(</span> <span class="k">lambda</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">:</span> <span class="n">a</span> <span class="o">-</span> <span class="n">b</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">powers</span><span class="p">,</span> <span class="n">other</span><span class="o">.</span><span class="n">powers</span> <span class="p">)</span> <span class="p">)</span> <span class="p">)</span> <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span><span class="p">(</span> <span class="n">PhysicalUnit</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">symbols</span> <span class="o">+</span> <span class="p">{</span> <span class="nb">str</span><span class="p">(</span> <span class="n">other</span> <span class="p">)</span> <span class="p">:</span> <span class="o">-</span><span class="mi">1</span> <span class="p">},</span> <span class="bp">self</span><span class="o">.</span><span class="n">factor</span> <span class="o">/</span> <span class="n">other</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">powers</span> <span class="p">)</span> <span class="p">)</span>

    <span class="k">def</span> <span class="fm">__rtruediv__</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">other</span> <span class="p">)</span> <span class="p">:</span>

        <span class="k">if</span><span class="p">(</span> <span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">offset</span> <span class="o">!=</span> <span class="mi">0</span> <span class="p">)</span> <span class="ow">or</span> <span class="p">(</span> <span class="nb">isinstance</span><span class="p">(</span> <span class="n">other</span><span class="p">,</span> <span class="n">PhysicalUnit</span> <span class="p">)</span> <span class="ow">and</span> <span class="p">(</span> <span class="n">other</span><span class="o">.</span><span class="n">offset</span> <span class="o">!=</span> <span class="mi">0</span> <span class="p">)</span> <span class="p">)</span> <span class="p">)</span> <span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span> <span class="s2">&quot;cannot divide units with non-zero offset&quot;</span> <span class="p">)</span>

        <span class="k">if</span><span class="p">(</span> <span class="nb">isinstance</span><span class="p">(</span> <span class="n">other</span><span class="p">,</span> <span class="n">PhysicalUnit</span> <span class="p">)</span> <span class="p">)</span> <span class="p">:</span>
            <span class="k">return</span><span class="p">(</span> <span class="n">PhysicalUnit</span><span class="p">(</span> <span class="n">other</span><span class="o">.</span><span class="n">symbols</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">symbols</span><span class="p">,</span> <span class="n">other</span><span class="o">.</span><span class="n">factor</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">factor</span><span class="p">,</span> <span class="nb">list</span><span class="p">(</span> <span class="nb">map</span><span class="p">(</span> <span class="k">lambda</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">:</span> <span class="n">a</span> <span class="o">-</span> <span class="n">b</span><span class="p">,</span> <span class="n">other</span><span class="o">.</span><span class="n">powers</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">powers</span> <span class="p">)</span> <span class="p">)</span> <span class="p">)</span> <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span><span class="p">(</span> <span class="n">PhysicalUnit</span><span class="p">(</span> <span class="n">NumberDict</span><span class="p">(</span> <span class="p">{</span> <span class="nb">str</span><span class="p">(</span> <span class="n">other</span> <span class="p">)</span> <span class="p">:</span> <span class="mi">1</span> <span class="p">}</span> <span class="p">)</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">symbols</span><span class="p">,</span> <span class="n">other</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">factor</span><span class="p">,</span> <span class="p">[</span> <span class="o">-</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">powers</span> <span class="p">]</span> <span class="p">)</span> <span class="p">)</span>

    <span class="n">__div__</span> <span class="o">=</span> <span class="fm">__truediv__</span>   <span class="c1"># for python 2.x</span>
    <span class="n">__rdiv__</span> <span class="o">=</span> <span class="fm">__rtruediv__</span>

    <span class="k">def</span> <span class="fm">__pow__</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">other</span> <span class="p">)</span> <span class="p">:</span>

        <span class="k">if</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">offset</span> <span class="o">!=</span> <span class="mi">0</span> <span class="p">)</span> <span class="p">:</span> <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span> <span class="s2">&quot;cannot exponentiate units with non-zero offset&quot;</span> <span class="p">)</span>

        <span class="k">if</span><span class="p">(</span> <span class="ow">not</span><span class="p">(</span> <span class="nb">isinstance</span><span class="p">(</span> <span class="n">other</span><span class="p">,</span> <span class="nb">int</span> <span class="p">)</span> <span class="p">)</span> <span class="p">)</span> <span class="p">:</span>                     <span class="c1"># See if very close to an integer.</span>
            <span class="n">power</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span> <span class="n">other</span> <span class="p">)</span>
            <span class="n">rounded</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span> <span class="n">math</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span> <span class="n">power</span> <span class="o">+</span> <span class="mf">0.5</span> <span class="p">)</span> <span class="p">)</span>
            <span class="k">if</span><span class="p">(</span> <span class="nb">abs</span><span class="p">(</span> <span class="n">power</span> <span class="o">-</span> <span class="n">rounded</span> <span class="p">)</span> <span class="o">&lt;</span> <span class="mf">1.e-14</span> <span class="p">)</span> <span class="p">:</span> <span class="n">other</span> <span class="o">=</span> <span class="n">rounded</span> <span class="c1"># If not close, revert back to non-int so handled as inverse later.</span>
        <span class="k">if</span><span class="p">(</span> <span class="nb">isinstance</span><span class="p">(</span> <span class="n">other</span><span class="p">,</span> <span class="nb">int</span> <span class="p">)</span> <span class="p">)</span> <span class="p">:</span>
            <span class="k">return</span><span class="p">(</span> <span class="n">PhysicalUnit</span><span class="p">(</span> <span class="n">other</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">symbols</span><span class="p">,</span> <span class="nb">pow</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">factor</span><span class="p">,</span> <span class="n">other</span> <span class="p">),</span> <span class="nb">list</span><span class="p">(</span> <span class="nb">map</span><span class="p">(</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">p</span> <span class="o">=</span> <span class="n">other</span><span class="p">:</span> <span class="n">x</span> <span class="o">*</span> <span class="n">p</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">powers</span> <span class="p">)</span> <span class="p">)</span> <span class="p">)</span> <span class="p">)</span>

        <span class="k">if</span><span class="p">(</span> <span class="nb">isinstance</span><span class="p">(</span> <span class="n">other</span><span class="p">,</span> <span class="nb">float</span> <span class="p">)</span> <span class="p">)</span> <span class="p">:</span>                          <span class="c1"># See if inverse (e.g., 1. / 3.)</span>
            <span class="n">inv_exp</span> <span class="o">=</span> <span class="mf">1.</span> <span class="o">/</span> <span class="n">other</span>
            <span class="n">rounded</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span> <span class="n">math</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span> <span class="n">inv_exp</span> <span class="o">+</span> <span class="mf">0.5</span> <span class="p">)</span> <span class="p">)</span>

            <span class="k">if</span><span class="p">(</span> <span class="nb">abs</span><span class="p">(</span> <span class="n">inv_exp</span><span class="o">-</span><span class="n">rounded</span> <span class="p">)</span> <span class="o">&lt;</span> <span class="mf">1.e-10</span> <span class="p">)</span> <span class="p">:</span>
                <span class="k">if</span> <span class="n">reduce</span><span class="p">(</span> <span class="k">lambda</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">:</span> <span class="n">a</span> <span class="ow">and</span> <span class="n">b</span><span class="p">,</span> <span class="nb">list</span><span class="p">(</span> <span class="nb">map</span><span class="p">(</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">e</span> <span class="o">=</span> <span class="n">rounded</span><span class="p">:</span> <span class="n">x</span> <span class="o">%</span> <span class="n">e</span> <span class="o">==</span> <span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">powers</span> <span class="p">)</span> <span class="p">)</span> <span class="p">)</span> <span class="p">:</span>
                    <span class="n">f</span> <span class="o">=</span> <span class="nb">pow</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">factor</span><span class="p">,</span> <span class="n">other</span> <span class="p">)</span>
                    <span class="n">p</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span> <span class="nb">map</span><span class="p">(</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">p</span> <span class="o">=</span> <span class="n">rounded</span><span class="p">:</span> <span class="n">x</span> <span class="o">/</span> <span class="n">p</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">powers</span> <span class="p">)</span> <span class="p">)</span>

                    <span class="k">if</span> <span class="n">reduce</span><span class="p">(</span> <span class="k">lambda</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">:</span> <span class="n">a</span> <span class="ow">and</span> <span class="n">b</span><span class="p">,</span> <span class="nb">list</span><span class="p">(</span> <span class="nb">map</span><span class="p">(</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">e</span> <span class="o">=</span> <span class="n">rounded</span><span class="p">:</span> <span class="n">x</span> <span class="o">%</span> <span class="n">e</span> <span class="o">==</span> <span class="mi">0</span><span class="p">,</span> <span class="nb">list</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">symbols</span><span class="o">.</span><span class="n">values</span><span class="p">(</span> <span class="p">)</span> <span class="p">)</span> <span class="p">)</span> <span class="p">)</span> <span class="p">)</span> <span class="p">:</span>
                        <span class="n">symbols</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">symbols</span> <span class="o">/</span> <span class="n">rounded</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">symbols</span> <span class="o">=</span> <span class="n">NumberDict</span><span class="p">(</span> <span class="p">)</span>

                        <span class="k">if</span> <span class="n">f</span> <span class="o">!=</span> <span class="mf">1.</span><span class="p">:</span>
                            <span class="n">symbols</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span> <span class="n">f</span> <span class="p">)]</span> <span class="o">=</span> <span class="mi">1</span>

                        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span> <span class="nb">len</span><span class="p">(</span> <span class="n">p</span> <span class="p">)</span> <span class="p">)</span> <span class="p">:</span>
                            <span class="n">symbols</span><span class="p">[</span><span class="n">_base_symbols</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>

                    <span class="k">return</span> <span class="n">PhysicalUnit</span><span class="p">(</span> <span class="n">symbols</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">p</span> <span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span> <span class="s1">&#39;Illegal exponent&#39;</span> <span class="p">)</span>

        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span> <span class="s1">&#39;Only integer and inverse integer exponents are allowed&#39;</span> <span class="p">)</span>

<div class="viewcode-block" id="PhysicalUnit.conversionFactorTo"><a class="viewcode-back" href="../../pqu/pqu.html#pqu.PQU.PhysicalUnit.conversionFactorTo">[docs]</a>    <span class="k">def</span> <span class="nf">conversionFactorTo</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">,</span> <span class="n">ignoreTemperatureOffsets</span> <span class="o">=</span> <span class="kc">False</span> <span class="p">)</span> <span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a float factor that can be used to scale a value in unit of *self* to unit of *other*.</span>

<span class="sd">        :param other: another unit</span>
<span class="sd">        :type other: :py:class:`PhysicalUnit`</span>
<span class="sd">        :returns: the conversion factor from this unit to another unit</span>
<span class="sd">        :rtype: `float`</span>
<span class="sd">        :raises TypeError: if the units are not compatible</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">other</span> <span class="o">=</span> <span class="n">_getPhysicalUnit</span><span class="p">(</span> <span class="n">other</span> <span class="p">)</span>
        <span class="k">if</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">powers</span> <span class="o">!=</span> <span class="n">other</span><span class="o">.</span><span class="n">powers</span> <span class="p">)</span> <span class="p">:</span> <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span> <span class="s1">&#39;Incompatible units: cannot convert &quot;</span><span class="si">%s</span><span class="s1">&quot; to &quot;</span><span class="si">%s</span><span class="s1">&quot;&#39;</span> <span class="o">%</span> <span class="p">(</span> <span class="nb">str</span><span class="p">(</span> <span class="bp">self</span> <span class="p">),</span> <span class="nb">str</span><span class="p">(</span> <span class="n">other</span> <span class="p">)</span> <span class="p">)</span> <span class="p">)</span>

        <span class="k">if</span><span class="p">(</span> <span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">offset</span> <span class="o">!=</span> <span class="n">other</span><span class="o">.</span><span class="n">offset</span> <span class="p">)</span> <span class="ow">and</span> <span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">factor</span> <span class="o">!=</span> <span class="n">other</span><span class="o">.</span><span class="n">factor</span> <span class="p">)</span> <span class="p">)</span> <span class="p">:</span>
            <span class="k">if</span> <span class="n">ignoreTemperatureOffsets</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">powers</span> <span class="o">!=</span> <span class="n">_unit_table</span><span class="p">[</span><span class="s1">&#39;K&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">powers</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span> <span class="s1">&#39;Unit conversion (</span><span class="si">%s</span><span class="s1"> to </span><span class="si">%s</span><span class="s1">) cannot be expressed as a simple multiplicative factor&#39;</span> <span class="o">%</span> <span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">symbol</span><span class="p">(</span> <span class="p">),</span> <span class="n">other</span><span class="o">.</span><span class="n">symbol</span><span class="p">(</span> <span class="p">)</span> <span class="p">)</span> <span class="p">)</span>

        <span class="k">if</span> <span class="n">math</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">factor</span> <span class="p">)</span><span class="o">.</span><span class="n">is_integer</span><span class="p">()</span> <span class="ow">and</span> <span class="n">math</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span> <span class="n">other</span><span class="o">.</span><span class="n">factor</span> <span class="p">)</span><span class="o">.</span><span class="n">is_integer</span><span class="p">():</span>
            <span class="c1"># special treatment to reduce numeric error in order-of-magnitude conversions</span>
            <span class="k">return</span> <span class="mi">10</span><span class="o">**</span><span class="p">(</span> <span class="n">math</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">factor</span> <span class="p">)</span> <span class="o">-</span> <span class="n">math</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span> <span class="n">other</span><span class="o">.</span><span class="n">factor</span> <span class="p">)</span> <span class="p">)</span>

        <span class="k">return</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">factor</span> <span class="o">/</span> <span class="n">other</span><span class="o">.</span><span class="n">factor</span> <span class="p">)</span></div>

<div class="viewcode-block" id="PhysicalUnit.conversionTupleTo"><a class="viewcode-back" href="../../pqu/pqu.html#pqu.PQU.PhysicalUnit.conversionTupleTo">[docs]</a>    <span class="k">def</span> <span class="nf">conversionTupleTo</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">other</span> <span class="p">)</span> <span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the tuple (factor, offset) that can be used to convert a value in unit of *self* to unit of *other*.</span>
<span class="sd">        Offset is 0.0 except with convert some temperature units.</span>

<span class="sd">        :param other: another unit</span>
<span class="sd">        :type other: :py:class:`PhysicalUnit`</span>
<span class="sd">        :returns: the conversion factor and offset from this unit to another unit</span>
<span class="sd">        :rtype: (`float`, `float`)</span>
<span class="sd">        :raises TypeError: if the units are not compatible</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">other_</span> <span class="o">=</span> <span class="n">_getPhysicalUnit</span><span class="p">(</span> <span class="n">other</span> <span class="p">)</span>
        <span class="k">if</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">powers</span> <span class="o">!=</span> <span class="n">other_</span><span class="o">.</span><span class="n">powers</span> <span class="p">)</span> <span class="p">:</span> <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span> <span class="s1">&#39;Unit &quot;</span><span class="si">%s</span><span class="s1">&quot; not convertible with &quot;</span><span class="si">%s</span><span class="s1">&quot;&#39;</span> <span class="o">%</span> <span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">other</span> <span class="p">)</span> <span class="p">)</span>

        <span class="c1"># Let (s1,d1) be the conversion tuple from &#39;self&#39; to base units (i.e. (x+d1)*s1 converts a value x from &#39;self&#39; to base units, </span>
        <span class="c1"># and (x/s1)-d1 converts x from base to &#39;self&#39; units) and (s2,d2) be the conversion tuple from &#39;other&#39; to base units then </span>
        <span class="c1"># we want to compute the conversion tuple (S,D) from &#39;self&#39; to &#39;other&#39; such that (x+D)*S converts x from &#39;self&#39; units to </span>
        <span class="c1"># &#39;other&#39; units the formula to convert x from &#39;self&#39; to &#39;other&#39; units via the base units is (by definition of the conversion tuples):</span>
        <span class="c1">#    ( ((x+d1)*s1) / s2 ) - d2</span>
        <span class="c1">#  = ( (x+d1) * s1/s2) - d2</span>
        <span class="c1">#  = ( (x+d1) * s1/s2 ) - (d2*s2/s1) * s1/s2</span>
        <span class="c1">#  = ( (x+d1) - (d1*s2/s1) ) * s1/s2</span>
        <span class="c1">#  = (x + d1 - d2*s2/s1) * s1/s2</span>
        <span class="c1"># thus, D = d1 - d2*s2/s1 and S = s1/s2</span>

        <span class="n">factor</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">conversionFactorTo</span><span class="p">(</span> <span class="n">other_</span> <span class="p">)</span>
        <span class="n">offset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">offset</span> <span class="o">-</span> <span class="p">(</span> <span class="n">other_</span><span class="o">.</span><span class="n">offset</span> <span class="o">*</span> <span class="n">other_</span><span class="o">.</span><span class="n">factor</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">factor</span> <span class="p">)</span>
        <span class="k">return</span><span class="p">(</span> <span class="n">factor</span><span class="p">,</span> <span class="n">offset</span> <span class="p">)</span></div>

<div class="viewcode-block" id="PhysicalUnit.isCompatible"><a class="viewcode-back" href="../../pqu/pqu.html#pqu.PQU.PhysicalUnit.isCompatible">[docs]</a>    <span class="k">def</span> <span class="nf">isCompatible</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">other</span> <span class="p">)</span> <span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns **True** if *self* is compatible with other and **False** otherwise.</span>

<span class="sd">        :param other: another unit</span>
<span class="sd">        :type other: :py:class:`PhysicalUnit`</span>
<span class="sd">        :returns: **True** if the units are compatible, i.e. if the powers of the base units are the same</span>
<span class="sd">        :rtype: `bool`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">powers</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">powers</span> <span class="p">)</span></div>

<div class="viewcode-block" id="PhysicalUnit.isDimensionless"><a class="viewcode-back" href="../../pqu/pqu.html#pqu.PQU.PhysicalUnit.isDimensionless">[docs]</a>    <span class="k">def</span> <span class="nf">isDimensionless</span><span class="p">(</span> <span class="bp">self</span> <span class="p">)</span> <span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns **True** if *self* is dimensionless and **False** otherwise.</span>

<span class="sd">        :rtype: `bool`</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span><span class="p">(</span> <span class="ow">not</span> <span class="n">reduce</span><span class="p">(</span> <span class="k">lambda</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">:</span> <span class="n">a</span> <span class="ow">or</span> <span class="n">b</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">powers</span> <span class="p">)</span> <span class="p">)</span></div>

<div class="viewcode-block" id="PhysicalUnit.isAngle"><a class="viewcode-back" href="../../pqu/pqu.html#pqu.PQU.PhysicalUnit.isAngle">[docs]</a>    <span class="k">def</span> <span class="nf">isAngle</span><span class="p">(</span> <span class="bp">self</span> <span class="p">)</span> <span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns **True** if *self* is an angle and **False** otherwise.</span>

<span class="sd">        :rtype: `bool`</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">powers</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">reduce</span><span class="p">(</span> <span class="k">lambda</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">:</span> <span class="n">a</span> <span class="o">+</span> <span class="n">b</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">powers</span> <span class="p">)</span> <span class="o">==</span> <span class="mi">1</span></div>

<div class="viewcode-block" id="PhysicalUnit.setSymbol"><a class="viewcode-back" href="../../pqu/pqu.html#pqu.PQU.PhysicalUnit.setSymbol">[docs]</a>    <span class="k">def</span> <span class="nf">setSymbol</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">symbol</span> <span class="p">)</span> <span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Sets *self*&#39;s symbols to symbol with power 1.</span>

<span class="sd">        :param symbol: </span>
<span class="sd">        :type symbol: `str`</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">symbols</span> <span class="o">=</span> <span class="n">NumberDict</span><span class="p">(</span> <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">symbols</span><span class="p">[</span><span class="n">symbol</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span></div>

<div class="viewcode-block" id="PhysicalUnit.simplifyUnitsFactor"><a class="viewcode-back" href="../../pqu/pqu.html#pqu.PQU.PhysicalUnit.simplifyUnitsFactor">[docs]</a>    <span class="k">def</span> <span class="nf">simplifyUnitsFactor</span><span class="p">(</span> <span class="bp">self</span> <span class="p">)</span> <span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This method returns a :py:class:`PQU` instance that can be used to simplify *self*&#39;s units.</span>
<span class="sd">        That is, all units with the same base units are reduced to a single unit. For example,</span>
<span class="sd">        if *self* has units of &#39;km/m&#39; then the returned :py:class:`PQU` is equivalent to &#39;1e3 m/km&#39;.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">ignores</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">PQU</span><span class="p">(</span> <span class="mi">1</span> <span class="p">)</span>
        <span class="n">keys</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">symbols</span><span class="o">.</span><span class="n">keys</span><span class="p">(</span> <span class="p">)</span> <span class="p">)</span>
        <span class="k">for</span> <span class="n">i1</span><span class="p">,</span> <span class="n">key</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span> <span class="n">keys</span> <span class="p">)</span> <span class="p">:</span>
            <span class="k">if</span><span class="p">(</span> <span class="n">i1</span> <span class="ow">in</span> <span class="n">ignores</span> <span class="p">)</span> <span class="p">:</span> <span class="k">continue</span>
            <span class="n">ignores</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="n">i1</span> <span class="p">)</span>
            <span class="n">u1</span> <span class="o">=</span> <span class="n">PQU</span><span class="p">(</span> <span class="mi">1</span><span class="p">,</span> <span class="n">key</span> <span class="p">)</span>
            <span class="k">for</span> <span class="n">i2</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span> <span class="n">i1</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span> <span class="n">keys</span> <span class="p">)</span> <span class="p">)</span> <span class="p">:</span>
                <span class="k">if</span><span class="p">(</span> <span class="n">i2</span> <span class="ow">in</span> <span class="n">ignores</span> <span class="p">)</span> <span class="p">:</span> <span class="k">continue</span>
                <span class="k">if</span><span class="p">(</span> <span class="n">u1</span><span class="o">.</span><span class="n">isCompatible</span><span class="p">(</span> <span class="n">keys</span><span class="p">[</span><span class="n">i2</span><span class="p">]</span> <span class="p">)</span> <span class="p">)</span> <span class="p">:</span>
                    <span class="n">ignores</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="n">i2</span> <span class="p">)</span>
                    <span class="n">power2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">symbols</span><span class="p">[</span><span class="n">keys</span><span class="p">[</span><span class="n">i2</span><span class="p">]]</span>
                    <span class="n">factor</span> <span class="o">=</span> <span class="n">PQU</span><span class="p">(</span> <span class="mi">1</span><span class="p">,</span> <span class="n">keys</span><span class="p">[</span><span class="n">i2</span><span class="p">]</span> <span class="p">)</span><span class="o">.</span><span class="n">getValueAs</span><span class="p">(</span> <span class="n">key</span> <span class="p">)</span><span class="o">**</span><span class="n">power2</span>
                    <span class="n">result</span> <span class="o">*=</span> <span class="n">factor</span> <span class="o">*</span> <span class="n">PQU</span><span class="p">(</span> <span class="mi">1</span><span class="p">,</span> <span class="n">key</span> <span class="p">)</span><span class="o">**</span><span class="n">power2</span> <span class="o">/</span> <span class="n">PQU</span><span class="p">(</span> <span class="mi">1</span><span class="p">,</span> <span class="n">keys</span><span class="p">[</span><span class="n">i2</span><span class="p">]</span> <span class="p">)</span><span class="o">**</span><span class="n">power2</span>
        <span class="k">return</span><span class="p">(</span> <span class="n">result</span> <span class="p">)</span></div>

<div class="viewcode-block" id="PhysicalUnit.symbol"><a class="viewcode-back" href="../../pqu/pqu.html#pqu.PQU.PhysicalUnit.symbol">[docs]</a>    <span class="k">def</span> <span class="nf">symbol</span><span class="p">(</span> <span class="bp">self</span> <span class="p">)</span> <span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a string representation of *self*.</span>

<span class="sd">        :returns: a string representation of *self*.</span>
<span class="sd">        :rtype: `str`</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">num</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="n">denom</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>

        <span class="k">for</span> <span class="n">unit</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">symbols</span> <span class="p">:</span>
            <span class="n">power</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">symbols</span><span class="p">[</span><span class="n">unit</span><span class="p">]</span>

            <span class="k">if</span><span class="p">(</span> <span class="n">power</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="p">)</span> <span class="p">:</span>
                <span class="n">denom</span> <span class="o">=</span> <span class="n">denom</span> <span class="o">+</span> <span class="s1">&#39;/&#39;</span> <span class="o">+</span> <span class="n">unit</span>
                <span class="k">if</span><span class="p">(</span> <span class="n">power</span> <span class="o">&lt;</span> <span class="o">-</span><span class="mi">1</span> <span class="p">)</span> <span class="p">:</span> <span class="n">denom</span> <span class="o">=</span> <span class="n">denom</span> <span class="o">+</span> <span class="s1">&#39;**&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span> <span class="o">-</span><span class="n">power</span> <span class="p">)</span>
            <span class="k">elif</span><span class="p">(</span> <span class="n">power</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">)</span> <span class="p">:</span>
                <span class="n">num</span> <span class="o">=</span> <span class="n">num</span> <span class="o">+</span> <span class="s1">&#39;*&#39;</span> <span class="o">+</span> <span class="n">unit</span>
                <span class="k">if</span><span class="p">(</span> <span class="n">power</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="p">)</span> <span class="p">:</span> <span class="n">num</span> <span class="o">=</span> <span class="n">num</span> <span class="o">+</span> <span class="s1">&#39;**&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span> <span class="n">power</span> <span class="p">)</span>

        <span class="k">if</span><span class="p">(</span> <span class="nb">len</span><span class="p">(</span> <span class="n">num</span> <span class="p">)</span> <span class="o">==</span> <span class="mi">0</span> <span class="p">)</span> <span class="p">:</span>
            <span class="k">if</span><span class="p">(</span> <span class="nb">len</span><span class="p">(</span> <span class="n">denom</span> <span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">)</span> <span class="p">:</span> <span class="n">num</span> <span class="o">=</span> <span class="s1">&#39;1&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">num</span> <span class="o">=</span> <span class="n">num</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>

        <span class="k">return</span> <span class="n">num</span> <span class="o">+</span> <span class="n">denom</span></div>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span> <span class="bp">self</span> <span class="p">)</span> <span class="p">:</span>

        <span class="k">return</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">symbol</span><span class="p">(</span> <span class="p">)</span> <span class="p">)</span></div>
<span class="c1">#</span>
<span class="c1"># Helper functions</span>
<span class="c1">#</span>
<span class="k">def</span> <span class="nf">_findUnit</span><span class="p">(</span> <span class="n">unit</span> <span class="p">)</span> <span class="p">:</span>

    <span class="k">if</span><span class="p">(</span> <span class="nb">isinstance</span><span class="p">(</span> <span class="n">unit</span><span class="p">,</span> <span class="nb">str</span> <span class="p">)</span> <span class="p">)</span> <span class="p">:</span>
        <span class="n">symbol</span> <span class="o">=</span> <span class="n">unit</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span> <span class="p">)</span>

        <span class="k">if</span><span class="p">(</span> <span class="n">symbol</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span> <span class="p">)</span> <span class="p">:</span>
            <span class="n">unit</span> <span class="o">=</span> <span class="n">_unit_table</span><span class="p">[</span><span class="n">symbol</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">unit</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span> <span class="n">symbol</span><span class="p">,</span> <span class="n">_unit_table</span> <span class="p">)</span>

        <span class="k">for</span> <span class="n">cruft</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;__builtins__&#39;</span><span class="p">,</span> <span class="s1">&#39;__args__&#39;</span><span class="p">]</span> <span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">del</span> <span class="n">_unit_table</span><span class="p">[</span><span class="n">cruft</span><span class="p">]</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="k">pass</span>

    <span class="k">if</span><span class="p">(</span> <span class="ow">not</span><span class="p">(</span> <span class="nb">isinstance</span><span class="p">(</span> <span class="n">unit</span><span class="p">,</span> <span class="n">PhysicalUnit</span> <span class="p">)</span> <span class="p">)</span> <span class="p">)</span> <span class="p">:</span> <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span> <span class="s1">&#39;</span><span class="si">%s</span><span class="s1"> is not a unit&#39;</span> <span class="o">%</span> <span class="nb">type</span><span class="p">(</span> <span class="n">unit</span> <span class="p">)</span> <span class="p">)</span>
    <span class="k">return</span><span class="p">(</span> <span class="n">unit</span> <span class="p">)</span>

<span class="k">def</span> <span class="nf">_round</span><span class="p">(</span> <span class="n">x</span> <span class="p">)</span> <span class="p">:</span>

    <span class="k">if</span><span class="p">(</span> <span class="n">x</span> <span class="o">&gt;</span> <span class="mf">0.</span> <span class="p">)</span> <span class="p">:</span>
        <span class="n">x_</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span> <span class="n">x</span> <span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">x_</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span> <span class="n">x</span> <span class="p">)</span>
    <span class="k">if</span><span class="p">(</span> <span class="nb">isinstance</span><span class="p">(</span> <span class="n">x</span><span class="p">,</span> <span class="n">PQU_float</span> <span class="p">)</span> <span class="p">)</span> <span class="p">:</span> <span class="n">x_</span> <span class="o">=</span> <span class="n">PQU_float</span><span class="p">(</span> <span class="n">x_</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">getSignificantDigits</span><span class="p">(</span> <span class="p">)</span> <span class="p">)</span>
    <span class="k">return</span><span class="p">(</span> <span class="n">x_</span> <span class="p">)</span>

<span class="k">def</span> <span class="nf">_getPhysicalUnit</span><span class="p">(</span> <span class="n">elf</span> <span class="p">)</span> <span class="p">:</span>

    <span class="k">if</span><span class="p">(</span> <span class="nb">isinstance</span><span class="p">(</span> <span class="n">elf</span><span class="p">,</span> <span class="n">PQU</span> <span class="p">)</span> <span class="p">)</span> <span class="p">:</span> <span class="k">return</span><span class="p">(</span> <span class="n">elf</span><span class="o">.</span><span class="n">unit</span> <span class="p">)</span>
    <span class="k">try</span> <span class="p">:</span>
        <span class="k">return</span><span class="p">(</span> <span class="n">_findUnit</span><span class="p">(</span> <span class="n">elf</span> <span class="p">)</span> <span class="p">)</span>
    <span class="k">except</span> <span class="p">:</span>
        <span class="k">return</span><span class="p">(</span> <span class="n">PQU</span><span class="p">(</span> <span class="n">elf</span> <span class="p">)</span><span class="o">.</span><span class="n">unit</span> <span class="p">)</span>

<span class="c1"># SI unit definitions</span>

<span class="n">_base_symbols</span> <span class="o">=</span> <span class="p">[</span> <span class="s1">&#39;m&#39;</span><span class="p">,</span> <span class="s1">&#39;kg&#39;</span><span class="p">,</span> <span class="s1">&#39;s&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;K&#39;</span><span class="p">,</span> <span class="s1">&#39;mol&#39;</span><span class="p">,</span> <span class="s1">&#39;cd&#39;</span><span class="p">,</span> <span class="s1">&#39;rad&#39;</span><span class="p">,</span> <span class="s1">&#39;sr&#39;</span> <span class="p">]</span>

<span class="n">_base_units</span> <span class="o">=</span> <span class="p">[</span> <span class="p">(</span> <span class="s1">&#39;m&#39;</span><span class="p">,</span>   <span class="n">PhysicalUnit</span><span class="p">(</span> <span class="s1">&#39;m&#39;</span><span class="p">,</span>   <span class="mf">1.</span><span class="p">,</span>    <span class="p">[</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span> <span class="p">]</span> <span class="p">)</span> <span class="p">),</span>
                <span class="p">(</span> <span class="s1">&#39;g&#39;</span><span class="p">,</span>   <span class="n">PhysicalUnit</span><span class="p">(</span> <span class="s1">&#39;g&#39;</span><span class="p">,</span>   <span class="mf">0.001</span><span class="p">,</span> <span class="p">[</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span> <span class="p">]</span> <span class="p">)</span> <span class="p">),</span>
                <span class="p">(</span> <span class="s1">&#39;s&#39;</span><span class="p">,</span>   <span class="n">PhysicalUnit</span><span class="p">(</span> <span class="s1">&#39;s&#39;</span><span class="p">,</span>   <span class="mf">1.</span><span class="p">,</span>    <span class="p">[</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span> <span class="p">]</span> <span class="p">)</span> <span class="p">),</span>
                <span class="p">(</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span>   <span class="n">PhysicalUnit</span><span class="p">(</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span>   <span class="mf">1.</span><span class="p">,</span>    <span class="p">[</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span> <span class="p">]</span> <span class="p">)</span> <span class="p">),</span>
                <span class="p">(</span> <span class="s1">&#39;K&#39;</span><span class="p">,</span>   <span class="n">PhysicalUnit</span><span class="p">(</span> <span class="s1">&#39;K&#39;</span><span class="p">,</span>   <span class="mf">1.</span><span class="p">,</span>    <span class="p">[</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span> <span class="p">]</span> <span class="p">)</span> <span class="p">),</span>
                <span class="p">(</span> <span class="s1">&#39;mol&#39;</span><span class="p">,</span> <span class="n">PhysicalUnit</span><span class="p">(</span> <span class="s1">&#39;mol&#39;</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span>    <span class="p">[</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span> <span class="p">]</span> <span class="p">)</span> <span class="p">),</span>
                <span class="p">(</span> <span class="s1">&#39;cd&#39;</span><span class="p">,</span>  <span class="n">PhysicalUnit</span><span class="p">(</span> <span class="s1">&#39;cd&#39;</span><span class="p">,</span>  <span class="mf">1.</span><span class="p">,</span>    <span class="p">[</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span> <span class="p">]</span> <span class="p">)</span> <span class="p">),</span>
                <span class="p">(</span> <span class="s1">&#39;rad&#39;</span><span class="p">,</span> <span class="n">PhysicalUnit</span><span class="p">(</span> <span class="s1">&#39;rad&#39;</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span>    <span class="p">[</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span> <span class="p">]</span> <span class="p">)</span> <span class="p">),</span>
                <span class="p">(</span> <span class="s1">&#39;sr&#39;</span><span class="p">,</span>  <span class="n">PhysicalUnit</span><span class="p">(</span> <span class="s1">&#39;sr&#39;</span><span class="p">,</span>  <span class="mf">1.</span><span class="p">,</span>    <span class="p">[</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span> <span class="p">]</span> <span class="p">)</span> <span class="p">),</span>
              <span class="p">]</span>

<span class="n">_prefixes</span> <span class="o">=</span> <span class="p">[(</span> <span class="s1">&#39;Y&#39;</span><span class="p">,</span>  <span class="mf">1.e24</span><span class="p">,</span> <span class="s1">&#39;yotta&#39;</span> <span class="p">),</span>
             <span class="p">(</span> <span class="s1">&#39;Z&#39;</span><span class="p">,</span>  <span class="mf">1.e21</span><span class="p">,</span> <span class="s1">&#39;zetta&#39;</span> <span class="p">),</span>
             <span class="p">(</span> <span class="s1">&#39;E&#39;</span><span class="p">,</span>  <span class="mf">1.e18</span><span class="p">,</span> <span class="s1">&#39;exa&#39;</span> <span class="p">),</span>
             <span class="p">(</span> <span class="s1">&#39;P&#39;</span><span class="p">,</span>  <span class="mf">1.e15</span><span class="p">,</span> <span class="s1">&#39;peta&#39;</span> <span class="p">),</span>
             <span class="p">(</span> <span class="s1">&#39;T&#39;</span><span class="p">,</span>  <span class="mf">1.e12</span><span class="p">,</span> <span class="s1">&#39;tera&#39;</span> <span class="p">),</span>
             <span class="p">(</span> <span class="s1">&#39;G&#39;</span><span class="p">,</span>  <span class="mf">1.e9</span><span class="p">,</span> <span class="s1">&#39;giga&#39;</span> <span class="p">),</span>
             <span class="p">(</span> <span class="s1">&#39;M&#39;</span><span class="p">,</span>  <span class="mf">1.e6</span><span class="p">,</span> <span class="s1">&#39;mega&#39;</span> <span class="p">),</span>
             <span class="p">(</span> <span class="s1">&#39;k&#39;</span><span class="p">,</span>  <span class="mf">1.e3</span><span class="p">,</span> <span class="s1">&#39;kilo&#39;</span> <span class="p">),</span>
             <span class="p">(</span> <span class="s1">&#39;h&#39;</span><span class="p">,</span>  <span class="mf">1.e2</span><span class="p">,</span> <span class="s1">&#39;hecto&#39;</span> <span class="p">),</span>
             <span class="p">(</span> <span class="s1">&#39;da&#39;</span><span class="p">,</span> <span class="mf">1.e1</span><span class="p">,</span> <span class="s1">&#39;deka&#39;</span> <span class="p">),</span>
             <span class="p">(</span> <span class="s1">&#39;d&#39;</span><span class="p">,</span>  <span class="mf">1.e-1</span><span class="p">,</span> <span class="s1">&#39;deci&#39;</span> <span class="p">),</span>
             <span class="p">(</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span>  <span class="mf">1.e-2</span><span class="p">,</span> <span class="s1">&#39;centi&#39;</span> <span class="p">),</span>
             <span class="p">(</span> <span class="s1">&#39;m&#39;</span><span class="p">,</span>  <span class="mf">1.e-3</span><span class="p">,</span> <span class="s1">&#39;milli&#39;</span> <span class="p">),</span>
             <span class="p">(</span> <span class="s1">&#39;mu&#39;</span><span class="p">,</span> <span class="mf">1.e-6</span><span class="p">,</span> <span class="s1">&#39;micro&#39;</span> <span class="p">),</span>
             <span class="p">(</span> <span class="s1">&#39;n&#39;</span><span class="p">,</span>  <span class="mf">1.e-9</span><span class="p">,</span> <span class="s1">&#39;nano&#39;</span> <span class="p">),</span>
             <span class="p">(</span> <span class="s1">&#39;p&#39;</span><span class="p">,</span>  <span class="mf">1.e-12</span><span class="p">,</span> <span class="s1">&#39;pico&#39;</span> <span class="p">),</span>
             <span class="p">(</span> <span class="s1">&#39;f&#39;</span><span class="p">,</span>  <span class="mf">1.e-15</span><span class="p">,</span> <span class="s1">&#39;femto&#39;</span> <span class="p">),</span>
             <span class="p">(</span> <span class="s1">&#39;a&#39;</span><span class="p">,</span>  <span class="mf">1.e-18</span><span class="p">,</span> <span class="s1">&#39;atto&#39;</span> <span class="p">),</span>
             <span class="p">(</span> <span class="s1">&#39;z&#39;</span><span class="p">,</span>  <span class="mf">1.e-21</span><span class="p">,</span> <span class="s1">&#39;zepto&#39;</span> <span class="p">),</span>
             <span class="p">(</span> <span class="s1">&#39;y&#39;</span><span class="p">,</span>  <span class="mf">1.e-24</span><span class="p">,</span> <span class="s1">&#39;yocto&#39;</span> <span class="p">),</span>
             <span class="p">]</span>

<span class="n">_help</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">_unit_table</span> <span class="o">=</span> <span class="p">{}</span>

<span class="k">for</span> <span class="n">unit</span> <span class="ow">in</span> <span class="n">_base_units</span><span class="p">:</span>
    <span class="n">_unit_table</span><span class="p">[</span><span class="n">unit</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">=</span> <span class="n">unit</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

<span class="k">def</span> <span class="nf">_addUnit</span><span class="p">(</span> <span class="n">symbol</span><span class="p">,</span> <span class="n">unit</span><span class="p">,</span> <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span> <span class="p">)</span> <span class="p">:</span>

    <span class="k">if</span><span class="p">(</span> <span class="n">symbol</span> <span class="ow">in</span> <span class="n">_unit_table</span> <span class="p">)</span> <span class="p">:</span> <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span> <span class="s1">&#39;Unit &#39;</span> <span class="o">+</span> <span class="n">symbol</span> <span class="o">+</span> <span class="s1">&#39; already defined&#39;</span> <span class="p">)</span>
    <span class="k">if</span><span class="p">(</span> <span class="n">name</span> <span class="p">)</span> <span class="p">:</span> <span class="n">_help</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="p">(</span> <span class="n">name</span><span class="p">,</span> <span class="n">unit</span><span class="p">,</span> <span class="n">symbol</span> <span class="p">)</span> <span class="p">)</span>

    <span class="k">if</span><span class="p">(</span> <span class="nb">isinstance</span><span class="p">(</span> <span class="n">unit</span><span class="p">,</span> <span class="nb">str</span> <span class="p">)</span> <span class="p">)</span> <span class="p">:</span>
        <span class="n">unit</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span> <span class="n">unit</span><span class="p">,</span> <span class="n">_unit_table</span> <span class="p">)</span>

        <span class="k">for</span> <span class="n">cruft</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;__builtins__&#39;</span><span class="p">,</span> <span class="s1">&#39;__args__&#39;</span><span class="p">]</span> <span class="p">:</span>
            <span class="k">try</span> <span class="p">:</span>
                <span class="k">del</span> <span class="n">_unit_table</span><span class="p">[</span><span class="n">cruft</span><span class="p">]</span>
            <span class="k">except</span> <span class="p">:</span>
                <span class="k">pass</span>

    <span class="n">unit</span><span class="o">.</span><span class="n">setSymbol</span><span class="p">(</span> <span class="n">symbol</span> <span class="p">)</span>
    <span class="n">_unit_table</span><span class="p">[</span><span class="n">symbol</span><span class="p">]</span> <span class="o">=</span> <span class="n">unit</span>

<span class="k">def</span> <span class="nf">_addPrefixedUnit</span><span class="p">(</span> <span class="n">unit</span> <span class="p">)</span> <span class="p">:</span>
    <span class="n">_prefixed_symbols</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">prefix</span> <span class="ow">in</span> <span class="n">_prefixes</span><span class="p">:</span>
        <span class="n">symbol</span> <span class="o">=</span> <span class="n">prefix</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">unit</span>
        <span class="n">_addUnit</span><span class="p">(</span> <span class="n">symbol</span><span class="p">,</span> <span class="n">prefix</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">_unit_table</span><span class="p">[</span><span class="n">unit</span><span class="p">]</span> <span class="p">)</span>
        <span class="n">_prefixed_symbols</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="n">symbol</span> <span class="p">)</span>

    <span class="k">for</span> <span class="n">entry</span> <span class="ow">in</span> <span class="n">_help</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span> <span class="n">entry</span><span class="p">,</span> <span class="nb">tuple</span> <span class="p">)</span> <span class="p">:</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span> <span class="n">entry</span> <span class="p">)</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
                <span class="n">name0</span><span class="p">,</span> <span class="n">unit0</span><span class="p">,</span> <span class="n">symbol0</span> <span class="o">=</span> <span class="n">entry</span>
                <span class="n">i</span> <span class="o">=</span> <span class="n">_help</span><span class="o">.</span><span class="n">index</span><span class="p">(</span> <span class="n">entry</span> <span class="p">)</span>
                <span class="k">if</span> <span class="n">unit</span> <span class="o">==</span> <span class="n">symbol0</span><span class="p">:</span>
                    <span class="n">_help</span><span class="o">.</span><span class="fm">__setitem__</span><span class="p">(</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span> <span class="n">name0</span><span class="p">,</span> <span class="n">unit0</span><span class="p">,</span> <span class="n">symbol0</span><span class="p">,</span> <span class="n">_prefixed_symbols</span> <span class="p">)</span> <span class="p">)</span>

<span class="c1"># SI derived units; these automatically get prefixes</span>
<span class="n">_help</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="s1">&#39;----------------------------------------------------</span><span class="se">\n</span><span class="s1">Defined prefixes and units</span><span class="se">\n</span><span class="s1">----------------------------------------------------&#39;</span> <span class="p">)</span>
<span class="n">_help</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="s1">&#39;This section outlines the prefixes and unit defined by the PQU module as well as the values used for the physical constant.&#39;</span> <span class="p">)</span>
<span class="n">_help</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="s1">&#39;^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^</span><span class="se">\n</span><span class="s1">Prefixes</span><span class="se">\n</span><span class="s1">^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^&#39;</span> <span class="p">)</span>
<span class="n">_help</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="s1">&#39;.. highlights::</span><span class="se">\n\n</span><span class="s1">::&#39;</span> <span class="p">)</span>
<span class="n">_help</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="s1">&#39;    ----  ------ ------</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="s1">&#39;    name  factor symbol</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="s1">&#39;    ----  ------ ------&#39;</span> <span class="p">)</span>
<span class="n">_help_prefix</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">_prefix</span> <span class="ow">in</span> <span class="n">_prefixes</span> <span class="p">:</span>
    <span class="n">_help</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="p">(</span> <span class="s1">&#39;</span><span class="si">%-5s</span><span class="s1"> </span><span class="si">%-6.0e</span><span class="s1"> </span><span class="si">%-s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span> <span class="n">_prefix</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">_prefix</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">_prefix</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="p">),</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span> <span class="p">)</span> <span class="p">)</span>

<span class="n">_help</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="s1">&#39;</span><span class="se">\n\n</span><span class="s1">^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^</span><span class="se">\n</span><span class="s1">Derived SI units</span><span class="se">\n</span><span class="s1">^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^&#39;</span> <span class="p">)</span>
<span class="n">_help</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="s1">&#39;These automatically get prefixes.&#39;</span> <span class="p">)</span>
<span class="n">_help</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="s1">&#39;.. highlights::</span><span class="se">\n\n</span><span class="s1">::&#39;</span> <span class="p">)</span>
<span class="n">_help</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="s1">&#39;    </span><span class="si">%-26s</span><span class="s1"> </span><span class="si">%-32s</span><span class="s1"> </span><span class="si">%-s</span><span class="se">\n</span><span class="s1">    </span><span class="si">%-26s</span><span class="s1"> </span><span class="si">%-32s</span><span class="s1"> </span><span class="si">%-s</span><span class="se">\n</span><span class="s1">    </span><span class="si">%-26s</span><span class="s1"> </span><span class="si">%-32s</span><span class="s1"> </span><span class="si">%-s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span> <span class="s1">&#39;--------------------------&#39;</span><span class="p">,</span> <span class="s1">&#39;--------------------------------&#39;</span><span class="p">,</span> <span class="s1">&#39;------&#39;</span><span class="p">,</span> <span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">,</span> <span class="s1">&#39;symbol&#39;</span><span class="p">,</span> <span class="s1">&#39;--------------------------&#39;</span><span class="p">,</span> <span class="s1">&#39;--------------------------------&#39;</span><span class="p">,</span> <span class="s1">&#39;------&#39;</span> <span class="p">)</span> <span class="p">)</span>

<span class="n">_unit_table</span><span class="p">[</span><span class="s1">&#39;kg&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">PhysicalUnit</span><span class="p">(</span> <span class="s1">&#39;kg&#39;</span><span class="p">,</span>   <span class="mf">1.</span><span class="p">,</span> <span class="p">[</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span> <span class="p">]</span> <span class="p">)</span>

<span class="n">_addUnit</span><span class="p">(</span> <span class="s1">&#39;Hz&#39;</span><span class="p">,</span> <span class="s1">&#39;1/s&#39;</span><span class="p">,</span> <span class="s1">&#39;Hertz&#39;</span> <span class="p">)</span>
<span class="n">_addUnit</span><span class="p">(</span> <span class="s1">&#39;N&#39;</span><span class="p">,</span> <span class="s1">&#39;m*kg/s**2&#39;</span><span class="p">,</span> <span class="s1">&#39;Newton&#39;</span> <span class="p">)</span>
<span class="n">_addUnit</span><span class="p">(</span> <span class="s1">&#39;Pa&#39;</span><span class="p">,</span> <span class="s1">&#39;N/m**2&#39;</span><span class="p">,</span> <span class="s1">&#39;Pascal&#39;</span> <span class="p">)</span>
<span class="n">_addUnit</span><span class="p">(</span> <span class="s1">&#39;J&#39;</span><span class="p">,</span> <span class="s1">&#39;N*m&#39;</span><span class="p">,</span> <span class="s1">&#39;Joule&#39;</span> <span class="p">)</span>
<span class="n">_addUnit</span><span class="p">(</span> <span class="s1">&#39;W&#39;</span><span class="p">,</span> <span class="s1">&#39;J/s&#39;</span><span class="p">,</span> <span class="s1">&#39;Watt&#39;</span> <span class="p">)</span>
<span class="n">_addUnit</span><span class="p">(</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;s*A&#39;</span><span class="p">,</span> <span class="s1">&#39;Coulomb&#39;</span> <span class="p">)</span>
<span class="n">_addUnit</span><span class="p">(</span> <span class="s1">&#39;V&#39;</span><span class="p">,</span> <span class="s1">&#39;W/A&#39;</span><span class="p">,</span> <span class="s1">&#39;Volt&#39;</span> <span class="p">)</span>
<span class="n">_addUnit</span><span class="p">(</span> <span class="s1">&#39;F&#39;</span><span class="p">,</span> <span class="s1">&#39;C/V&#39;</span><span class="p">,</span> <span class="s1">&#39;Farad&#39;</span> <span class="p">)</span>
<span class="n">_addUnit</span><span class="p">(</span> <span class="s1">&#39;ohm&#39;</span><span class="p">,</span> <span class="s1">&#39;V/A&#39;</span><span class="p">,</span> <span class="s1">&#39;Ohm&#39;</span> <span class="p">)</span>
<span class="n">_addUnit</span><span class="p">(</span> <span class="s1">&#39;S&#39;</span><span class="p">,</span> <span class="s1">&#39;A/V&#39;</span><span class="p">,</span> <span class="s1">&#39;Siemens&#39;</span> <span class="p">)</span>
<span class="n">_addUnit</span><span class="p">(</span> <span class="s1">&#39;Wb&#39;</span><span class="p">,</span> <span class="s1">&#39;V*s&#39;</span><span class="p">,</span> <span class="s1">&#39;Weber&#39;</span> <span class="p">)</span>
<span class="n">_addUnit</span><span class="p">(</span> <span class="s1">&#39;T&#39;</span><span class="p">,</span> <span class="s1">&#39;Wb/m**2&#39;</span><span class="p">,</span> <span class="s1">&#39;Tesla&#39;</span> <span class="p">)</span>
<span class="n">_addUnit</span><span class="p">(</span> <span class="s1">&#39;H&#39;</span><span class="p">,</span> <span class="s1">&#39;Wb/A&#39;</span><span class="p">,</span> <span class="s1">&#39;Henry&#39;</span> <span class="p">)</span>
<span class="n">_addUnit</span><span class="p">(</span> <span class="s1">&#39;lm&#39;</span><span class="p">,</span> <span class="s1">&#39;cd*sr&#39;</span><span class="p">,</span> <span class="s1">&#39;Lumen&#39;</span> <span class="p">)</span>
<span class="n">_addUnit</span><span class="p">(</span> <span class="s1">&#39;lx&#39;</span><span class="p">,</span> <span class="s1">&#39;lm/m**2&#39;</span><span class="p">,</span> <span class="s1">&#39;Lux&#39;</span> <span class="p">)</span>
<span class="n">_addUnit</span><span class="p">(</span> <span class="s1">&#39;Bq&#39;</span><span class="p">,</span> <span class="s1">&#39;1/s&#39;</span><span class="p">,</span> <span class="s1">&#39;Becquerel&#39;</span> <span class="p">)</span>
<span class="n">_addUnit</span><span class="p">(</span> <span class="s1">&#39;Gy&#39;</span><span class="p">,</span> <span class="s1">&#39;J/kg&#39;</span><span class="p">,</span> <span class="s1">&#39;Gray&#39;</span> <span class="p">)</span>
<span class="n">_addUnit</span><span class="p">(</span> <span class="s1">&#39;Sv&#39;</span><span class="p">,</span> <span class="s1">&#39;J/kg&#39;</span><span class="p">,</span> <span class="s1">&#39;Sievert&#39;</span> <span class="p">)</span>

<span class="k">del</span> <span class="n">_unit_table</span><span class="p">[</span><span class="s1">&#39;kg&#39;</span><span class="p">]</span>

<span class="k">for</span> <span class="n">unit</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span> <span class="n">_unit_table</span><span class="o">.</span><span class="n">keys</span><span class="p">(</span> <span class="p">)</span> <span class="p">)</span> <span class="p">:</span> <span class="n">_addPrefixedUnit</span><span class="p">(</span> <span class="n">unit</span> <span class="p">)</span>

<span class="c1"># NOTE everything below does not have prefixes added to units</span>

<span class="c1"># Dimensionless quantity</span>
<span class="n">_unit_table</span><span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">PhysicalUnit</span><span class="p">(</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="p">[</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span> <span class="p">]</span> <span class="p">)</span>

<span class="c1"># Fundamental constants</span>
<span class="n">_help</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="s1">&#39;</span><span class="se">\n\n</span><span class="s1">^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^</span><span class="se">\n</span><span class="s1">Fundamental constants</span><span class="se">\n</span><span class="s1">^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^&#39;</span> <span class="p">)</span>
<span class="n">_help</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="s1">&#39;.. highlights::</span><span class="se">\n\n</span><span class="s1">::&#39;</span> <span class="p">)</span>
<span class="n">_help</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="s1">&#39;    Fundamental constants ............................................ &#39;</span> <span class="p">)</span>

<span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">pqu_constants</span>

<span class="n">_unit_table</span><span class="p">[</span><span class="s1">&#39;pi&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">pi</span>
<span class="n">_addUnit</span><span class="p">(</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span>       <span class="n">pqu_constants</span><span class="o">.</span><span class="n">c</span><span class="p">,</span>               <span class="s1">&#39;speed of light&#39;</span> <span class="p">)</span>
<span class="n">_addUnit</span><span class="p">(</span> <span class="s1">&#39;mu0&#39;</span><span class="p">,</span>     <span class="n">pqu_constants</span><span class="o">.</span><span class="n">mu0</span><span class="p">,</span>             <span class="s1">&#39;permeability of vacuum&#39;</span> <span class="p">)</span>
<span class="n">_addUnit</span><span class="p">(</span> <span class="s1">&#39;eps0&#39;</span><span class="p">,</span>    <span class="s1">&#39;1 / mu0 / c**2&#39;</span><span class="p">,</span>             <span class="s1">&#39;permittivity of vacuum&#39;</span> <span class="p">)</span>
<span class="n">_addUnit</span><span class="p">(</span> <span class="s1">&#39;Grav&#39;</span><span class="p">,</span>    <span class="n">pqu_constants</span><span class="o">.</span><span class="n">Grav</span><span class="p">,</span>            <span class="s1">&#39;gravitational constant&#39;</span> <span class="p">)</span>
<span class="n">_addUnit</span><span class="p">(</span> <span class="s1">&#39;hplanck&#39;</span><span class="p">,</span> <span class="n">pqu_constants</span><span class="o">.</span><span class="n">hplanck</span><span class="p">,</span>         <span class="s1">&#39;Planck constant&#39;</span> <span class="p">)</span>
<span class="n">_addUnit</span><span class="p">(</span> <span class="s1">&#39;hbar&#39;</span><span class="p">,</span>    <span class="s1">&#39;hplanck / ( 2 * pi )&#39;</span><span class="p">,</span>        <span class="s1">&#39;Planck constant / 2pi&#39;</span> <span class="p">)</span>
<span class="n">_addUnit</span><span class="p">(</span> <span class="s1">&#39;e&#39;</span><span class="p">,</span>       <span class="n">pqu_constants</span><span class="o">.</span><span class="n">e</span><span class="p">,</span>               <span class="s1">&#39;elementary charge&#39;</span> <span class="p">)</span>
<span class="n">_addUnit</span><span class="p">(</span> <span class="s1">&#39;me&#39;</span><span class="p">,</span>      <span class="n">pqu_constants</span><span class="o">.</span><span class="n">me</span><span class="p">,</span>              <span class="s1">&#39;electron mass&#39;</span> <span class="p">)</span>
<span class="n">_addUnit</span><span class="p">(</span> <span class="s1">&#39;mp&#39;</span><span class="p">,</span>      <span class="n">pqu_constants</span><span class="o">.</span><span class="n">mp</span><span class="p">,</span>              <span class="s1">&#39;proton mass&#39;</span> <span class="p">)</span>
<span class="n">_addUnit</span><span class="p">(</span> <span class="s1">&#39;Nav&#39;</span><span class="p">,</span>     <span class="n">pqu_constants</span><span class="o">.</span><span class="n">Nav</span><span class="p">,</span>             <span class="s1">&#39;Avogadro number&#39;</span> <span class="p">)</span>
<span class="n">_addUnit</span><span class="p">(</span> <span class="s1">&#39;k&#39;</span><span class="p">,</span>       <span class="n">pqu_constants</span><span class="o">.</span><span class="n">k</span><span class="p">,</span>           <span class="s1">&#39;Boltzmann constant&#39;</span> <span class="p">)</span>

<span class="c1"># Time units</span>
<span class="n">_help</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="s1">&#39;</span><span class="se">\n\n</span><span class="s1">^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^</span><span class="se">\n</span><span class="s1">More units</span><span class="se">\n</span><span class="s1">^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^&#39;</span> <span class="p">)</span>
<span class="n">_help</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="s1">&#39;.. highlights::</span><span class="se">\n\n</span><span class="s1">::&#39;</span> <span class="p">)</span>
<span class="n">_help</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="s1">&#39;    Time units ....................................................... &#39;</span> <span class="p">)</span>

<span class="n">_addUnit</span><span class="p">(</span> <span class="s1">&#39;min&#39;</span><span class="p">,</span> <span class="s1">&#39;60.*s&#39;</span><span class="p">,</span> <span class="s1">&#39;minute&#39;</span> <span class="p">)</span>
<span class="n">_addUnit</span><span class="p">(</span> <span class="s1">&#39;h&#39;</span><span class="p">,</span> <span class="s1">&#39;60.*min&#39;</span><span class="p">,</span> <span class="s1">&#39;hour&#39;</span> <span class="p">)</span>
<span class="n">_addUnit</span><span class="p">(</span> <span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="s1">&#39;24.*h&#39;</span><span class="p">,</span> <span class="s1">&#39;day&#39;</span> <span class="p">)</span>
<span class="n">_addUnit</span><span class="p">(</span> <span class="s1">&#39;wk&#39;</span><span class="p">,</span> <span class="s1">&#39;7.*d&#39;</span><span class="p">,</span> <span class="s1">&#39;week&#39;</span> <span class="p">)</span>
<span class="n">_addUnit</span><span class="p">(</span> <span class="s1">&#39;yr&#39;</span><span class="p">,</span> <span class="s1">&#39;365.25*d&#39;</span><span class="p">,</span> <span class="s1">&#39;year&#39;</span> <span class="p">)</span>

<span class="c1"># Length units</span>
<span class="n">_help</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="s1">&#39;    Length units ..................................................... &#39;</span> <span class="p">)</span>

<span class="n">_addUnit</span><span class="p">(</span> <span class="s1">&#39;inch&#39;</span><span class="p">,</span> <span class="s1">&#39;2.54 * cm&#39;</span><span class="p">,</span> <span class="s1">&#39;inch&#39;</span> <span class="p">)</span>
<span class="n">_addUnit</span><span class="p">(</span> <span class="s1">&#39;ft&#39;</span><span class="p">,</span> <span class="s1">&#39;12. * inch&#39;</span><span class="p">,</span> <span class="s1">&#39;foot&#39;</span> <span class="p">)</span>
<span class="n">_addUnit</span><span class="p">(</span> <span class="s1">&#39;yd&#39;</span><span class="p">,</span> <span class="s1">&#39;3. * ft&#39;</span><span class="p">,</span> <span class="s1">&#39;yard&#39;</span> <span class="p">)</span>
<span class="n">_addUnit</span><span class="p">(</span> <span class="s1">&#39;mi&#39;</span><span class="p">,</span> <span class="s1">&#39;5280. * ft&#39;</span><span class="p">,</span> <span class="s1">&#39;(British) mile&#39;</span> <span class="p">)</span>
<span class="n">_addUnit</span><span class="p">(</span> <span class="s1">&#39;nmi&#39;</span><span class="p">,</span> <span class="s1">&#39;1852. * m&#39;</span><span class="p">,</span> <span class="s1">&#39;Nautical mile&#39;</span> <span class="p">)</span>
<span class="n">_addUnit</span><span class="p">(</span> <span class="s1">&#39;Ang&#39;</span><span class="p">,</span> <span class="s1">&#39;1.e-10 * m&#39;</span><span class="p">,</span> <span class="s1">&#39;Angstrom&#39;</span> <span class="p">)</span>
<span class="n">_addUnit</span><span class="p">(</span> <span class="s1">&#39;lyr&#39;</span><span class="p">,</span> <span class="s1">&#39;c * yr&#39;</span><span class="p">,</span> <span class="s1">&#39;light year&#39;</span> <span class="p">)</span>
<span class="n">_addUnit</span><span class="p">(</span> <span class="s1">&#39;au&#39;</span><span class="p">,</span> <span class="s1">&#39;149597870700. * m&#39;</span><span class="p">,</span> <span class="s1">&#39;Astronomical unit&#39;</span> <span class="p">)</span>
<span class="n">_addUnit</span><span class="p">(</span> <span class="s1">&#39;Bohr&#39;</span><span class="p">,</span> <span class="s1">&#39;4. * pi * eps0 * hbar**2/me/e**2&#39;</span><span class="p">,</span> <span class="s1">&#39;Bohr radius&#39;</span> <span class="p">)</span>

<span class="c1"># Area units</span>
<span class="n">_help</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="s1">&#39;    Area units ....................................................... &#39;</span> <span class="p">)</span>

<span class="n">_addUnit</span><span class="p">(</span> <span class="s1">&#39;ha&#39;</span><span class="p">,</span> <span class="s1">&#39;10000*m**2&#39;</span><span class="p">,</span> <span class="s1">&#39;hectare&#39;</span> <span class="p">)</span>
<span class="n">_addUnit</span><span class="p">(</span> <span class="s1">&#39;acres&#39;</span><span class="p">,</span> <span class="s1">&#39;mi**2/640&#39;</span><span class="p">,</span> <span class="s1">&#39;acre&#39;</span> <span class="p">)</span>
<span class="n">_addUnit</span><span class="p">(</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;1.e-28*m**2&#39;</span><span class="p">,</span> <span class="s1">&#39;barn&#39;</span> <span class="p">)</span>

<span class="n">_addPrefixedUnit</span><span class="p">(</span> <span class="s1">&#39;b&#39;</span> <span class="p">)</span>

<span class="c1"># Volume units</span>
<span class="n">_help</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="s1">&#39;    Volume units ..................................................... &#39;</span> <span class="p">)</span>

<span class="n">_addUnit</span><span class="p">(</span> <span class="s1">&#39;l&#39;</span><span class="p">,</span> <span class="s1">&#39;dm**3&#39;</span><span class="p">,</span> <span class="s1">&#39;liter&#39;</span> <span class="p">)</span>
<span class="n">_addUnit</span><span class="p">(</span> <span class="s1">&#39;dl&#39;</span><span class="p">,</span> <span class="s1">&#39;0.1 * l&#39;</span><span class="p">,</span> <span class="s1">&#39;deci liter&#39;</span> <span class="p">)</span>
<span class="n">_addUnit</span><span class="p">(</span> <span class="s1">&#39;cl&#39;</span><span class="p">,</span> <span class="s1">&#39;0.01 * l&#39;</span><span class="p">,</span> <span class="s1">&#39;centi liter&#39;</span> <span class="p">)</span>
<span class="n">_addUnit</span><span class="p">(</span> <span class="s1">&#39;ml&#39;</span><span class="p">,</span> <span class="s1">&#39;0.001 * l&#39;</span><span class="p">,</span> <span class="s1">&#39;milli liter&#39;</span> <span class="p">)</span>
<span class="n">_addUnit</span><span class="p">(</span> <span class="s1">&#39;tsp&#39;</span><span class="p">,</span> <span class="n">pqu_constants</span><span class="o">.</span><span class="n">tsp</span><span class="p">,</span> <span class="s1">&#39;teaspoon&#39;</span> <span class="p">)</span>
<span class="n">_addUnit</span><span class="p">(</span> <span class="s1">&#39;tbsp&#39;</span><span class="p">,</span> <span class="s1">&#39;3. * tsp&#39;</span><span class="p">,</span> <span class="s1">&#39;tablespoon&#39;</span> <span class="p">)</span>
<span class="n">_addUnit</span><span class="p">(</span> <span class="s1">&#39;floz&#39;</span><span class="p">,</span> <span class="s1">&#39;2. * tbsp&#39;</span><span class="p">,</span> <span class="s1">&#39;fluid ounce&#39;</span> <span class="p">)</span>
<span class="n">_addUnit</span><span class="p">(</span> <span class="s1">&#39;cup&#39;</span><span class="p">,</span> <span class="s1">&#39;8. * floz&#39;</span><span class="p">,</span> <span class="s1">&#39;cup&#39;</span> <span class="p">)</span>
<span class="n">_addUnit</span><span class="p">(</span> <span class="s1">&#39;pt&#39;</span><span class="p">,</span> <span class="s1">&#39;16. * floz&#39;</span><span class="p">,</span> <span class="s1">&#39;pint&#39;</span> <span class="p">)</span>
<span class="n">_addUnit</span><span class="p">(</span> <span class="s1">&#39;qt&#39;</span><span class="p">,</span> <span class="s1">&#39;2. * pt&#39;</span><span class="p">,</span> <span class="s1">&#39;quart&#39;</span> <span class="p">)</span>
<span class="n">_addUnit</span><span class="p">(</span> <span class="s1">&#39;galUS&#39;</span><span class="p">,</span> <span class="s1">&#39;4. * qt&#39;</span><span class="p">,</span> <span class="s1">&#39;US gallon&#39;</span> <span class="p">)</span>
<span class="n">_addUnit</span><span class="p">(</span> <span class="s1">&#39;galUK&#39;</span><span class="p">,</span> <span class="n">pqu_constants</span><span class="o">.</span><span class="n">galUK</span><span class="p">,</span> <span class="s1">&#39;British gallon&#39;</span> <span class="p">)</span>

<span class="c1"># Mass units</span>
<span class="n">_help</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="s1">&#39;    Mass units ....................................................... &#39;</span> <span class="p">)</span>

<span class="n">_addUnit</span><span class="p">(</span> <span class="s1">&#39;amu&#39;</span><span class="p">,</span> <span class="n">pqu_constants</span><span class="o">.</span><span class="n">amu</span><span class="p">,</span> <span class="s1">&#39;atomic mass units&#39;</span> <span class="p">)</span>
<span class="n">_addUnit</span><span class="p">(</span> <span class="s1">&#39;oz&#39;</span><span class="p">,</span> <span class="n">pqu_constants</span><span class="o">.</span><span class="n">oz</span><span class="p">,</span> <span class="s1">&#39;ounce&#39;</span> <span class="p">)</span>
<span class="n">_addUnit</span><span class="p">(</span> <span class="s1">&#39;lb&#39;</span><span class="p">,</span> <span class="s1">&#39;16. * oz&#39;</span><span class="p">,</span> <span class="s1">&#39;pound&#39;</span> <span class="p">)</span>
<span class="n">_addUnit</span><span class="p">(</span> <span class="s1">&#39;ton&#39;</span><span class="p">,</span> <span class="s1">&#39;2000. * lb&#39;</span><span class="p">,</span> <span class="s1">&#39;ton&#39;</span> <span class="p">)</span>

<span class="c1"># Force units</span>
<span class="n">_help</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="s1">&#39;    Force units ...................................................... &#39;</span> <span class="p">)</span>

<span class="n">_addUnit</span><span class="p">(</span> <span class="s1">&#39;dyn&#39;</span><span class="p">,</span> <span class="s1">&#39;1.e-5 * N&#39;</span><span class="p">,</span> <span class="s1">&#39;dyne (cgs unit)&#39;</span> <span class="p">)</span>

<span class="c1"># Energy units</span>
<span class="n">_help</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="s1">&#39;    Energy units ..................................................... &#39;</span> <span class="p">)</span>

<span class="n">_addUnit</span><span class="p">(</span> <span class="s1">&#39;erg&#39;</span><span class="p">,</span> <span class="s1">&#39;1.e-7*J&#39;</span><span class="p">,</span> <span class="s1">&#39;erg (cgs unit)&#39;</span> <span class="p">)</span>
<span class="n">_addUnit</span><span class="p">(</span> <span class="s1">&#39;eV&#39;</span><span class="p">,</span> <span class="s1">&#39;e*V&#39;</span><span class="p">,</span> <span class="s1">&#39;electron volt&#39;</span> <span class="p">)</span>
<span class="n">_addUnit</span><span class="p">(</span> <span class="s1">&#39;Hartree&#39;</span><span class="p">,</span> <span class="s1">&#39;me*e**4/16/pi**2/eps0**2/hbar**2&#39;</span><span class="p">,</span> <span class="s1">&#39;Wavenumbers/inverse cm&#39;</span> <span class="p">)</span>
<span class="n">_addUnit</span><span class="p">(</span> <span class="s1">&#39;Ken&#39;</span><span class="p">,</span> <span class="s1">&#39;k*K&#39;</span><span class="p">,</span> <span class="s1">&#39;Kelvin as energy unit&#39;</span> <span class="p">)</span>
<span class="n">_addUnit</span><span class="p">(</span> <span class="s1">&#39;cal&#39;</span><span class="p">,</span> <span class="n">pqu_constants</span><span class="o">.</span><span class="n">cal</span><span class="p">,</span> <span class="s1">&#39;thermochemical calorie&#39;</span> <span class="p">)</span>
<span class="n">_addUnit</span><span class="p">(</span> <span class="s1">&#39;kcal&#39;</span><span class="p">,</span> <span class="s1">&#39;1000.*cal&#39;</span><span class="p">,</span> <span class="s1">&#39;thermochemical kilocalorie&#39;</span> <span class="p">)</span>
<span class="n">_addUnit</span><span class="p">(</span> <span class="s1">&#39;cali&#39;</span><span class="p">,</span> <span class="n">pqu_constants</span><span class="o">.</span><span class="n">cali</span><span class="p">,</span> <span class="s1">&#39;international calorie&#39;</span> <span class="p">)</span>
<span class="n">_addUnit</span><span class="p">(</span> <span class="s1">&#39;kcali&#39;</span><span class="p">,</span> <span class="s1">&#39;1000.*cali&#39;</span><span class="p">,</span> <span class="s1">&#39;international kilocalorie&#39;</span> <span class="p">)</span>
<span class="n">_addUnit</span><span class="p">(</span> <span class="s1">&#39;Btu&#39;</span><span class="p">,</span> <span class="n">pqu_constants</span><span class="o">.</span><span class="n">Btu</span><span class="p">,</span> <span class="s1">&#39;British thermal unit&#39;</span> <span class="p">)</span>

<span class="n">_addPrefixedUnit</span><span class="p">(</span> <span class="s1">&#39;eV&#39;</span> <span class="p">)</span>

<span class="c1"># Power units</span>
<span class="n">_help</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="s1">&#39;    Power units ...................................................... &#39;</span> <span class="p">)</span>

<span class="n">_addUnit</span><span class="p">(</span> <span class="s1">&#39;hp&#39;</span><span class="p">,</span> <span class="n">pqu_constants</span><span class="o">.</span><span class="n">hp</span><span class="p">,</span> <span class="s1">&#39;horsepower&#39;</span> <span class="p">)</span>

<span class="c1"># Pressure units</span>
<span class="n">_help</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="s1">&#39;    Pressure units ................................................... &#39;</span> <span class="p">)</span>

<span class="n">_addUnit</span><span class="p">(</span> <span class="s1">&#39;bar&#39;</span><span class="p">,</span> <span class="s1">&#39;1.e5*Pa&#39;</span><span class="p">,</span> <span class="s1">&#39;bar (cgs unit)&#39;</span> <span class="p">)</span>
<span class="n">_addUnit</span><span class="p">(</span> <span class="s1">&#39;atm&#39;</span><span class="p">,</span> <span class="n">pqu_constants</span><span class="o">.</span><span class="n">atm</span><span class="p">,</span> <span class="s1">&#39;standard atmosphere&#39;</span> <span class="p">)</span>
<span class="n">_addUnit</span><span class="p">(</span> <span class="s1">&#39;torr&#39;</span><span class="p">,</span> <span class="s1">&#39;atm/760&#39;</span><span class="p">,</span> <span class="s1">&#39;torr = mm of mercury&#39;</span> <span class="p">)</span>
<span class="n">_addUnit</span><span class="p">(</span> <span class="s1">&#39;psi&#39;</span><span class="p">,</span> <span class="n">pqu_constants</span><span class="o">.</span><span class="n">psi</span><span class="p">,</span> <span class="s1">&#39;pounds per square inch&#39;</span> <span class="p">)</span>

<span class="c1"># Angle units</span>
<span class="n">_help</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="s1">&#39;    Angle units ...................................................... &#39;</span> <span class="p">)</span>

<span class="n">_addUnit</span><span class="p">(</span> <span class="s1">&#39;deg&#39;</span><span class="p">,</span> <span class="s1">&#39;pi*rad/180.&#39;</span><span class="p">,</span> <span class="s1">&#39;degrees&#39;</span> <span class="p">)</span>

<span class="n">_help</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="s1">&#39;    Temperature units ................................................ &#39;</span> <span class="p">)</span>
<span class="c1"># Temperature units -- can&#39;t use the &#39;eval&#39; trick that _addUnit provides</span>
<span class="c1"># for degC and degF because you can&#39;t add units</span>
<span class="n">Kelvin</span> <span class="o">=</span> <span class="n">_findUnit</span><span class="p">(</span> <span class="s1">&#39;K&#39;</span> <span class="p">)</span>
<span class="n">_addUnit</span><span class="p">(</span> <span class="s1">&#39;degR&#39;</span><span class="p">,</span> <span class="s1">&#39;(5./9.)*K&#39;</span><span class="p">,</span> <span class="s1">&#39;degrees Rankine&#39;</span> <span class="p">)</span>
<span class="n">_addUnit</span><span class="p">(</span> <span class="s1">&#39;degC&#39;</span><span class="p">,</span> <span class="n">PhysicalUnit</span><span class="p">(</span> <span class="kc">None</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="n">Kelvin</span><span class="o">.</span><span class="n">powers</span><span class="p">,</span> <span class="mf">273.15</span> <span class="p">),</span> <span class="s1">&#39;degrees Celsius&#39;</span> <span class="p">)</span>
<span class="n">_addUnit</span><span class="p">(</span> <span class="s1">&#39;degF&#39;</span><span class="p">,</span> <span class="n">PhysicalUnit</span><span class="p">(</span> <span class="kc">None</span><span class="p">,</span> <span class="mf">5.</span><span class="o">/</span><span class="mf">9.</span><span class="p">,</span> <span class="n">Kelvin</span><span class="o">.</span><span class="n">powers</span><span class="p">,</span> <span class="mf">459.67</span> <span class="p">),</span> <span class="s1">&#39;degrees Fahrenheit&#39;</span> <span class="p">)</span>

<span class="n">_help</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="p">)</span>
<span class="n">_help</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="s1">&#39;^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^</span><span class="se">\n</span><span class="s1">Prefixed units</span><span class="se">\n</span><span class="s1">^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^&#39;</span> <span class="p">)</span>
<span class="n">_help</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="s1">&#39;.. highlights::</span><span class="se">\n\n</span><span class="s1">::&#39;</span> <span class="p">)</span>

<span class="k">del</span> <span class="n">Kelvin</span>

<div class="viewcode-block" id="description"><a class="viewcode-back" href="../../pqu/pqu.html#pqu.PQU.description">[docs]</a><span class="k">def</span> <span class="nf">description</span><span class="p">(</span> <span class="p">)</span> <span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return a string describing all available units.</span>

<span class="sd">    :rtype: `str`</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">s</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1"># collector for description text</span>

    <span class="k">for</span> <span class="n">entry</span> <span class="ow">in</span> <span class="n">_help</span> <span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span> <span class="n">entry</span><span class="p">,</span> <span class="nb">str</span> <span class="p">)</span> <span class="p">:</span>
            <span class="k">if</span> <span class="n">entry</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">s</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>  <span class="o">+</span> <span class="n">entry</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">pass</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span> <span class="n">entry</span><span class="p">,</span> <span class="nb">tuple</span> <span class="p">)</span> <span class="p">:</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span> <span class="n">entry</span> <span class="p">)</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span>
                <span class="n">name</span><span class="p">,</span> <span class="n">unit</span><span class="p">,</span> <span class="n">symbol</span><span class="p">,</span> <span class="n">prefixes</span> <span class="o">=</span> <span class="n">entry</span>
            <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span> <span class="n">entry</span> <span class="p">)</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
                <span class="n">name</span><span class="p">,</span> <span class="n">unit</span><span class="p">,</span> <span class="n">symbol</span> <span class="o">=</span> <span class="n">entry</span>

            <span class="n">s</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="s1">&#39;    </span><span class="si">%-26s</span><span class="s1"> </span><span class="si">%-32s</span><span class="s1"> </span><span class="si">%-s</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span> <span class="n">name</span><span class="p">,</span> <span class="n">unit</span><span class="p">,</span> <span class="n">symbol</span> <span class="p">)</span> <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># impossible</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span> <span class="s1">&#39;wrong construction of _help list&#39;</span> <span class="p">)</span>

    <span class="n">entry</span> <span class="o">=</span> <span class="s1">&#39;    ------------- ------ --------------</span><span class="se">\n</span><span class="s1">    </span><span class="si">%-13s</span><span class="s1"> </span><span class="si">%-6s</span><span class="s1"> prefixed units</span><span class="se">\n</span><span class="s1">    ------------- ------ --------------&#39;</span> <span class="o">%</span> <span class="p">(</span> <span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="s1">&#39;symbol&#39;</span> <span class="p">)</span>
    <span class="n">s</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>  <span class="o">+</span> <span class="n">entry</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="p">)</span>

    <span class="k">for</span> <span class="n">entry</span> <span class="ow">in</span> <span class="n">_help</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span> <span class="n">entry</span><span class="p">,</span> <span class="nb">str</span> <span class="p">)</span> <span class="p">:</span>
            <span class="k">pass</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span> <span class="n">entry</span><span class="p">,</span> <span class="nb">tuple</span> <span class="p">)</span> <span class="p">:</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span> <span class="n">entry</span> <span class="p">)</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span>
                <span class="n">name</span><span class="p">,</span> <span class="n">unit</span><span class="p">,</span> <span class="n">symbol</span><span class="p">,</span> <span class="n">prefixes</span> <span class="o">=</span> <span class="n">entry</span>
                <span class="n">s</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="s1">&#39;    </span><span class="si">%-13s</span><span class="s1"> </span><span class="si">%-6s</span><span class="s1"> </span><span class="si">%-s</span><span class="se">\n</span><span class="s1">    </span><span class="si">%-13s</span><span class="s1"> </span><span class="si">%-6s</span><span class="s1"> </span><span class="si">%-s</span><span class="se">\n\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span> <span class="n">name</span><span class="p">,</span> <span class="n">symbol</span><span class="p">,</span> <span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span> <span class="n">prefixes</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">10</span><span class="p">]</span> <span class="p">),</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span> <span class="n">prefixes</span><span class="p">[</span><span class="mi">10</span><span class="p">:</span><span class="mi">20</span><span class="p">]</span> <span class="p">)</span> <span class="p">)</span> <span class="p">)</span>
    <span class="n">s</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="p">)</span>

    <span class="k">return</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span> <span class="n">s</span> <span class="p">)</span></div>

<span class="c1"># add the description of the units to the module&#39;s doc string:</span>
<span class="vm">__doc__</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="n">description</span><span class="p">(</span> <span class="p">)</span>

<div class="viewcode-block" id="printPredefinedUnits"><a class="viewcode-back" href="../../pqu/pqu.html#pqu.PQU.printPredefinedUnits">[docs]</a><span class="k">def</span> <span class="nf">printPredefinedUnits</span><span class="p">(</span> <span class="p">)</span> <span class="p">:</span>

    <span class="n">units</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">symbol</span><span class="p">,</span> <span class="n">unit</span> <span class="ow">in</span> <span class="n">_unit_table</span><span class="o">.</span><span class="n">items</span><span class="p">(</span> <span class="p">)</span> <span class="p">:</span>
        <span class="k">if</span><span class="p">(</span> <span class="n">symbol</span> <span class="ow">in</span> <span class="p">[</span> <span class="s1">&#39;pi&#39;</span> <span class="p">]</span> <span class="p">)</span> <span class="p">:</span> <span class="k">continue</span>
        <span class="n">s</span> <span class="o">=</span> <span class="s2">&quot;    </span><span class="si">%-10s</span><span class="s2">  </span><span class="si">%20.12e</span><span class="s2">  </span><span class="si">%20.12e</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span> <span class="n">symbol</span><span class="p">,</span> <span class="n">unit</span><span class="o">.</span><span class="n">factor</span><span class="p">,</span> <span class="n">unit</span><span class="o">.</span><span class="n">offset</span> <span class="p">)</span>
        <span class="k">for</span> <span class="n">power</span> <span class="ow">in</span> <span class="n">unit</span><span class="o">.</span><span class="n">powers</span> <span class="p">:</span> <span class="n">s</span> <span class="o">+=</span> <span class="s2">&quot;  </span><span class="si">%3d</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">power</span>
        <span class="n">units</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="n">s</span> <span class="p">)</span>
    <span class="n">units</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span> <span class="p">)</span>
    <span class="k">for</span> <span class="n">unit</span> <span class="ow">in</span> <span class="n">units</span> <span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="n">unit</span><span class="p">)</span></div>

<div class="viewcode-block" id="convertUnits"><a class="viewcode-back" href="../../pqu/pqu.html#pqu.PQU.convertUnits">[docs]</a><span class="k">def</span> <span class="nf">convertUnits</span><span class="p">(</span> <span class="n">unit</span><span class="p">,</span> <span class="n">unitMap</span> <span class="p">)</span> <span class="p">:</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    This function converts *unit* to a new unit based on the key/value pairs in the dictionary *unitMap*,</span>
<span class="sd">    and it determines the factor that converts *unit* to the new unit.</span>
<span class="sd">    That is, it looks up each term in *unit* to see if it is a key in *unitMap*. If it is,</span>
<span class="sd">    it replaces that term with the value of the key and scales a factor appropriately.</span>
<span class="sd">    For example, if *unit* = &#39;b * eV&#39; and unitMap = {&#39;eV&#39;: &#39;MeV&#39;} then the new unit returned</span>
<span class="sd">    will have &#39;eV&#39; replaced with &#39;MeV&#39; (i.e., it will be &#39;b * MeV&#39; and the factor returned will be</span>
<span class="sd">    1e-6. Also if *unit* = &#39;b * eV&#39; and unitMap = {&#39;eV&#39;: &#39;MeV&#39;, &#39;b&#39;: &#39;mb&#39;, &#39;m&#39;: &#39;km&#39;} then the new unit returned</span>
<span class="sd">    it will be &#39;mb * MeV&#39; and the factor returned will be 1e-3. In this latter example, &#39;m&#39; is not in the </span>
<span class="sd">    original unit so is not used.</span>

<span class="sd">    :param unit:        A valid unit as a string.</span>
<span class="sd">    :param unitMap:     A dictionary containing old units as keys and their new unit as the key&#39;s value.</span>

<span class="sd">    :returns:           (string, factor)</span>
<span class="sd">    &#39;&#39;&#39;</span>

    <span class="n">PU</span> <span class="o">=</span> <span class="n">_findUnit</span><span class="p">(</span> <span class="n">unit</span> <span class="p">)</span>
    <span class="n">unitString</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
    <span class="n">operator</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
    <span class="k">for</span> <span class="n">_unit</span> <span class="ow">in</span> <span class="n">PU</span><span class="o">.</span><span class="n">symbols</span> <span class="p">:</span>
        <span class="k">try</span> <span class="p">:</span>
            <span class="n">__unit</span> <span class="o">=</span> <span class="n">unitMap</span><span class="p">[</span><span class="n">_unit</span><span class="p">]</span>
        <span class="k">except</span> <span class="p">:</span>
            <span class="n">__unit</span> <span class="o">=</span> <span class="n">_unit</span>
        <span class="n">unitString</span> <span class="o">+=</span> <span class="s2">&quot;</span><span class="si">%s%s</span><span class="s2">**</span><span class="si">%d</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span> <span class="n">operator</span><span class="p">,</span> <span class="n">__unit</span><span class="p">,</span> <span class="n">PU</span><span class="o">.</span><span class="n">symbols</span><span class="p">[</span><span class="n">_unit</span><span class="p">]</span> <span class="p">)</span>
        <span class="n">operator</span> <span class="o">=</span> <span class="s1">&#39; * &#39;</span>
    <span class="n">newUnit</span> <span class="o">=</span> <span class="n">_findUnit</span><span class="p">(</span> <span class="n">unitString</span> <span class="p">)</span>
    <span class="n">factor</span> <span class="o">=</span> <span class="n">PU</span><span class="o">.</span><span class="n">conversionFactorTo</span><span class="p">(</span> <span class="n">newUnit</span> <span class="p">)</span>
    <span class="k">return</span><span class="p">(</span> <span class="n">newUnit</span><span class="o">.</span><span class="n">symbol</span><span class="p">(</span> <span class="p">),</span> <span class="n">factor</span> <span class="p">)</span></div>
</pre></div>

            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../../index.html">
              <img class="logo" src="../../_static/gnd.png" alt="Logo"/>
            </a></p>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">Fudge and GNDS 6.1.0 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../index.html" >Module code</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">pqu.PQU</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2012, B.Beck, D. Brown, C. Mattoon, N. Patel, N. Summers.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 5.0.2.
    </div>
  </body>
</html>